<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="开发,Golang,">





  <link rel="alternate" href="/atom.xml" title="寿司卷code" type="application/atom+xml">






<meta name="keywords" content="开发,Golang">
<meta property="og:type" content="article">
<meta property="og:title" content="Golang学习笔记">
<meta property="og:url" content="https://imauu.gitee.io/2022/06/02/Golang学习笔记/index.html">
<meta property="og:site_name" content="寿司卷code">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic.wangt.cc%2Fdownload%2Fpic_router.php%3Fpath%3Dhttps%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F830ee8c79a676e7fb59f28d60bc1556a.png&refer=http%3A%2F%2Fpic.wangt.cc&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1665126986&t=c0c20c712cc14c9e362292f463098285">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2tvjag3dej20u014u770.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2u7ztpmyqj21pc0l679g.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2v10t7f6cj21em0f2wgg.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2v12urqn7j20tq0bggnz.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2v14wsgypj20tq03et95.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h2wbuueukpj20ou0943z9.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h381a55v43j21cx0u0n05.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h381cnkxwpj21br0u077c.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h381fj3xgaj21gv0u041q.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h381pjqth6j21ho0u0wii.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4434no1qij211m03a3z8.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h443enoc5ej20ew06mq2y.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4455m43qdj20x40hqn0b.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h445vqa759j20uk01mglv.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h445zb24g1j20ue01mgm0.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4467n71tbj20ue01kwev.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h446m91q3qj20u801gglx.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4479bm0gvj211402kwf9.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h448yn0ifuj20vq040wf5.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h449ig4u1nj20wa06cgmq.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h45g1ttklgj20iw042q3f.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h45gf5bl4pj20j6038q36.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h46gevbh92j21300cg752.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h46gcmqttfj217w0co759.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h46gfj52gyj211u0iyjt6.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h46iollzs0j20j4034mx8.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h46j0mu81tj20im03yjrk.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4eu3npbylj20q00aegmk.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4eunfeh6uj20ny05kq3n.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ev6z3brjj20l0038dfy.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4fu2dxcaoj20p203gweu.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4fucv9e6pj20ry05mq3k.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j75mydaaj20b9037aa6.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j7l5weowj20b301l3ye.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j7xsl5cdj20az04aaa4.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j8dsyxrmj20av04dglk.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j8o1897kj20b90533yg.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j8w8k1ykj20b0055glt.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4jalmx5xej20b502c0sn.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4jaqxzflbj20mw0dj0ta.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4jbho8qdfj20av00v3ye.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4k50q2mt6j20ag00rq2s.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k5se1rk6j20r506p0th.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k7bdjtrpj206z033dfp.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k9g3q8myj20h10cjmxs.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k9nwnr3wj20cv09nq3e.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k9plh9v8j20ab031jra.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k9z0ydnpj20hv038gln.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ka4qyid8j20ge00n747.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ka6a7p58j2091039aa8.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4kb9raa7pj20cl020mx4.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4kckeyrjaj20lz0890tl.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4keaq3dqkj20bz00vdfr.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4kfmvxn9lj20bv01nmx3.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4kfp7tpl0j20bs0bsdg9.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4l79o0owmj20bs017747.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4l8022xpbj20bt00wjrb.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4li4soq97j20je07rjrt.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4lii7d2d7j20c9016dft.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4lir7u9a7j20bw00tq2u.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4lk1a9rkdj20bu017glj.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4lkcz5qhmj20br01ha9y.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mfwe9qhqj20mq0cfjrt.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mhmi2b3fj20dm01lt8l.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4kfp7tpl0j20bs0bsdg9.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mkh72fz9j20dc02q0so.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mluxbyrbj20dj018748.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mm9al52yj20f9020t8o.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mmkphvyij20eu0230sq.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4npzswif3j20f600rglm.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4nq745jvtj20f303jglr.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4nqftryiej205300t0sj.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ns373hszj20ed056jrp.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ntmk9yvkj20fw03j0t2.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4nuuvltsmj20dv00t749.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4nvm5zdn7j20lj01k0sv.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4nwgaq7ngj20ea068aab.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4nxb4egttj20e402gjrh.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4nxvczswtj20n608nwfq.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ooqx5i1ej20e300ut8p.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4op11epy6j20e100v0sp.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4oql74lqpj20dw01at8q.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4oszxis4kj20ea01zwej.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ow03tlluj20hd06rdg1.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ow8rinzhj20e801zglp.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4owogomnyj20dy01ndfu.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4owztdc16j209801fjr8.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ox0qqx6aj20jj06ywev.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4oyfp9xbbj20dy02tt8r.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4oz7l3zk6j20e60163yk.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ozgejsn8j20e50193yj.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ozi5x1szj20ja06ut9c.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ozs1m4q5j20e600tdfs.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4oztlt8gvj20dj06et8p.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4p21fpg10j20m10a7js6.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4sa4sfnh3j20dl01lmx6.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4sgnuzq8wj20cw01n0sq.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4sgrxngu9j20jv0d0t9o.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4shr3kw8yj20d501mdfx.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4shwpu4syj207v04o0sm.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4si23oa8dj20c00203yh.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4si9der36j20kc072q39.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4sk2c5bnhj20br03zgls.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4tlsomqqkj20c601yt8q.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ukacar4aj20bq014glk.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4up3imfhlj20bm021dfw.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4uq5rpeezj20cn02sglp.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ur5wbajsj20ce021dft.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ur4vtw56j20c304474d.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4usgifjpqj20gs00tq2y.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4utaplpxnj20bj02r74a.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4uu5y8o6rj20od00uaa4.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4vvmz38msj20dc02sdfw.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4vwlszlapj20dx02dt8t.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4w067o95hj20dj01ndfu.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4w0ii52d4j20dl028wej.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4w137zflrj20qn01k74l.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4wvt3wpp6j20db00rt8m.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4x0hd9p1jj20r901kaab.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4x1jcwfhhj20ek00tglk.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h4z3yw0i0uj20ef020wej.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4x6gp1qdnj20lo09bdgd.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z47pvi7uj20be0a60sx.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z6qsaz6nj20e701x74g.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z6rbwj9vj209r09mjrf.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z7fr7xx6j20ea013t8m.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z7wsm92zj20ek00sq2v.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z8jr1knaj20gf03wmx8.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4zaxg2epcj20g600v0sp.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4zb93l2h3j20e8016a9z.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h4zbr9mqorj205v02r747.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h50d0iqrrjj20ff015jrc.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h50h3qjflzj20lo06ajrr.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h50k2vt9eyj20fn0okwg0.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h51jls02vqj20iy01974d.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h51jlaxavhj20k700uq2z.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h51m6xkvuij20i601zaa7.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h51opype5ij20ex099dg8.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h51p7lii0dj20i601y0su.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h51sdrxt6uj20ha01x0sr.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h51slbi2rkj20he00taa2.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h51th1xwsij20h5016q2z.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h51tmhmx8dj20hb00t74a.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h52tssg7ruj20hq01wdfv.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h52uisnto3j20mz04a3yr.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h53zzm41o6j20wv04ngm3.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h53yqwkcegj21220jfdjf.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h53z2actc8j20vl0o7te6.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24egy1h53zwcoq9xj20hp08yjs2.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5448u8uobj20hj01lq2z.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h54xqk79gnj20ov0bnta6.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h54xyroz29j20h700tmx5.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h54y6pcdl2j20h601jwei.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h552s5vrm8j20h704baa7.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h553als143j20hb02pdg2.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h57kaux6yaj20lx0aygmk.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h57l9l24egj20j20ct753.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h57lvf6sybj20k10ay0tg.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h58gkq0xsij20h407y0st.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h58glfd5euj20ju06qq34.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h58gm2fgjwj20ja0753yy.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h58gmqie2ij20il03kaa6.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h58gn9uc3ej20ii04kt92.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h58mp9liydj20mk0asq3w.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h59xde7vi4j20j70kdwg7.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h59x4uqtefj20of0awdhf.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h59xbwesfrj20k70kxdhr.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5aoomjz3tj20oo0ajtab.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5apykw7pvj20kb0jc75z.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5armr7kftj20ik0lutah.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5ayet6s5rj20js0llgnb.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fag9q0uej20hn021q33.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fb2ixbl4j20eg00tweg.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fbam9tnfj218h0gljum.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fdyiq40dj20mp01v3yu.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fhq4c94gj20jd01lt8y.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fijxkxerj20e9016t8o.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fl869xwsj206y01qt8i.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fl9sqtp1j20fc02f74g.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5flmc7p7fj20ru07jdgk.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fn5jq7syj205t01tjr7.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fn7z8687j20e203jt90.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fn8kr8yhj207w02hq2t.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fn9foyogj20gy02i3yh.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5gitp6oxhj20pc0jwwg5.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5gj9qierpj20ni060dg1.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5gmhcwhj3j20du08ijry.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5gmxkse2pj20mb0h2ta7.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hpwgtvjjj20z60g375j.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5htca9ofbj20uy0g8dgq.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5htny9vskj20dt01igln.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hvbrkft2j20ol053dgq.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hwgydwbuj20o709eq3g.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hx16xf6ij20e205iq38.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hy365oq1j20pz07et9i.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hysft9otj20f8047glx.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5i0j54r0bj20ds017wei.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5iyr8kt79j20e700swef.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5iyueduboj20dx00u3yg.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5izdtyzidj20dw00t748.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5j0npbdgyj20dp00rgli.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5j2o9jzqpj20j003wq3e.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5j48gncymj20p109jmy2.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5j4xtn7yaj20ph0aa3zo.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k3jm7w6kj209y03lq30.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k53eg7zvj20e304p749.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k5s7as6sj20dz06l3z3.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k6ip1kt0j20e608lq3b.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k7xzsuxwj20kl0dp0tl.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k9akglc2j20pz09yab5.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k9k5j4u3j20nd067q3h.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5kaoow6psj20dc01jgll.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5l50ln74xj20kk0n3gmi.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5ldm2sdjkj20de05waaa.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5lf67yuw0j20dd035glo.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5ok53g3xnj20l00ddt9j.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5okpgqycfj20yp0i3ta5.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5olbf6aknj20g70e7751.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5pq59ew8aj20im09tmxj.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5pqbt08g4j20nz0eqgmp.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5pqea24gbj20m40bk0tb.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5s6yta79tj20fk0bd3zd.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5sb67tns2j20tu0dodir.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5tf62w1ckj20jp070mxi.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5tf945155j20jg0mqwgn.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5tfa8bkssj20ir0gi75f.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5tfg2mc8bj20xp08idgx.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vl7kqci7j20ly0atjsc.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vl8p3jcoj20og0sygox.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vl9jxt48j20hp0fft9y.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vldbccrej20gh0aot9l.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vlf15ihqj20bc0ciq3n.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vlfbeil7j20b406kq3e.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5wnuqpqahj20z70ec40x.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5wqd1dniwj206i062jrg.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5xzttl6zaj20pr0htq4v.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5y04nr5qaj205p05f3yj.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5z7q7ue96j20kf0bi3zh.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5z7w40abhj20fy0bat9k.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5z7rtyrbpj20ml0mbace.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h605ulllxkj213w0fi418.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h606rb47oaj206c04tglk.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5ps7nq4brj20tj09q756.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5psknvovvj20ng0f376x.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5pslvv6fcj20dz0163yg.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5psmhh15gj20cj01ojrd.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5qvumbdovj205e02mwec.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5qx5q9q7wj20db01zq2x.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r1y5vtwpj20dr02p0sq.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r2xb1wz3j20e402iwej.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r1pb1dddj20p00nttb3.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r2ummw16j20k903emxb.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5qy8xf2mlj20ka02dq30.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5qylx5w19j20j902jq34.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5qzsyx3zxj20fg02hdfw.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r1pb1dddj20p00nttb3.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r1s2cd51j20kf045glt.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r4auzubbj20hv02h0su.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r4ch0lilj20hs02naa2.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r4iz8fa8j20hi02idfx.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r4vw3ma3j20ij02g74d.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r55in7eoj20kb02dglq.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r64q0n6tj20fz02j74c.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r65sgz58j20eb02jdfv.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r60xctkdj20h502oaa4.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r63fps4rj20me0o3di0.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r7bvmn6sj20kc05hmxj.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5s01n74m9j21350bdq49.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/e6c9d24ely1h5s37bwsboj20nr022aa6.jpg">
<meta property="og:updated_time" content="2022-11-15T07:34:47.360Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Golang学习笔记">
<meta name="twitter:image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic.wangt.cc%2Fdownload%2Fpic_router.php%3Fpath%3Dhttps%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F830ee8c79a676e7fb59f28d60bc1556a.png&refer=http%3A%2F%2Fpic.wangt.cc&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1665126986&t=c0c20c712cc14c9e362292f463098285">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":14,"b2t":true,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://imauu.gitee.io/2022/06/02/Golang学习笔记/">






  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "1db79efd"
    });
  daovoice('update');
  </script>



  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "1db79efd"
    });
  daovoice('update');
  </script>



  <title>Golang学习笔记 | 寿司卷code</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <!--
    <a href="https://github.com/shang-code/" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></a>
    -->
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">寿司卷code</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">不拼尽全力试一下，又怎么会知道啊。</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://imauu.gitee.io/2022/06/02/Golang学习笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="尚先森">
      <meta itemprop="description" content>
      <meta itemprop="image" content="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fc-ssl.duitang.com%2Fuploads%2Fitem%2F202003%2F30%2F20200330091314_yNVUZ.thumb.1000_0.jpeg&refer=http%3A%2F%2Fc-ssl.duitang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1679478595&t=f1ad1f61217ae47e4651a721e40a5654">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="寿司卷code">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Golang学习笔记</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2022-06-02T13:59:21+08:00">
                2022-06-02
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2022-11-15T15:34:47+08:00">
                2022-11-15
              </time>
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/开发/" itemprop="url" rel="index">
                    <span itemprop="name">开发</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/开发/Golang/" itemprop="url" rel="index">
                    <span itemprop="name">Golang</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2022/06/02/Golang学习笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2022/06/02/Golang学习笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  64.5k 字
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  286 分钟
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <img src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic.wangt.cc%2Fdownload%2Fpic_router.php%3Fpath%3Dhttps%3A%2F%2Fimg-blog.csdnimg.cn%2Fimg_convert%2F830ee8c79a676e7fb59f28d60bc1556a.png&refer=http%3A%2F%2Fpic.wangt.cc&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1665126986&t=c0c20c712cc14c9e362292f463098285" alt="img" style="zoom:60%;">



<a id="more"></a>

<h1 id="Golang语言简介"><a href="#Golang语言简介" class="headerlink" title="Golang语言简介"></a>Golang语言简介</h1><h2 id="图标上的动物"><a href="#图标上的动物" class="headerlink" title="图标上的动物"></a>图标上的动物</h2><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2tvjag3dej20u014u770.jpg" alt="img" style="zoom:15%;">

<p>这个动物叫做<code>金花鼠</code>,英文名称为<code>gordon</code></p>
<h2 id="Go语言的由来"><a href="#Go语言的由来" class="headerlink" title="Go语言的由来"></a>Go语言的由来</h2><p><strong>目的:</strong> 用更少的代码，更短的编译时间，创建运行更快的程序，享受更多的乐趣。</p>
<p>Go 语言起源 2007 年，并于 2009 年正式对外发布。它从 2009 年 9 月 21 日开始作为谷歌公司 20% 兼职项目，即相关员工利用 20% 的空余时间来参与 Go 语言的研发工作。该项目的三位领导者均是著名的 IT 工程师：Robert Griesemer，参与开发 Java HotSpot 虚拟机；Rob Pike，Go 语言项目总负责人，贝尔实验室 Unix 团队成员，参与的项目包括 Plan 9，Inferno 操作系统和 Limbo 编程语言；Ken Thompson，贝尔实验室 Unix 团队成员，C 语言、Unix 和 Plan 9 的创始人之一，与 Rob Pike 共同开发了 UTF-8 字符集规范。自 2008 年 1 月起，Ken Thompson 就开始研发一款以 C 语言为目标结果的编译器来拓展 Go 语言的设计思想。</p>
<blockquote>
<p>  <strong>这是一个由计算机领域 “发明之父” 所组成的黄金团队，他们对系统编程语言，操作系统和并行都有着非常深刻的见解</strong></p>
</blockquote>
<p>在 2008 年年中，Go 语言的设计工作接近尾声，一些员工开始以全职工作状态投入到这个项目的编译器和运行实现上。Ian Lance Taylor 也加入到了开发团队中，并于 2008 年 5 月创建了一个 gcc 前端。</p>
<p>Russ Cox 加入开发团队后着手语言和类库方面的开发，也就是 Go 语言的标准包。在 2009 年 10 月 30 日，Rob Pike 以 Google Techtalk 的形式第一次向人们宣告了 Go 语言的存在。</p>
<p>直到 2009 年 11 月 10 日，开发团队将 Go 语言项目以 BSD-style 授权（完全开源）正式公布了 Linux 和 Mac OS X 平台上的版本。Hector Chu 于同年 11 月 22 日公布了 Windows 版本。</p>
<p>作为一个开源项目，Go 语言借助开源社区的有生力量达到快速地发展，并吸引更多的开发者来使用并改善它。自该开源项目发布以来，超过 200 名非谷歌员工的贡献者对 Go 语言核心部分提交了超过 1000 个修改建议。在过去的 18 个月里，又有 150 开发者贡献了新的核心代码。这俨然形成了世界上最大的开源团队，并使该项目跻身 Ohloh 前 2% 的行列。大约在 2011 年 4 月 10 日，谷歌开始抽调员工进入全职开发 Go 语言项目。开源化的语言显然能够让更多的开发者参与其中并加速它的发展速度。Andrew Gerrand 在 2010 年加入到开发团队中成为共同开发者与支持者。</p>
<p>在 Go 语言在 2010 年 1 月 8 日被 Tiobe（闻名于它的编程语言流行程度排名）宣布为 “2009 年年度语言” 后，引起各界很大的反响。目前 Go 语言在这项排名中的最高记录是在 2017 年 1 月创下的第13名，流行程度 2.325%。</p>
<ul>
<li>时间轴：</li>
</ul>
<blockquote>
<ul>
<li>2007 年 9 月 21 日：雏形设计</li>
<li>2009 年 11 月 10日：首次公开发布</li>
<li>2010 年 1 月 8 日：当选 2009 年年度语言</li>
<li>2010 年 5 月：谷歌投入使用</li>
<li>2011 年 5 月 5 日：Google App Engine 支持 Go 语言</li>
</ul>
</blockquote>
<p>从 2010 年 5 月起，谷歌开始将 Go 语言投入到后端基础设施的实际开发中，例如开发用于管理后端复杂环境的项目。有句话叫 “吃你自己的狗食”，这也体现了谷歌确实想要投资这门语言，并认为它是有生产价值的。</p>
<p>Go 语言的官方网站是 golang.org，这个站点采用 Python 作为前端，并且使用 Go 语言自带的工具 godoc 运行在 Google App Engine 上来作为 Web 服务器提供文本内容。在官网的首页有一个功能叫做 Go Playground，是一个 Go 代码的简单编辑器的沙盒，它可以在没有安装 Go 语言的情况下在你的浏览器中编译并运行 Go，它提供了一些示例，其中包括国际惯例 “Hello, World!”。</p>
<h2 id="Go语言的特点"><a href="#Go语言的特点" class="headerlink" title="Go语言的特点"></a>Go语言的特点</h2><ol>
<li><p>从 C 语言中继承了很多理念，包括表达式语法，控制结构，基础数据类型，调用参数传值，指针等 等，也保留了和 C 语言一样的编译执行方式及弱化的指针<br> <strong>举一个案例(体验):</strong></p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//go 语言的指针的使用特点(体验) </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testPtr</span><span class="params">(num *<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    *num = <span class="number">20</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>引入包的概念，用于组织程序结构，Go 语言的一个文件都要归属于一个包，而不能单独存在。</p>
</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main	<span class="comment">//一个go文件需要在一个包里</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>垃圾回收机制，内存自动回收，不需开发人员管理</p>
</li>
<li><p>天然并发 (重要特点)<br> (1) 从语言层面支持并发，实现简单<br> (2) goroutine，轻量级线程，可实现大并发处理，高效利用多核。<br> (3) 基于 CPS 并发模型(Communicating Sequential Processes )实现</p>
</li>
<li><p>吸收了管道通信机制，形成 Go 语言特有的管道 channel 通过管道 channel , 可以实现不同的 goroute 之间的相互通信。</p>
</li>
<li><p>函数可以返回多个值。举例: //写一个函数，实现同时返回 和，差</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//go 函数支持返回多个值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSumAndSub</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span> )</span></span> &#123;</span><br><span class="line">    sum := n1 + n2 <span class="comment">//go 语句后面不要带分号. </span></span><br><span class="line">    sub := n1 - n2</span><br><span class="line">    <span class="keyword">return</span> sum , sub</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>新的创新:比如切片 slice、延时执行 defer</p>
</li>
</ol>
<h1 id="Golang环境配置"><a href="#Golang环境配置" class="headerlink" title="Golang环境配置"></a>Golang环境配置</h1><h2 id="Mac-下搭建-Go-开发环境-安装和配置-SDK"><a href="#Mac-下搭建-Go-开发环境-安装和配置-SDK" class="headerlink" title="Mac 下搭建 Go 开发环境-安装和配置 SDK"></a>Mac 下搭建 Go 开发环境-安装和配置 SDK</h2><h3 id="安装SDK"><a href="#安装SDK" class="headerlink" title="安装SDK"></a>安装SDK</h3><p>安装包名称: <code>go1.9.2.darwin-amd64.tar.gz</code></p>
<p>链接: <a href="https://pan.baidu.com/s/19GZeuyrJl8B7nByqtk5FDQ" target="_blank" rel="noopener">https://pan.baidu.com/s/19GZeuyrJl8B7nByqtk5FDQ</a> 提取码: 4cqv</p>
<p>上传位置: Mac 一般放在用户目录下 <code>go_dev/go</code> 下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> ~ mkdir -p go_dev/go</span><br><span class="line"> ~ cd go_dev/go</span><br><span class="line"> ~/go_dev/go ls</span><br><span class="line">go1.9.2.darwin-amd64.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解压压缩包</span></span><br><span class="line"> ~/go_dev/go tar xf go1.9.2.darwin-amd64.tar.gz</span><br><span class="line"> ~/go_dev/go ls</span><br><span class="line">go                          go1.9.2.darwin-amd64.tar.gz</span><br><span class="line"></span><br><span class="line"> ~/go_dev/go ls go</span><br><span class="line">AUTHORS         CONTRIBUTORS    PATENTS         VERSION         bin             doc             lib             pkg             src</span><br><span class="line">CONTRIBUTING.md LICENSE         README.md       api             blog            favicon.ico     misc            robots.txt      test</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2u7ztpmyqj21pc0l679g.jpg" alt="image-20220602212849223"></p>
<h3 id="Mac-下配置-Golang-环境变量"><a href="#Mac-下配置-Golang-环境变量" class="headerlink" title="Mac 下配置 Golang 环境变量"></a>Mac 下配置 Golang 环境变量</h3><p>使用 root 用户，修改 /etc/profile 增加环境变量的配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">~ sudo vim /etc/profile</span><br><span class="line"><span class="comment"># 最下方添加如下内容</span></span><br><span class="line"><span class="built_in">export</span> GOROOT=<span class="variable">$HOME</span>/go_dev/go/go</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:<span class="variable">$GOROOT</span>/bin</span><br><span class="line"><span class="built_in">export</span> GOPATH=<span class="variable">$HOME</span>/goproject</span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置立即生效</span></span><br><span class="line">~ <span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看golang版本</span></span><br><span class="line">~ go version</span><br><span class="line">go version go1.9.2 darwin/amd64</span><br></pre></td></tr></table></figure>

<h1 id="Mac下如何开发Go程序"><a href="#Mac下如何开发Go程序" class="headerlink" title="Mac下如何开发Go程序"></a>Mac下如何开发Go程序</h1><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>打开VSCode,创建对应的目录</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2v10t7f6cj21em0f2wgg.jpg" alt="image-20220603141311064"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	fmt.Println(<span class="string">"hello world"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="生成可执行文件并运行"><a href="#生成可执行文件并运行" class="headerlink" title="生成可执行文件并运行"></a>生成可执行文件并运行</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> ~  cd goproject/src/go_code/project01/main</span><br><span class="line"> ~/goproject/src/go_code/project01/main  ls</span><br><span class="line">hello.go</span><br><span class="line"> ~/goproject/src/go_code/project01/main  go build hello.go</span><br><span class="line"> ~/goproject/src/go_code/project01/main  ls</span><br><span class="line">hello    hello.go</span><br><span class="line"> ~/goproject/src/go_code/project01/main  ./hello</span><br><span class="line">hello world</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2v12urqn7j20tq0bggnz.jpg" alt="image-20220603141508417" style="zoom: 50%;">

<p>我们也可以使用<code>-o</code>指定当前生成的二进制文件的名称</p>
<figure class="highlight golang"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~/goproject/src/go_code/project01/main  <span class="keyword">go</span> build -o hello1 hello.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>

<p>生成linux平台可执行的二进制文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GOOS=linux GOARCH=amd64 go build -o hello1 hello.go</span><br></pre></td></tr></table></figure>

<h2 id="直接运行Go文件"><a href="#直接运行Go文件" class="headerlink" title="直接运行Go文件"></a>直接运行Go文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> ~/goproject/src/go_code/project01/main  go run hello.go</span><br><span class="line">hello world</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2v14wsgypj20tq03et95.jpg" alt="image-20220603141707130" style="zoom:50%;">



<h1 id="Go开发须知"><a href="#Go开发须知" class="headerlink" title="Go开发须知"></a>Go开发须知</h1><h2 id="Go程序开发的注意事项"><a href="#Go程序开发的注意事项" class="headerlink" title="Go程序开发的注意事项"></a>Go程序开发的注意事项</h2><p>1) Go 源文件以 “go” 为扩展名。<br>2) Go应用程序的执行入口是main()函数。这个是和其它编程语言(比如java/c)<br>3) Go语言严格区分大小写。<br>4) Go方法由一条条语句构成，每个语句后不需要分号(Go语言会在每行后自动加分号)，这也体现出 Golang 的简洁性。<br>5) Go编译器是一行行进行编译的，因此我们一行就写一条语句，不能把多条语句写在同一个，否则报错<br>6) Go语言定义的变量或者import的包如果没有使用到，代码不能编译通过。<br>7) 大括号都是成对出现的，缺一不可。</p>
<h2 id="Go-语言的转义字符-escape-char"><a href="#Go-语言的转义字符-escape-char" class="headerlink" title="Go 语言的转义字符(escape char)"></a>Go 语言的转义字符(escape char)</h2><p>说明:常用的转义字符有如下:<br>1) \t : 表示一个制表符，通常使用它可以排版。<br>1) \n :换行符<br>3) \ :一个<br>4) &quot; :一个”<br>5) \r :一个回车 fmt.Println(“天龙八部雪山飞狐\r 张飞”);</p>
<p><strong>举例:</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span> <span class="comment">//fmt 包中提供格式化，输出，输入的函数.</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"><span class="comment">//要求:要求:请使用一句输出语句，达到输入如下图形的效果</span></span><br><span class="line">	fmt.Println(<span class="string">"姓名\t 年龄\t 籍贯\t 地址\njohn\t20\t 河北\t 北京"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>输出如下:</p>
<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h2wbuueukpj20ou0943z9.jpg" alt="image-20220604171333256" style="zoom:50%;">

<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><p>Go中的注释分为行注释与块注释</p>
<p><strong>行注释:</strong><code>//</code></p>
<p><strong>块注释:</strong><code>/* 内容 */</code></p>
<h2 id="代码风格"><a href="#代码风格" class="headerlink" title="代码风格"></a>代码风格</h2><p>正确格式:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	fmt.Println(<span class="string">"hello,world!"</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>错误格式:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	fmt.Println(<span class="string">"hello,world!"</span>) </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  一行字符最长不超过 80 个字符，超过的请使用换行展示，尽量保持格式优雅</p>
</blockquote>
<h2 id="官方指南"><a href="#官方指南" class="headerlink" title="官方指南"></a>官方指南</h2><p>在线调试地址: <a href="https://go.dev/play/" target="_blank" rel="noopener">https://go.dev/play/</a></p>
<p>包使用查询: <a href="https://pkg.go.dev/" target="_blank" rel="noopener">https://pkg.go.dev/</a></p>
<h2 id="中文版在线标准库文档"><a href="#中文版在线标准库文档" class="headerlink" title="中文版在线标准库文档"></a>中文版在线标准库文档</h2><p>地址: <a href="https://studygolang.com/pkgdoc" target="_blank" rel="noopener">https://studygolang.com/pkgdoc</a></p>
<h1 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h1><h2 id="Golang变量使用的三种方式"><a href="#Golang变量使用的三种方式" class="headerlink" title="Golang变量使用的三种方式"></a>Golang变量使用的三种方式</h2><ul>
<li>第一种:指定变量类型，声明后若不赋值，使用默认值</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h381a55v43j21cx0u0n05.jpg" alt="image-20220614201426090"></p>
<ul>
<li>第二种:根据值自行判定变量类型(类型推导)</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h381cnkxwpj21br0u077c.jpg" alt="image-20220614201653849"></p>
<ul>
<li>第三种:省略 var, 注意 :=左侧的变量不应该是已经声明过的，否则会导致编译错误</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h381fj3xgaj21gv0u041q.jpg" alt="image-20220614201938837"></p>
<ul>
<li>多变量声明</li>
</ul>
<blockquote>
<p>  在编程中，有时我们需要一次性声明多个变量，Golang 也提供这样的语法</p>
</blockquote>
<p>举例说明:</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h381pjqth6j21ho0u0wii.jpg" alt="image-20220614202917231"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//一次性声明多个变量</span></span><br><span class="line">    <span class="comment">//方式一</span></span><br><span class="line">    <span class="comment">// var n1, n2, n3 int</span></span><br><span class="line">    <span class="comment">// fmt.Println("n1=",n1, "n2=",n2, "n3=",n3)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//方式二</span></span><br><span class="line">    <span class="comment">// var n1, name, n3 = 100, "tom", 888</span></span><br><span class="line">    <span class="comment">// fmt.Println("n1=",n1, "name=", name, "n3=", n3)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//方式三</span></span><br><span class="line">    n1, name, n3 := <span class="number">100</span>, <span class="string">"tom~"</span>, <span class="number">888</span></span><br><span class="line">    fmt.Println(<span class="string">"n1="</span>,n1, <span class="string">"name="</span>, name, <span class="string">"n3="</span>, n3)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如何一次性声明多个<code>全局变量</code>【在 go 中函数外部定义变量就是全局变量】:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义全局变量</span></span><br><span class="line"><span class="keyword">var</span> n1 = <span class="number">100</span></span><br><span class="line"><span class="keyword">var</span> n2 = <span class="number">200</span></span><br><span class="line"><span class="keyword">var</span> name = <span class="string">"jack"</span></span><br><span class="line"><span class="comment">//上面的声明方式,也可以改成一次性声明</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    n3 = <span class="number">300</span></span><br><span class="line">    n4 = <span class="number">900</span></span><br><span class="line">    name2 = <span class="string">"mary"</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ul>
<li>该区域的数据值可以在同一类型范围内不断变化(重点)</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 变量使用的注意事项</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">	i = <span class="number">20</span></span><br><span class="line">	i = <span class="number">30</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"i="</span>, i)</span><br><span class="line">	i = <span class="number">1.2</span> 	<span class="comment">// 这样写是错误的,不可以改变数据的类型</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4434no1qij211m03a3z8.jpg" alt="image-20220712133621221"></p>
<ul>
<li>变量在同一个作用域(在一个函数或者在代码块)内不能重名</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 变量使用的注意事项</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">	i = <span class="number">20</span></span><br><span class="line">	i = <span class="number">30</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"i="</span>, i)</span><br><span class="line">	<span class="comment">//i = 1.2 	// 这样写是错误的,不可以改变数据的类型</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 变量在同一个作用域(在一个函数或者在代码块)内不能重名</span></span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">66</span></span><br><span class="line">	i := <span class="number">77</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h443enoc5ej20ew06mq2y.jpg" alt="image-20220712134606264" style="zoom:50%;">

<ul>
<li>变量=变量名+值+数据类型，这一点请大家注意，变量的三要素</li>
<li>Golang 的变量如果没有赋初值，编译器会使用默认值, 比如 int 默认值 0,string 默认值为空串，小数默认为 0</li>
</ul>
<h2 id="变量的声明-初始化-赋值"><a href="#变量的声明-初始化-赋值" class="headerlink" title="变量的声明/初始化/赋值"></a>变量的声明/初始化/赋值</h2><h3 id="声明变量"><a href="#声明变量" class="headerlink" title="声明变量"></a>声明变量</h3><p><strong>基本语法:</strong> <code>var 变量名 数据类型</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//举例子</span></span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">int</span>	<span class="comment">//声明一个int类型的变量 i,若不赋值,默认值为0</span></span><br><span class="line"><span class="keyword">var</span> s <span class="keyword">string</span>	<span class="comment">//声明一个string类型的变量 s,若不赋值,默认值为""</span></span><br></pre></td></tr></table></figure>

<h3 id="初始化变量"><a href="#初始化变量" class="headerlink" title="初始化变量"></a>初始化变量</h3><p><strong>基本语法:</strong> <code>var 变量名 数据类型 = 值</code></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//举例子</span></span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> s <span class="keyword">string</span> = <span class="string">"hello world"</span></span><br></pre></td></tr></table></figure>

<h3 id="给变量赋值"><a href="#给变量赋值" class="headerlink" title="给变量赋值"></a>给变量赋值</h3><blockquote>
<p>  先声明变量,再给变量赋值</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//举例子</span></span><br><span class="line"><span class="keyword">var</span> i <span class="keyword">int</span></span><br><span class="line">i = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//上面这种写法等于下面这种</span></span><br><span class="line">i := <span class="number">10</span> <span class="comment">//自动判断数值类型</span></span><br></pre></td></tr></table></figure>

<h2 id="号的使用"><a href="#号的使用" class="headerlink" title="+号的使用"></a>+号的使用</h2><ul>
<li><p>当左右两边都是数值型时，则做加法运算</p>
</li>
<li><p>当左右两边都是字符串，则做字符串拼接</p>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 数值相加</span></span><br><span class="line">	i := <span class="number">1</span></span><br><span class="line">	j := <span class="number">2</span></span><br><span class="line">	sum := i + j</span><br><span class="line">	fmt.Println(sum)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 字符拼接</span></span><br><span class="line">	s1 := <span class="string">"hello"</span></span><br><span class="line">	s2 := <span class="string">"world"</span></span><br><span class="line">	s := s1 + s2</span><br><span class="line">	fmt.Println(s)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4455m43qdj20x40hqn0b.jpg" alt="image-20220712144636767"></p>
<h3 id="整数类型"><a href="#整数类型" class="headerlink" title="整数类型"></a>整数类型</h3><table>
<thead>
<tr>
<th>类型</th>
<th>占用存储空间</th>
<th>表数范围</th>
</tr>
</thead>
<tbody><tr>
<td>int8</td>
<td>1字节</td>
<td>-128-127</td>
</tr>
<tr>
<td>int16</td>
<td>2字节</td>
<td>-2^15-2^15-1</td>
</tr>
<tr>
<td>int32</td>
<td>4字节</td>
<td>-2^31-2^31-1</td>
</tr>
<tr>
<td>int64</td>
<td>8字节</td>
<td>-2^63-2^63-1</td>
</tr>
</tbody></table>
<ul>
<li>其他整数类型</li>
</ul>
<table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">有无符号</th>
<th align="center">占用存储空间</th>
<th align="left">表数范围</th>
<th align="left">备注</th>
</tr>
</thead>
<tbody><tr>
<td align="center">int</td>
<td align="center">有</td>
<td align="center">32位系统4个字节<br>64位系统8个字节</td>
<td align="left">-2^31 ~ 2^31-1<br>-2^63 ~ 2^63-1</td>
<td align="left"></td>
</tr>
<tr>
<td align="center">uint</td>
<td align="center">无</td>
<td align="center">32位系统4个字节<br>64位系统8个字节</td>
<td align="left">0 ~ 2^32-1<br>0 ~ 2^64-1</td>
<td align="left"></td>
</tr>
<tr>
<td align="center">rune</td>
<td align="center">有</td>
<td align="center">与int32一样</td>
<td align="left">-2^31 ~ 2^31-1</td>
<td align="left">等价int32,表示一个Unicode码</td>
</tr>
<tr>
<td align="center">byte</td>
<td align="center">无</td>
<td align="center">与uint8一样</td>
<td align="left">0 ~ 255</td>
<td align="left">当要存储字符时选用byte</td>
</tr>
</tbody></table>
<h4 id="整数型使用细节"><a href="#整数型使用细节" class="headerlink" title="整数型使用细节"></a>整数型使用细节</h4><ul>
<li>Golang 各整数类型分:有符号和无符号，int uint 的大小和系统有关。</li>
<li>Golang 的整型默认声明为 int 型</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i = <span class="number">100</span> <span class="comment">//此时 i 是什么类型?</span></span><br><span class="line">	<span class="comment">//查看数据类型</span></span><br><span class="line">	fmt.Printf(<span class="string">"i的数据类型为 %T \n"</span>, i)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h445vqa759j20uk01mglv.jpg" alt="image-20220712151142979"></p>
<ul>
<li>如何在程序查看某个变量的字节大小和数据类型 (使用较多)</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"unsafe"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int64</span> = <span class="number">100</span> <span class="comment">//此时 i 是什么类型?</span></span><br><span class="line">	<span class="comment">//查看数据类型</span></span><br><span class="line">	fmt.Printf(<span class="string">"i的数据类型为 %T , 占用字节数为 %d\n"</span>, i, unsafe.Sizeof(i))</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h445zb24g1j20ue01mgm0.jpg" alt="image-20220712151508731"></p>
<ul>
<li>Golang程序中整型变量在使用时，遵守保小不保大的原则，即:在保证程序正确运行下，尽量使用占用空间小的数据类型。【如:年龄】</li>
<li>bit: 计算机中的最小存储单位。byte:计算机中基本存储单元。[二进制再详细说] 1byte = 8 bit</li>
</ul>
<h3 id="浮点数类型"><a href="#浮点数类型" class="headerlink" title="浮点数类型"></a>浮点数类型</h3><table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">占用存储空间</th>
<th align="center">表数范围</th>
</tr>
</thead>
<tbody><tr>
<td align="center">单精度float32</td>
<td align="center">4字节</td>
<td align="center">-3.403E38 ~ 3.403E38</td>
</tr>
<tr>
<td align="center">双精度float64</td>
<td align="center">8字节</td>
<td align="center">-1.798E308 ~ 1.798E308</td>
</tr>
</tbody></table>
<ul>
<li>关于浮点数在机器中存放形式的简单说明,浮点数=符号位+指数位+尾数位<br>说明:浮点数都是有符号的.</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">float32</span> = <span class="number">12.34</span></span><br><span class="line">	<span class="keyword">var</span> n1 <span class="keyword">float32</span> = <span class="number">-0.00089</span></span><br><span class="line">	<span class="keyword">var</span> n2 <span class="keyword">float64</span> = <span class="number">-7809656.09</span></span><br><span class="line">	fmt.Println(<span class="string">"i="</span>, i, <span class="string">"n1="</span>, n1, <span class="string">"n2="</span>, n2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4467n71tbj20ue01kwev.jpg" alt="image-20220712152309512"></p>
<ul>
<li>尾数部分可能丢失，造成精度损失。 -123.0000901</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> n1 <span class="keyword">float32</span> = <span class="number">-123.0000901</span></span><br><span class="line">	<span class="keyword">var</span> n2 <span class="keyword">float64</span> = <span class="number">-123.0000901</span></span><br><span class="line">	fmt.Println(<span class="string">"n1="</span>, n1, <span class="string">"n2="</span>, n2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h446m91q3qj20u801gglx.jpg" alt="image-20220712153712369"></p>
<blockquote>
<p>   说明: float64 的精度比 float32 的要准确.如果我们要保存一个精度高的数，则应该选用 float64</p>
</blockquote>
<ul>
<li>浮点型的存储分为三部分:符号位+指数位+尾数位 在存储过程中，精度会有丢失</li>
</ul>
<h4 id="浮点型使用细节"><a href="#浮点型使用细节" class="headerlink" title="浮点型使用细节"></a>浮点型使用细节</h4><ul>
<li>Golang浮点类型有固定的范围和字段长度,不受具体OS(操作系统)的影响</li>
<li>Golang 的浮点型默认声明为 float64 类型。</li>
<li>浮点型常量有两种表示形式<ul>
<li>十进制数形式:如:5.12 .512 (必须有小数点) </li>
<li>科学计数法形式:如:5.1234e2 = 5.12 * 10 的 2 次方          5.12E-2 = 5.12/10 的 2 次方</li>
</ul>
</li>
<li>通常情况下，应该使用 float64 ，因为它比 float32 更精确。</li>
</ul>
<h3 id="字符类型"><a href="#字符类型" class="headerlink" title="字符类型"></a>字符类型</h3><blockquote>
<p>  Golang 中没有专门的字符类型，如果要存储单个字符(字母)，一般使用 byte 来保存。<br>  字符串就是一串固定长度的字符连接起来的字符序列。Go 的字符串是由单个字节连接起来的。也 就是说对于传统的字符串是由字符组成的，而 Go 的字符串不同，它是由字节组成的。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> c1 <span class="keyword">byte</span> = <span class="string">'a'</span></span><br><span class="line">	<span class="keyword">var</span> c2 <span class="keyword">byte</span> = <span class="string">'o'</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 当我们直接输出byte值,就是输出了对应的字符的码值</span></span><br><span class="line">	fmt.Println(<span class="string">"c1="</span>, c1)</span><br><span class="line">	fmt.Println(<span class="string">"c2="</span>, c2)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 如果想要输出对应的字符,需要使用格式化输出</span></span><br><span class="line">	fmt.Printf(<span class="string">"c1=%c, c2=%c"</span>, c1, c2)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> c3 <span class="keyword">byte</span> = <span class="string">"北"</span> <span class="comment">//报错,overflow溢出</span></span><br><span class="line">	fmt.Printf(<span class="string">"c3=%c, 对应的码值为%d"</span>, c3, c3)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4479bm0gvj211402kwf9.jpg" alt="image-20220712155922714"></p>
<p>对上面代码说明:</p>
<p>1) 如果我们保存的字符在 ASCII 表的,比如[0-1, a-z,A-Z..]直接可以保存到 byte<br>2) 如果我们保存的字符对应码值大于 255,这时我们可以考虑使用 int 类型保存<br>3) 如果我们需要安装字符的方式输出，这时我们需要格式化输出，即 fmt.Printf(“%c”, c1).</p>
<h4 id="字符类型使用细节"><a href="#字符类型使用细节" class="headerlink" title="字符类型使用细节"></a>字符类型使用细节</h4><p>1) 字符常量是用单引号(‘’)括起来的单个字符。例如:var c1 byte = ‘a’ var c2 int = ‘中’ var c3 byte = ‘9’<br>2) Go 中允许使用转义字符 ‘\’来将其后的字符转变为特殊字符型常量。例如:var c3 char = ‘\n’ // ‘\n’表示换行符<br>3) Go 语言的字符使用 UTF-8 编码 ，如果想查询字符对应的 utf8 码值 <a href="http://www.mytju.com/classcode/tools/encode_utf8.asp" target="_blank" rel="noopener">http://www.mytju.com/classcode/tools/encode_utf8.asp</a><br>    英文字母-1个字节 汉字-3个字节<br>4) 在 Go 中，字符的本质是一个整数，直接输出时，是该字符对应的 UTF-8 编码的码值。<br>5) 可以直接给某个变量赋一个数字，然后按格式化输出时%c，会输出该数字对应的 unicode 字符<br>6) 字符类型是可以进行运算的，相当于一个整数，因为它都对应有 Unicode 码.</p>
<h3 id="布尔类型"><a href="#布尔类型" class="headerlink" title="布尔类型"></a>布尔类型</h3><ul>
<li><p>布尔类型也叫 bool 类型，bool 类型数据只允许取值 true 和 false</p>
</li>
<li><p>bool类型占1个字节。</p>
</li>
<li><p>bool 类型适于逻辑运算，一般用于程序流程控制</p>
</li>
</ul>
<h3 id="string类型"><a href="#string类型" class="headerlink" title="string类型"></a>string类型</h3><blockquote>
<p>  字符串就是一串固定长度的字符连接起来的字符序列。Go 的字符串是由单个字节连接起来的。Go 语言的字符串的字节使用 UTF-8 编码标识 Unicode 文本</p>
</blockquote>
<ul>
<li><p>Go语言的字符串的字节使用UTF-8编码标识Unicode文本，这样Golang统一使用UTF-8编码,中文 乱码问题不会再困扰程序员。</p>
</li>
<li><p>字符串一旦赋值了，字符串就不能修改了:在 Go 中字符串是不可变的。</p>
</li>
<li><p>字符串的两种表示形式:<br>(1) 双引号, 会识别转义字符<br>(2) 反引号，以字符串的原生形式输出，包括换行和特殊字符，可以实现防止攻击、输出源代码等效果</p>
</li>
<li><p>字符串拼接方式</p>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str := <span class="string">"hello"</span> + <span class="string">"world"</span></span><br><span class="line">str += <span class="string">"haha"</span></span><br></pre></td></tr></table></figure>

<ul>
<li>当一行字符串太长时，需要使用到多行字符串，可以如下处理</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 结尾需要跟上 + 号,才能跟下一行拼接</span></span><br><span class="line">	<span class="keyword">var</span> s1 <span class="keyword">string</span> = <span class="string">"hello "</span> + <span class="string">"world "</span> + <span class="string">"I "</span> + <span class="string">"am "</span> +</span><br><span class="line">		<span class="string">"chinese\n"</span></span><br><span class="line">	fmt.Println(s1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="基本数据类型的默认值"><a href="#基本数据类型的默认值" class="headerlink" title="基本数据类型的默认值"></a>基本数据类型的默认值</h3><table>
<thead>
<tr>
<th>数据类型</th>
<th>默认值</th>
</tr>
</thead>
<tbody><tr>
<td>整型</td>
<td>0</td>
</tr>
<tr>
<td>浮点型</td>
<td>0</td>
</tr>
<tr>
<td>字符串</td>
<td>“”</td>
</tr>
<tr>
<td>布尔类型</td>
<td>false</td>
</tr>
</tbody></table>
<h3 id="基本数据类型的相互转换"><a href="#基本数据类型的相互转换" class="headerlink" title="基本数据类型的相互转换"></a>基本数据类型的相互转换</h3><blockquote>
<p>  Golang 和 java / c 不同，Go 在不同类型的变量之间赋值时需要显式转换。也就是说 Golang 中数 据类型不能自动转换。</p>
</blockquote>
<ul>
<li>表达式 T(v) 将值 v 转换为类型 T<ul>
<li>T: 就是数据类型，比如 int32，int64，float32 等等 </li>
<li>v: 就是需要转换的变量</li>
</ul>
</li>
</ul>
<h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><p>1) Go中，数据类型的转换可以是从表示范围小–&gt;表示范围大，也可以范围大—&gt;范围小<br>2) 被转换的是变量存储的数据(即值)，变量本身的数据类型并没有变化!<br>3) 在转换中，比如将 int64 转成 int8 【-128—127】 ，编译时不会报错，只是转换的结果是按 溢出处理，和我们希望的结果不一样。 因此在转换时，需要考虑范围.</p>
<h3 id="基本数据类型转换为string"><a href="#基本数据类型转换为string" class="headerlink" title="基本数据类型转换为string"></a>基本数据类型转换为string</h3><h4 id="方式一-fmt-Sprintf"><a href="#方式一-fmt-Sprintf" class="headerlink" title="方式一:fmt.Sprintf"></a>方式一:fmt.Sprintf</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> num1 <span class="keyword">int64</span> = <span class="number">10</span></span><br><span class="line">	<span class="keyword">var</span> num2 <span class="keyword">float64</span> = <span class="number">10.12</span></span><br><span class="line">	<span class="keyword">var</span> b <span class="keyword">bool</span> = <span class="literal">false</span></span><br><span class="line">	<span class="keyword">var</span> char <span class="keyword">byte</span> = <span class="string">'h'</span></span><br><span class="line">	<span class="keyword">var</span> str <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">	str = fmt.Sprintf(<span class="string">"%d"</span>, num1)</span><br><span class="line">	fmt.Printf(<span class="string">"str Type %T, str=%q\n"</span>, str, str)</span><br><span class="line"></span><br><span class="line">	str = fmt.Sprintf(<span class="string">"%f"</span>, num2)</span><br><span class="line">	fmt.Printf(<span class="string">"str Type %T, str=%q\n"</span>, str, str)</span><br><span class="line"></span><br><span class="line">	str = fmt.Sprintf(<span class="string">"%t"</span>, b)</span><br><span class="line">	fmt.Printf(<span class="string">"str Type %T, str=%q\n"</span>, str, str)</span><br><span class="line"></span><br><span class="line">	str = fmt.Sprintf(<span class="string">"%c"</span>, char)</span><br><span class="line">	fmt.Printf(<span class="string">"str Type %T, str=%q\n"</span>, str, str)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h448yn0ifuj20vq040wf5.jpg" alt="image-20220712165818290"></p>
<h4 id="方式二-strconv"><a href="#方式二-strconv" class="headerlink" title="方式二:strconv"></a>方式二:strconv</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第二种方式</span></span><br><span class="line"><span class="keyword">var</span> num3 <span class="keyword">int32</span> = <span class="number">99</span></span><br><span class="line"><span class="keyword">var</span> num4 <span class="keyword">float32</span> = <span class="number">12.3456</span></span><br><span class="line"><span class="keyword">var</span> b2 <span class="keyword">bool</span> = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">str = strconv.FormatInt(<span class="keyword">int64</span>(num3), <span class="number">10</span>)	<span class="comment">//必须转换为64</span></span><br><span class="line">fmt.Printf(<span class="string">"str Type %T, str=%q\n"</span>, str, str)</span><br><span class="line"></span><br><span class="line">str = strconv.FormatFloat(<span class="keyword">float64</span>(num4), <span class="string">'f'</span>, <span class="number">10</span>, <span class="number">32</span>)	<span class="comment">//必须转换为64</span></span><br><span class="line">fmt.Printf(<span class="string">"str Type %T, str=%q\n"</span>, str, str)</span><br><span class="line"></span><br><span class="line">str = strconv.FormatBool(b2)</span><br><span class="line">fmt.Printf(<span class="string">"str Type %T, str=%q\n"</span>, str, str)</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h449ig4u1nj20wa06cgmq.jpg" alt="image-20220712171720242"></p>
<h3 id="string转换为基本数据类型"><a href="#string转换为基本数据类型" class="headerlink" title="string转换为基本数据类型"></a>string转换为基本数据类型</h3><blockquote>
<p>  strconv.Parsexxx</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"strconv"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> str <span class="keyword">string</span> = <span class="string">"true"</span></span><br><span class="line">	<span class="keyword">var</span> b <span class="keyword">bool</span></span><br><span class="line">	<span class="comment">// strconv.ParseBool(str)会返回两个值(value bool, err error),我们不需要error信息</span></span><br><span class="line">	b, _ = strconv.ParseBool(str)</span><br><span class="line">	fmt.Printf(<span class="string">"b Type %T, b=%v\n"</span>, b, b)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> str2 <span class="keyword">string</span> = <span class="string">"123456"</span></span><br><span class="line">	<span class="keyword">var</span> num1 <span class="keyword">int64</span> <span class="comment">//必须为64才能被 strconv.ParseInt 识别</span></span><br><span class="line">	<span class="keyword">var</span> num2 <span class="keyword">int</span></span><br><span class="line">	num1, _ = strconv.ParseInt(str2, <span class="number">10</span>, <span class="number">64</span>)</span><br><span class="line">	num2 = <span class="keyword">int</span>(num1)</span><br><span class="line">	fmt.Printf(<span class="string">"num1 type %T, num1=%v\n"</span>, num1, num1)</span><br><span class="line">	fmt.Printf(<span class="string">"num2 type %T, num2=%v\n"</span>, num2, num2)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> str3 <span class="keyword">string</span> = <span class="string">"123.456"</span></span><br><span class="line">	<span class="keyword">var</span> f1 <span class="keyword">float64</span></span><br><span class="line">	f1, _ = strconv.ParseFloat(str3, <span class="number">64</span>)</span><br><span class="line">	fmt.Printf(<span class="string">"f1 Type %T, f1=%v"</span>, f1, f1)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="注意事项-1"><a href="#注意事项-1" class="headerlink" title="注意事项"></a>注意事项</h4><p>在将 String 类型转成 基本数据类型时，要确保 String 类型能够转成有效的数据，比如 我们可以 把 “123” , 转成一个整数，但是不能把 “hello” 转成一个整数，如果这样做，Golang 直接将其转成 0 ， 其它类型也是一样的道理. float =&gt; 0 bool =&gt; false</p>
<h2 id="指针"><a href="#指针" class="headerlink" title="指针"></a>指针</h2><h3 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h3><ul>
<li><p>基本数据类型，变量存的就是值，也叫值类型</p>
</li>
<li><p>获取变量的地址，用&amp;，比如: var num int, 获取 num 的地址:&amp;num<br>分析一下基本数据类型在内存的布局.</p>
</li>
<li><p>指针类型，指针变量存的是一个地址，这个地址指向的空间存的才是值 </p>
<p>比如:var ptr *int = &amp;num</p>
<p>举例说明:指针在内存的布局.</p>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"i的地址为="</span>, &amp;i)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> ptr *<span class="keyword">int</span> = &amp;i</span><br><span class="line">	fmt.Printf(<span class="string">"ptr=%v\n"</span>, ptr)</span><br><span class="line">	fmt.Printf(<span class="string">"ptr的地址=%v\n"</span>, &amp;ptr)</span><br><span class="line">	fmt.Printf(<span class="string">"ptr指向的值=%v\n"</span>, *ptr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h45g1ttklgj20iw042q3f.jpg" alt="image-20220713174905334" style="zoom:67%;">

<h4 id="案例演示"><a href="#案例演示" class="headerlink" title="案例演示"></a>案例演示</h4><p>1)   写一个程序，获取一个 int 变量 num 的地址，并显示到终端<br>2)   将 num 的地址赋给指针 ptr , 并通过 ptr 去修改 num 的值.</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> num <span class="keyword">int</span> = <span class="number">9</span></span><br><span class="line">	fmt.Println(<span class="string">"num="</span>, num)     <span class="comment">// 输出值</span></span><br><span class="line">	fmt.Println(<span class="string">"num的地址="</span>, &amp;num) <span class="comment">// 输出地址</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 通过指针修改num的值为10</span></span><br><span class="line">	<span class="keyword">var</span> ptr *<span class="keyword">int</span></span><br><span class="line">	ptr = &amp;num</span><br><span class="line">	*ptr = <span class="number">10</span></span><br><span class="line">	fmt.Println(<span class="string">"num="</span>, num)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h45gf5bl4pj20j6038q36.jpg" alt="image-20220713180155567"></p>
<h3 id="使用细节"><a href="#使用细节" class="headerlink" title="使用细节"></a>使用细节</h3><p>1) 值类型，都有对应的指针类型， 形式为 <code>*数据类型</code>，比如 int 的对应的指针就是 *int, float32 对应的指针类型就是 *float32, 依次类推。<br>2) 值类型包括:基本数据类型 <code>int 系列</code>,<code>float 系列</code>, <code>bool</code>, <code>string</code> 、<code>数组</code>和<code>结构体 struct</code></p>
<h2 id="值类型和引用类型"><a href="#值类型和引用类型" class="headerlink" title="值类型和引用类型"></a>值类型和引用类型</h2><p>1)   值类型:基本数据类型 int 系列, float 系列, bool, string 、数组和结构体 struct<br>2)   引用类型:指针、slice 切片、map、管道 chan、interface 等都是引用类型</p>
<h3 id="使用特点"><a href="#使用特点" class="headerlink" title="使用特点"></a>使用特点</h3><ul>
<li>值类型</li>
</ul>
<blockquote>
<p>   变量直接存储值，内存通常在栈中分配</p>
</blockquote>
 <img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h46gevbh92j21300cg752.jpg" alt="image-20220714144713333" style="zoom:33%;">

<ul>
<li>引用类型</li>
</ul>
<blockquote>
<p>  变量存储的是一个地址，这个地址对应的空间才真正存储数据(值)，内存通常在堆上分配，当没有任何变量引用这个地址时，该地址对应的数据空间就成为一个垃圾，由 GC 来回收</p>
</blockquote>
<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h46gcmqttfj217w0co759.jpg" alt="image-20220714144504424" style="zoom: 33%;">

<ul>
<li>内存的栈区和堆区示意图</li>
</ul>
<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h46gfj52gyj211u0iyjt6.jpg" alt="image-20220714144751395" style="zoom:50%;">



<h2 id="标识符的命名规范"><a href="#标识符的命名规范" class="headerlink" title="标识符的命名规范"></a>标识符的命名规范</h2><h3 id="标识符概念"><a href="#标识符概念" class="headerlink" title="标识符概念"></a>标识符概念</h3><p>1) Golang 对各种变量、方法、函数等命名时使用的字符序列称为标识符<br>2) 凡是自己可以起名字的地方都叫标识符</p>
<h3 id="命名规则"><a href="#命名规则" class="headerlink" title="命名规则"></a>命名规则</h3><p>1) 由 26 个英文字母大小写，0-9 ，_ 组成<br>2) 数字不可以开头。var num int //ok var 3num int //error<br>3) Golang中严格区分大小写。<br>    var num int<br>    var Num int<br>    说明:在 golang 中，num 和 Num 是两个不同的变量<br>4) 标识符不能包含空格。<br>5) 下划线”_”本身在 Go 中是一个特殊的标识符，称为空标识符。可以代表任何其它的标识符，但是它对应的值会被忽略(比如:忽略某个返回值)。所以仅能被作为占位符使用，不能作为标识符使用<br>6) 不能以系统保留关键字作为标识符(一共有 25 个)，比如 break，if 等等…</p>
<h3 id="标识符命名注意事项"><a href="#标识符命名注意事项" class="headerlink" title="标识符命名注意事项"></a>标识符命名注意事项</h3><ul>
<li><p>包名:保持 package 的名字和目录保持一致，尽量采取有意义的包名，简短，有意义，不要和 标准库不要冲突 fmt</p>
</li>
<li><p>变量名、函数名、常量名:采用驼峰法 </p>
<p><strong>举例:</strong></p>
<p>var stuName string = “tom” 形式: xxxYyyyyZzzz …</p>
<p>var goodPrice float32 = 1234.5</p>
</li>
<li><p>如果<code>变量名</code>、<code>函数名</code>、<code>常量名</code>首字母大写，则可以被其他的包访问;如果首字母小写，则只能<br>在本包中使用 ( 注:可以简单的理解成，首字母大写是公开的，首字母小写是私有的) ,在 golang 没有 public , private 等关键字。</p>
</li>
</ul>
<h2 id="系统保留关键字"><a href="#系统保留关键字" class="headerlink" title="系统保留关键字"></a>系统保留关键字</h2><table>
<thead>
<tr>
<th>break</th>
<th>default</th>
<th>func</th>
<th>interface</th>
<th>select</th>
</tr>
</thead>
<tbody><tr>
<td>case</td>
<td>defer</td>
<td>go</td>
<td>map</td>
<td>struct</td>
</tr>
<tr>
<td>chan</td>
<td>else</td>
<td>goto</td>
<td>package</td>
<td>switch</td>
</tr>
<tr>
<td>const</td>
<td>fallthrogh</td>
<td>if</td>
<td>range</td>
<td>type</td>
</tr>
<tr>
<td>continue</td>
<td>for</td>
<td>import</td>
<td>return</td>
<td>var</td>
</tr>
</tbody></table>
<h2 id="系统的预定义标识符"><a href="#系统的预定义标识符" class="headerlink" title="系统的预定义标识符"></a>系统的预定义标识符</h2><table>
<thead>
<tr>
<th>append</th>
<th>bool</th>
<th>byte</th>
<th>cap</th>
<th>close</th>
<th>complex</th>
</tr>
</thead>
<tbody><tr>
<td>complex64</td>
<td>complex128</td>
<td>uint16</td>
<td>copy</td>
<td>false</td>
<td>float32</td>
</tr>
<tr>
<td>float64</td>
<td>imag</td>
<td>int</td>
<td>int8</td>
<td>init16</td>
<td>uint32</td>
</tr>
<tr>
<td>int32</td>
<td>int64</td>
<td>iota</td>
<td>len</td>
<td>make</td>
<td>new</td>
</tr>
<tr>
<td>nil</td>
<td>panic</td>
<td>uint64</td>
<td>print</td>
<td>println</td>
<td>real</td>
</tr>
<tr>
<td>recover</td>
<td>string</td>
<td>true</td>
<td>uint</td>
<td>uint8</td>
<td>uintprt</td>
</tr>
</tbody></table>
<h1 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h1><h2 id="运算符的基本介绍"><a href="#运算符的基本介绍" class="headerlink" title="运算符的基本介绍"></a>运算符的基本介绍</h2><blockquote>
<p>  运算符是一种特殊的符号，用以表示数据的运算、赋值和比较等</p>
</blockquote>
<p>1) 算术运算符<br>2) 赋值运算符<br>3) 比较运算符/关系运算符 4) 逻辑运算符<br>4) 位运算符<br>5) 其它运算符</p>
<h3 id="算术运算符"><a href="#算术运算符" class="headerlink" title="算术运算符"></a>算术运算符</h3><blockquote>
<p>  算术运算符是对数值类型的变量进行运算的，比如:加减乘除。在 Go 程序中使用的非常多</p>
</blockquote>
<h4 id="算术运算符的一览表"><a href="#算术运算符的一览表" class="headerlink" title="算术运算符的一览表"></a>算术运算符的一览表</h4><table>
<thead>
<tr>
<th align="center">运算符</th>
<th align="center">运算</th>
<th align="center">范例</th>
<th align="center">结果</th>
</tr>
</thead>
<tbody><tr>
<td align="center">+</td>
<td align="center">正号</td>
<td align="center">+3</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">-</td>
<td align="center">负号</td>
<td align="center">-4</td>
<td align="center">-4</td>
</tr>
<tr>
<td align="center">+</td>
<td align="center">加</td>
<td align="center">5 + 5</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">-</td>
<td align="center">减</td>
<td align="center">6 - 4</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">*</td>
<td align="center">乘</td>
<td align="center">3 * 4</td>
<td align="center">12</td>
</tr>
<tr>
<td align="center">/</td>
<td align="center">除</td>
<td align="center">5 / 5</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">%</td>
<td align="center">取模(取余)</td>
<td align="center">7 % 5</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">++</td>
<td align="center">自增</td>
<td align="center">a=2 a++</td>
<td align="center">a=3</td>
</tr>
<tr>
<td align="center">–</td>
<td align="center">自减</td>
<td align="center">a=2 a–</td>
<td align="center">a=1</td>
</tr>
<tr>
<td align="center">+</td>
<td align="center">字符串相加</td>
<td align="center">“He” + “llo”</td>
<td align="center">“Hello”</td>
</tr>
</tbody></table>
<h4 id="演示-的使用特点"><a href="#演示-的使用特点" class="headerlink" title="演示 / 的使用特点"></a>演示 / 的使用特点</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 两个整数相除,那么结果会去掉小数点,保留整数</span></span><br><span class="line">	fmt.Println(<span class="number">10</span> / <span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> a <span class="keyword">float32</span> = <span class="number">10</span> / <span class="number">4</span></span><br><span class="line">	fmt.Println(a)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 如果想要保留小数怎么办?</span></span><br><span class="line">	<span class="keyword">var</span> b <span class="keyword">float32</span> = <span class="number">10.0</span> / <span class="number">4</span></span><br><span class="line">	fmt.Println(b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h46iollzs0j20j4034mx8.jpg" alt="image-20220714160546154" style="zoom: 67%;">

<h4 id="演示-的使用特点-1"><a href="#演示-的使用特点-1" class="headerlink" title="演示 % 的使用特点"></a>演示 % 的使用特点</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//演示 %的使用</span></span><br><span class="line"><span class="comment">// 看一个公式 a%b=a-a/b*b</span></span><br><span class="line">fmt.Println(<span class="string">"10%3="</span>, <span class="number">10</span> % <span class="number">3</span>) <span class="comment">// =1</span></span><br><span class="line">fmt.Println(<span class="string">"-10%3="</span>, <span class="number">-10</span> % <span class="number">3</span>) <span class="comment">// = -10 - (-10) / 3 * 3 = -10 - (-9) = -1 fmt.Println("10%-3=", 10 % -3) // =1</span></span><br><span class="line">fmt.Println(<span class="string">"-10%-3="</span>, <span class="number">-10</span> % <span class="number">-3</span>) <span class="comment">// =-1</span></span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h46j0mu81tj20im03yjrk.jpg" alt="image-20220714161720468" style="zoom:67%;">

<h3 id="关系运算符-比较运算符"><a href="#关系运算符-比较运算符" class="headerlink" title="关系运算符(比较运算符)"></a>关系运算符(比较运算符)</h3><h4 id="基本介绍-1"><a href="#基本介绍-1" class="headerlink" title="基本介绍"></a>基本介绍</h4><blockquote>
<ol>
<li><p>关系运算符的结果都是 bool 型，也就是要么是 true，要么是 false </p>
</li>
<li><p>关系表达式 经常用在 if 结构的条件中或循环结构的条件中</p>
</li>
</ol>
</blockquote>
<h4 id="关系运算符一览图"><a href="#关系运算符一览图" class="headerlink" title="关系运算符一览图"></a>关系运算符一览图</h4><table>
<thead>
<tr>
<th>运算符</th>
<th>运算</th>
<th>范例</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td>==</td>
<td>相等于</td>
<td>4==3</td>
<td>false</td>
</tr>
<tr>
<td>!=</td>
<td>不等于</td>
<td>4!=3</td>
<td>true</td>
</tr>
<tr>
<td>&lt;</td>
<td>小于</td>
<td>4&lt;3</td>
<td>false</td>
</tr>
<tr>
<td>&gt;</td>
<td>大于</td>
<td>4&gt;3</td>
<td>true</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于等于</td>
<td>4&lt;=3</td>
<td>false</td>
</tr>
<tr>
<td>&gt;==</td>
<td>大于等于</td>
<td>4&gt;=3</td>
<td>true</td>
</tr>
</tbody></table>
<h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3><h4 id="基本介绍-2"><a href="#基本介绍-2" class="headerlink" title="基本介绍"></a>基本介绍</h4><blockquote>
<p>  用于连接多个条件(一般来讲就是关系表达式)，最终的结果也是一个 bool 值</p>
</blockquote>
<h4 id="逻辑运算的说明"><a href="#逻辑运算的说明" class="headerlink" title="逻辑运算的说明"></a>逻辑运算的说明</h4><ul>
<li>假定A值为True</li>
<li>假定B值为False</li>
</ul>
<table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody><tr>
<td>&amp;&amp;</td>
<td><code>逻辑 与</code>运算符,如果两边的操作数都是True,则为True,否则为False</td>
<td>(A &amp;&amp; B)为False</td>
</tr>
<tr>
<td>||</td>
<td><code>逻辑 或</code>运算符,如果两边的操作数有一个是True,则为True,否则为False</td>
<td>(A || B)为True</td>
</tr>
<tr>
<td>!</td>
<td><code>逻辑 否</code>运算符,如果条件为True,则逻辑为False,否则为True</td>
<td>!(A &amp;&amp; B)为True</td>
</tr>
</tbody></table>
<h4 id="细节说明"><a href="#细节说明" class="headerlink" title="细节说明"></a>细节说明</h4><blockquote>
<p>  1)   &amp;&amp; 也叫短路与:如果第一个条件为false，则第二个条件不会判断，最终结果为false<br>  2)   ||    也叫短路或:如果第一个条件为true， 则第二个条件不会判断，最终结果为true</p>
</blockquote>
<h3 id="赋值运算符"><a href="#赋值运算符" class="headerlink" title="赋值运算符"></a>赋值运算符</h3><blockquote>
<p>  赋值运算符就是将某个运算后的值，赋给指定的变量</p>
</blockquote>
<h4 id="赋值运算符的分类"><a href="#赋值运算符的分类" class="headerlink" title="赋值运算符的分类"></a>赋值运算符的分类</h4><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody><tr>
<td>=</td>
<td>简单地赋值运算符,将一个表达式的值赋给一个左值</td>
<td>C = A+B: 将A + B表达式的结果赋值给C</td>
</tr>
<tr>
<td>+=</td>
<td>相加后再赋值</td>
<td>C += A =&gt; 等于 C = C+A</td>
</tr>
<tr>
<td>-=</td>
<td>相减后再赋值</td>
<td>C -= A =&gt;  等于 C = C-A</td>
</tr>
<tr>
<td>*=</td>
<td>相乘后再赋值</td>
<td>C *= A =&gt;  等于 C = C*A</td>
</tr>
<tr>
<td>/=</td>
<td>相除后再赋值</td>
<td>C /= A =&gt;  等于 C = C/A</td>
</tr>
<tr>
<td>%=</td>
<td>相余后再赋值</td>
<td>C %= A =&gt; 等于C = C%A</td>
</tr>
<tr>
<td>&lt;&lt;=</td>
<td>左移后赋值</td>
<td>C &lt;&lt;= 2 等于 C = C&lt;&lt;2</td>
</tr>
<tr>
<td>&gt;&gt;=</td>
<td>右移后赋值</td>
<td>C &gt;&gt;= 2 等于 C = C&gt;&gt;2</td>
</tr>
<tr>
<td>&amp;=</td>
<td>按位与后赋值</td>
<td>C &amp;= 2 等于 C = C &amp; 2</td>
</tr>
<tr>
<td>^=</td>
<td>按位异或后赋值</td>
<td>C ^= 2 等于 C = C ^ 2</td>
</tr>
<tr>
<td>|=</td>
<td>按位或后赋值</td>
<td>C |= 2 等于 C = C | 2</td>
</tr>
</tbody></table>
<h4 id="赋值运算符的特点"><a href="#赋值运算符的特点" class="headerlink" title="赋值运算符的特点"></a>赋值运算符的特点</h4><ul>
<li><p>运算顺序从右往左</p>
</li>
<li><p>赋值运算符的左边 只能是变量,右边 可以是变量、表达式、常量值</p>
</li>
<li><p>复合赋值运算符等价于下面的效果 </p>
<p>比如:a+=3 等价于 a=a+3</p>
</li>
</ul>
<h3 id="位运算符"><a href="#位运算符" class="headerlink" title="位运算符"></a>位运算符</h3><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>&amp;</td>
<td>按位与运算符”&amp;”是双目运算符,其功能是参与运算的两数各对应的二进位相与<br>运算规则是:<code>有一个为1,结果为1,否则为0</code></td>
</tr>
<tr>
<td>|</td>
<td>按位或运算符”|”是双目运算符,其功能是参与运算的两数各对应的二进位相或<br>运算规则是:<code>同时为1,结果为1,否则为0</code></td>
</tr>
<tr>
<td>^</td>
<td>按位异或运算符”^”是双目运算符,其功能是参与运算的两数各对应的二进位相异或<br>运算规则是:<code>当二进位不同时,结果为1,否则为0</code></td>
</tr>
<tr>
<td>&lt;&lt;</td>
<td>左移运算符”&lt;&lt;”是双目运算符,其功能是把”&lt;&lt;”左边的运算数的各二进位全部左移若干位,高位丢弃,低位补0,左移n位就是乘以2的n次方.</td>
</tr>
<tr>
<td>&gt;&gt;</td>
<td>右移运算符”&gt;&gt;”是双目运算符,其功能是把”&gt;&gt;”左边的运算数的各二进位全部右移若干位,右移n位就是除以2的n次方.</td>
</tr>
</tbody></table>
<h3 id="其它运算符说明"><a href="#其它运算符说明" class="headerlink" title="其它运算符说明"></a>其它运算符说明</h3><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
<th>实例</th>
</tr>
</thead>
<tbody><tr>
<td>&amp;</td>
<td>返回变量存储地址</td>
<td>&a;将给出变量的实际地址</td>
</tr>
<tr>
<td>*</td>
<td>指针变量</td>
<td>*a;是一个指针变量</td>
</tr>
</tbody></table>
<h2 id="运算符的优先级"><a href="#运算符的优先级" class="headerlink" title="运算符的优先级"></a>运算符的优先级</h2><h3 id="运算符的优先级的一览表"><a href="#运算符的优先级的一览表" class="headerlink" title="运算符的优先级的一览表"></a>运算符的优先级的一览表</h3><blockquote>
<p>  从上到下,优先级依次递减</p>
</blockquote>
<table>
<thead>
<tr>
<th>分类</th>
<th>描述</th>
<th>关联性</th>
</tr>
</thead>
<tbody><tr>
<td>后缀</td>
<td>() [] -&gt; . ++ –</td>
<td>左到右</td>
</tr>
<tr>
<td>单目</td>
<td>+ - ! ~ (type) * &amp; sizeof</td>
<td>右到左</td>
</tr>
<tr>
<td>乘法</td>
<td>* / %</td>
<td>左到右</td>
</tr>
<tr>
<td>加法</td>
<td>+ -</td>
<td>左到右</td>
</tr>
<tr>
<td>移位</td>
<td>&lt;&lt; &gt;&gt;</td>
<td>左到右</td>
</tr>
<tr>
<td>关系</td>
<td>&lt; &lt;= &gt; &gt;=</td>
<td>左到右</td>
</tr>
<tr>
<td>相等</td>
<td>== !=</td>
<td>左到右</td>
</tr>
<tr>
<td>按位AND</td>
<td>&amp;</td>
<td>左到右</td>
</tr>
<tr>
<td>按位XOR</td>
<td>^</td>
<td>左到右</td>
</tr>
<tr>
<td>按位OR</td>
<td>|</td>
<td>左到右</td>
</tr>
<tr>
<td>逻辑AND</td>
<td>&amp;&amp;</td>
<td>左到右</td>
</tr>
<tr>
<td>逻辑OR</td>
<td>||</td>
<td>左到右</td>
</tr>
<tr>
<td>赋值运算符</td>
<td>= += -= *= /= %= &gt;&gt;= &lt;&lt;= &amp;= ^= |=</td>
<td>右到左</td>
</tr>
<tr>
<td>逗号</td>
<td>,</td>
<td>左到右</td>
</tr>
</tbody></table>
<h1 id="键盘输入语句"><a href="#键盘输入语句" class="headerlink" title="键盘输入语句"></a>键盘输入语句</h1><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>在编程中，需要接收用户输入的数据，就可以使用键盘输入语句来获取。InputDemo.go</p>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><ul>
<li><p>导入<code>fmt</code>包</p>
</li>
<li><p>调用 <code>fmt</code> 包的 <code>fmt.Scanln()</code> 或者 <code>fmt.Scanf()</code></p>
</li>
</ul>
<p>官方文档查询使用方法: <a href="https://pkg.go.dev/fmt#Scan" target="_blank" rel="noopener">https://pkg.go.dev/fmt#Scan</a></p>
<h2 id="演示案例"><a href="#演示案例" class="headerlink" title="演示案例"></a>演示案例</h2><blockquote>
<p>   要求:可以从控制台接收用户信息，【姓名，年龄，薪水, 是否通过考试 】。</p>
</blockquote>
<ul>
<li>使用 fmt.Scanln() 获取</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 要求:可以从控制台接收用户信息，【姓名，年龄，薪水, 是否通过考试 】。</span></span><br><span class="line">	<span class="keyword">var</span> name <span class="keyword">string</span></span><br><span class="line">	<span class="keyword">var</span> age <span class="keyword">byte</span></span><br><span class="line">	<span class="keyword">var</span> sal <span class="keyword">float32</span></span><br><span class="line">	<span class="keyword">var</span> isPass <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"请输入姓名: "</span>)</span><br><span class="line">	fmt.Scanln(&amp;name)</span><br><span class="line">	fmt.Println(<span class="string">"请输入年龄: "</span>)</span><br><span class="line">	fmt.Scanln(&amp;age)</span><br><span class="line">	fmt.Println(<span class="string">"请输入薪水: "</span>)</span><br><span class="line">	fmt.Scanln(&amp;sal)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"请输入是否通过考试: "</span>)</span><br><span class="line">	fmt.Scanln(&amp;isPass)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"名字是 %v\n年龄是 %v\n薪水是 %v\n是否通过考试: %v\n"</span>, name, age, sal, isPass)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4eu3npbylj20q00aegmk.jpg" alt="image-20220721204511796" style="zoom:67%;">

<ul>
<li>使用 fmt.Scanf() 获取</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 要求:可以从控制台接收用户信息，【姓名，年龄，薪水, 是否通过考试 】。</span></span><br><span class="line">	<span class="keyword">var</span> name <span class="keyword">string</span></span><br><span class="line">	<span class="keyword">var</span> age <span class="keyword">byte</span></span><br><span class="line">	<span class="keyword">var</span> sal <span class="keyword">float32</span></span><br><span class="line">	<span class="keyword">var</span> isPass <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 方式二: fmt.scanf,可以按照指定的格式输入</span></span><br><span class="line">	fmt.Println(<span class="string">"请分别输入你的姓名/年龄/薪水, 使用空格分隔"</span>)</span><br><span class="line">	fmt.Scanf(<span class="string">"%s %d %f %t"</span>, &amp;name, &amp;age, &amp;sal, &amp;isPass)</span><br><span class="line">	fmt.Printf(<span class="string">"名字是 %v\n年龄是 %v\n薪水是 %v\n是否通过考试: %v\n"</span>, name, age, sal, isPass)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4eunfeh6uj20ny05kq3n.jpg" alt="image-20220721210421076" style="zoom:67%;">

<h1 id="进制"><a href="#进制" class="headerlink" title="进制"></a>进制</h1><p>对于整数，有四种表示方式: </p>
<ul>
<li><strong>二进制:</strong> 0,1 ，满 2 进 1。<br>在 golang 中，不能直接使用二进制来表示一个整数，它沿用了 c 的特点。 </li>
<li><strong>十进制:</strong> 0-9 ，满 10 进 1。</li>
<li><strong>八进制:</strong> 0-7 ，满 8 进 1. 以数字 0 开头表示。</li>
<li><strong>十六进制:</strong> 0-9及A-F，满16进1. 以0x或0X开头表示。此处的 A-F 不区分大小写。</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">5</span></span><br><span class="line">	<span class="comment">// 二进制输出</span></span><br><span class="line">	fmt.Printf(<span class="string">"%b \n"</span>, i)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 八进制输出, 满 8 进 1,以数字 0 开头</span></span><br><span class="line">	<span class="keyword">var</span> j <span class="keyword">int</span> = <span class="number">011</span></span><br><span class="line">	fmt.Println(<span class="string">"j="</span>, j)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 十六进制输出,满 16 进 1, 以 0x 或 0X 开头</span></span><br><span class="line">	<span class="keyword">var</span> k <span class="keyword">int</span> = <span class="number">0x11</span></span><br><span class="line">	fmt.Println(<span class="string">"k="</span>, k)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ev6z3brjj20l0038dfy.jpg" alt="image-20220721212308826" style="zoom:67%;">

<h2 id="进制的图示"><a href="#进制的图示" class="headerlink" title="进制的图示"></a>进制的图示</h2><table>
<thead>
<tr>
<th align="center">十进制</th>
<th align="center">十六进制</th>
<th align="center">八进制</th>
<th align="center">二进制</th>
</tr>
</thead>
<tbody><tr>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">2</td>
<td align="center">10</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">3</td>
<td align="center">3</td>
<td align="center">11</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">4</td>
<td align="center">4</td>
<td align="center">100</td>
</tr>
<tr>
<td align="center">5</td>
<td align="center">5</td>
<td align="center">5</td>
<td align="center">101</td>
</tr>
<tr>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">110</td>
</tr>
<tr>
<td align="center">7</td>
<td align="center">7</td>
<td align="center">7</td>
<td align="center">111</td>
</tr>
<tr>
<td align="center">8</td>
<td align="center">8</td>
<td align="center">10</td>
<td align="center">1000</td>
</tr>
<tr>
<td align="center">9</td>
<td align="center">9</td>
<td align="center">11</td>
<td align="center">1001</td>
</tr>
<tr>
<td align="center">10</td>
<td align="center">A</td>
<td align="center">12</td>
<td align="center">1010</td>
</tr>
<tr>
<td align="center">11</td>
<td align="center">B</td>
<td align="center">13</td>
<td align="center">1011</td>
</tr>
<tr>
<td align="center">12</td>
<td align="center">C</td>
<td align="center">14</td>
<td align="center">1100</td>
</tr>
<tr>
<td align="center">13</td>
<td align="center">D</td>
<td align="center">15</td>
<td align="center">1101</td>
</tr>
<tr>
<td align="center">14</td>
<td align="center">E</td>
<td align="center">16</td>
<td align="center">1110</td>
</tr>
<tr>
<td align="center">15</td>
<td align="center">F</td>
<td align="center">17</td>
<td align="center">1111</td>
</tr>
<tr>
<td align="center">16</td>
<td align="center">10</td>
<td align="center">20</td>
<td align="center">10000</td>
</tr>
<tr>
<td align="center">17</td>
<td align="center">11</td>
<td align="center">21</td>
<td align="center">10001</td>
</tr>
</tbody></table>
<h2 id="进制的转换"><a href="#进制的转换" class="headerlink" title="进制的转换"></a>进制的转换</h2><ul>
<li>其他进制转十进制<ul>
<li>二进制转十进制</li>
<li>八进制转十进制\</li>
<li>十六进制转十进制</li>
</ul>
</li>
<li>十进制转其它进制<ul>
<li>十进制转二进制</li>
<li>十进制转八进制</li>
<li>十进制转十六进制</li>
</ul>
</li>
<li>二进制转其它进制<ul>
<li>二进制转八进制</li>
<li>二进制转十六进制</li>
</ul>
</li>
<li>其他进制转二进制<ul>
<li>八进制转二进制</li>
<li>十六进制转二进制</li>
</ul>
</li>
</ul>
<h3 id="其它进制转十进制"><a href="#其它进制转十进制" class="headerlink" title="其它进制转十进制"></a>其它进制转十进制</h3><h4 id="二进制如何转十进制"><a href="#二进制如何转十进制" class="headerlink" title="二进制如何转十进制"></a>二进制如何转十进制</h4><blockquote>
<p>  规则: 从最低位开始(右边开始),将每个位上的数提取出来,乘以2的(位数-1)次方,然后求和</p>
</blockquote>
<ul>
<li>案例: 请将二进制 1011 转换成十进制</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1011</span> = <span class="number">1</span>*<span class="number">2</span>^(<span class="number">1</span><span class="number">-1</span>) + <span class="number">1</span>*<span class="number">2</span>^(<span class="number">2</span><span class="number">-1</span>) + <span class="number">0</span>*<span class="number">2</span>^(<span class="number">3</span><span class="number">-1</span>) + <span class="number">1</span>*<span class="number">2</span>^(<span class="number">4</span><span class="number">-1</span>)</span><br><span class="line">     = <span class="number">1</span> + <span class="number">2</span> + <span class="number">0</span> + <span class="number">8</span></span><br><span class="line">     = <span class="number">11</span></span><br></pre></td></tr></table></figure>

<h4 id="八进制如何转十进制"><a href="#八进制如何转十进制" class="headerlink" title="八进制如何转十进制"></a>八进制如何转十进制</h4><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4fu2dxcaoj20p203gweu.jpg" alt="image-20220722172941782"></p>
<blockquote>
<p>  规则: 从最低位开始,将每个位上的数提取出来,乘以8的(位数-1)次方,然后求和</p>
</blockquote>
<ul>
<li>案例: 请将0123转换为十进制</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0123</span> = <span class="number">3</span>*<span class="number">8</span>^(<span class="number">1</span><span class="number">-1</span>) + <span class="number">2</span>*<span class="number">8</span>^(<span class="number">2</span><span class="number">-1</span>) + <span class="number">1</span>*<span class="number">8</span>^(<span class="number">3</span><span class="number">-1</span>) + <span class="number">0</span>*<span class="number">8</span>^(<span class="number">4</span><span class="number">-1</span>)</span><br><span class="line">     = <span class="number">3</span> + <span class="number">16</span> + <span class="number">64</span> + <span class="number">0</span></span><br><span class="line">     = <span class="number">83</span></span><br></pre></td></tr></table></figure>

<h4 id="十六进制转十进制"><a href="#十六进制转十进制" class="headerlink" title="十六进制转十进制"></a>十六进制转十进制</h4><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4fucv9e6pj20ry05mq3k.jpg" alt="image-20220722173946386"></p>
<blockquote>
<p>  规则: 从最低位开始,将每个位上的数提取出来,乘以16的(位数-1)次方,然后求和</p>
</blockquote>
<ul>
<li>案例: 请将0x34A转成十进制</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x34A</span> = <span class="number">10</span>*<span class="number">16</span>^(<span class="number">1</span><span class="number">-1</span>) + <span class="number">4</span>*<span class="number">16</span>^(<span class="number">2</span><span class="number">-1</span>) + <span class="number">3</span>*<span class="number">16</span>^(<span class="number">3</span><span class="number">-1</span>)</span><br><span class="line">      = <span class="number">10</span> + <span class="number">64</span> + <span class="number">768</span></span><br><span class="line">      = <span class="number">842</span></span><br></pre></td></tr></table></figure>

<h3 id="十进制转其它进制"><a href="#十进制转其它进制" class="headerlink" title="十进制转其它进制"></a>十进制转其它进制</h3><h4 id="十进制转二进制"><a href="#十进制转二进制" class="headerlink" title="十进制转二进制"></a>十进制转二进制</h4><blockquote>
<p>  规则: 将该数不断除以2,直到商为0为止,然后将每步得到的余数倒过来,就是对应的二进制</p>
</blockquote>
<ul>
<li>案例: 请将56转成二进制</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">56</span>/<span class="number">2</span>=<span class="number">28</span> - <span class="number">0</span></span><br><span class="line"><span class="number">28</span>/<span class="number">2</span>=<span class="number">14</span> - <span class="number">0</span></span><br><span class="line"><span class="number">14</span>/<span class="number">2</span>=<span class="number">7</span>  - <span class="number">0</span></span><br><span class="line"><span class="number">7</span>/<span class="number">2</span>=<span class="number">3</span>   - <span class="number">1</span></span><br><span class="line"><span class="number">3</span>/<span class="number">2</span>=<span class="number">1</span>	- <span class="number">1</span></span><br><span class="line"><span class="number">1</span>/<span class="number">2</span>=<span class="number">0</span>   - <span class="number">1</span>		// <span class="number">1</span>除以任何大于<span class="number">1</span>的正整数,商都为<span class="number">0</span>,余数为<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span>   <span class="number">1</span>   <span class="number">1</span>   <span class="number">0</span>   <span class="number">0</span>   <span class="number">0</span> = <span class="number">56</span></span><br><span class="line"><span class="number">32</span>  <span class="number">16</span>  <span class="number">8</span>   <span class="number">4</span>   <span class="number">2</span>   <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h4 id="十进制转八进制"><a href="#十进制转八进制" class="headerlink" title="十进制转八进制"></a>十进制转八进制</h4><blockquote>
<p>  规则: 将该数不断除以8,直到商为0为止,然后将每步得到的余数倒过来,就是对应的二进制</p>
</blockquote>
<ul>
<li>案例: 请将156转成八进制</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">156</span>/<span class="number">8</span>=<span class="number">19</span> - <span class="number">4</span></span><br><span class="line"><span class="number">19</span>/<span class="number">8</span>=<span class="number">2</span>   - <span class="number">3</span></span><br><span class="line"><span class="number">2</span>/<span class="number">8</span>=<span class="number">0</span>    - <span class="number">2</span>	// <span class="number">2</span>除以<span class="number">8</span>余<span class="number">2</span>；（商<span class="number">0</span>）</span><br><span class="line"></span><br><span class="line">八进制: <span class="number">0234</span>=<span class="number">156</span></span><br></pre></td></tr></table></figure>

<h4 id="十进制转十六进制"><a href="#十进制转十六进制" class="headerlink" title="十进制转十六进制"></a>十进制转十六进制</h4><blockquote>
<p>  规则: 将该数不断除以16,直到商为0为止,然后将每步得到的余数倒过来,就是对应的二进制</p>
</blockquote>
<ul>
<li>案例: 请将356转成十六进制</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">356</span>/<span class="number">16</span>=<span class="number">22</span> - <span class="number">4</span></span><br><span class="line"><span class="number">22</span>/<span class="number">16</span>=<span class="number">1</span>   - <span class="number">6</span></span><br><span class="line"><span class="number">1</span>/<span class="number">16</span>=<span class="number">0</span>    - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">十六进制: <span class="number">0x164</span>=<span class="number">356</span></span><br></pre></td></tr></table></figure>

<h3 id="二进制转八进制-十六进制"><a href="#二进制转八进制-十六进制" class="headerlink" title="二进制转八进制/十六进制"></a>二进制转八进制/十六进制</h3><h4 id="二进制转八进制"><a href="#二进制转八进制" class="headerlink" title="二进制转八进制"></a>二进制转八进制</h4><blockquote>
<p>  规则: 将二进制数每三位一组(从低位开始组合),转成对应的八进制即可</p>
</blockquote>
<ul>
<li>案例: 请将二进制 11010101 转成八进制</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">11010101</span> =&gt; (<span class="number">11</span>) (<span class="number">010</span>) (<span class="number">101</span>) =&gt; <span class="number">0325</span></span><br></pre></td></tr></table></figure>

<h4 id="二进制转十六进制"><a href="#二进制转十六进制" class="headerlink" title="二进制转十六进制"></a>二进制转十六进制</h4><blockquote>
<p>  规则: 将二进制数每四位一组(从低位开始组合),转成对应的十六进制即可</p>
</blockquote>
<ul>
<li>案例: 请将二进制 11010101转成十六进制</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">11010101</span> =&gt; (<span class="number">1101</span>) (<span class="number">0101</span>) =&gt; <span class="number">0x135</span> =&gt; <span class="number">0xD5</span></span><br></pre></td></tr></table></figure>

<h3 id="八进制-十六进制转二进制"><a href="#八进制-十六进制转二进制" class="headerlink" title="八进制/十六进制转二进制"></a>八进制/十六进制转二进制</h3><h4 id="八进制转二进制"><a href="#八进制转二进制" class="headerlink" title="八进制转二进制"></a>八进制转二进制</h4><blockquote>
<p>  规则: 将八进制数每1位,转成对应的一个三位数即可</p>
</blockquote>
<ul>
<li>案例: 请将0237转成二进制</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0237</span> =&gt; (<span class="number">010</span>) (<span class="number">011</span>) (<span class="number">111</span>) =&gt; <span class="number">10011111</span></span><br></pre></td></tr></table></figure>

<h4 id="十六进制转二进制"><a href="#十六进制转二进制" class="headerlink" title="十六进制转二进制"></a>十六进制转二进制</h4><blockquote>
<p>  规则: 将八进制数每1位,转成对应的一个四位数即可</p>
</blockquote>
<ul>
<li>案例: 请将0x237转成二进制</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x237</span> =&gt; (<span class="number">0010</span>) (<span class="number">0011</span>) (<span class="number">0111</span>) =&gt; <span class="number">1000110111</span></span><br></pre></td></tr></table></figure>

<h1 id="位运算"><a href="#位运算" class="headerlink" title="位运算"></a>位运算</h1><h2 id="原码、反码、补码"><a href="#原码、反码、补码" class="headerlink" title="原码、反码、补码"></a>原码、反码、补码</h2><p><strong>精简6句话:</strong></p>
<ul>
<li>二进制的最高位是符号位: 0表示正数,1表示负数<ul>
<li>1 =&gt; [0000 0001]</li>
<li>-1 =&gt; [1000 0001]</li>
</ul>
</li>
<li>正数的源码/反码/补码都一样</li>
<li>负数的反码=原码符号位不变,其他位取反<ul>
<li>1 =&gt; 原码[0000 0001]</li>
<li>1 =&gt; 反码[0000 0001]</li>
<li>1 =&gt; 补码[0000 0001]</li>
<li>-1 =&gt; 原码[1000 0001]</li>
<li>-1 =&gt; 反码[1111 1110]</li>
<li>-1 =&gt; 补码[1111 1111]</li>
</ul>
</li>
<li>负数的补码=反码+1</li>
<li>0的反码/补码都是0</li>
<li>计算机运算时以补码方式进行运算</li>
</ul>
<h2 id="位运算符和移位运算符"><a href="#位运算符和移位运算符" class="headerlink" title="位运算符和移位运算符"></a>位运算符和移位运算符</h2><ul>
<li><strong>Golang中有3个位运算,它们的运算规则是:</strong><ul>
<li><strong>按位与&amp;:</strong> 两位全为1，结果为 1，否则为 0</li>
<li><strong>按位或|:</strong> 两位有一个为 1，结果为 1，否则为 0</li>
<li><strong>按位异或 ^:</strong> 两位一个为 0,一个为 1，结果为 1，否则为 0</li>
</ul>
</li>
</ul>
<blockquote>
<p>  注意: 整数的反码补码都一样,所以<code>补码</code>=<code>原码</code>,负数的时候需要用<code>补码</code>先推回到<code>反码</code>,再用<code>反码</code>推回<code>原码</code></p>
</blockquote>
<table>
<thead>
<tr>
<th>计算值</th>
<th>原码</th>
<th>反码</th>
<th>补码</th>
</tr>
</thead>
<tbody><tr>
<td>2</td>
<td>0000 0010</td>
<td>0000 0010</td>
<td>0000 0010</td>
</tr>
<tr>
<td>3</td>
<td>0000 0011</td>
<td>0000 0011</td>
<td>0000 0011</td>
</tr>
<tr>
<td>2&amp;3</td>
<td>-</td>
<td>-</td>
<td>0000 0010(2)</td>
</tr>
<tr>
<td>2|3</td>
<td>-</td>
<td>-</td>
<td>0000 0011(3)</td>
</tr>
<tr>
<td>2^3</td>
<td>-</td>
<td>-</td>
<td>0000 0001(1)</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>-2</td>
<td>1000 0010</td>
<td>1111 1101</td>
<td>1111 1110</td>
</tr>
<tr>
<td>2</td>
<td>0000 0010</td>
<td>0000 0010</td>
<td>0000 0010</td>
</tr>
<tr>
<td>-2^2</td>
<td>1000 0100(-4)</td>
<td>1111 1011(补码-1)</td>
<td>1111 1100</td>
</tr>
</tbody></table>
<ul>
<li><p><strong>Golang中有2个移位运算符: **<br>**右移运算符 &gt;&gt;:</strong> 低位溢出,符号位不变,并用符号位补溢出的高位<br><strong>左移运算符 &lt;&lt;:</strong> 符号位不变,低位补 0</p>
</li>
<li><p>案例演示</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a := <span class="number">1</span> &gt;&gt; <span class="number">2</span> // <span class="number">0000</span> <span class="number">0001</span> =&gt; <span class="number">0000</span> <span class="number">0000</span> = <span class="number">0</span></span><br><span class="line">c := <span class="number">1</span> &lt;&lt; <span class="number">2</span> // <span class="number">0000</span> <span class="number">0001</span> =&gt; <span class="number">0000</span> <span class="number">0100</span> = <span class="number">4</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h1 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h1><blockquote>
<p>  这个章节不写案例,没啥好写的,不懂的最好去查一下相关案例,能更加快速的上手</p>
</blockquote>
<h2 id="顺序控制"><a href="#顺序控制" class="headerlink" title="顺序控制"></a>顺序控制</h2><blockquote>
<p>  代码中，没有判断，也没有跳转.因此程序按照默认的流程执行，即顺 序控制。</p>
</blockquote>
<p>这个不必过多介绍,这个不明白啥意思别往下看了,你学不会了兄弟-_-||</p>
<h2 id="分支控制"><a href="#分支控制" class="headerlink" title="分支控制"></a>分支控制</h2><h3 id="单分支"><a href="#单分支" class="headerlink" title="单分支"></a>单分支</h3><ul>
<li>基本语法</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件 &#123;</span><br><span class="line">    PASS</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="双分支"><a href="#双分支" class="headerlink" title="双分支"></a>双分支</h3><blockquote>
<p>  注意: 下面的<code>else</code>不可以换行,必须为 <code>}esle{</code></p>
</blockquote>
<ul>
<li>基本语法</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件 &#123;</span><br><span class="line">    PASS</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    PASS</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="多分支"><a href="#多分支" class="headerlink" title="多分支"></a>多分支</h3><ul>
<li>基本语法</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件 &#123;</span><br><span class="line">    PASS</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> 条件 &#123;</span><br><span class="line">    PASS</span><br><span class="line">&#125;...</span><br><span class="line">...</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    PASS</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  需要注意的是,if语句的判断条件中,不能只出现赋值语句,例如 <code>if a=5</code>,但是可以写成<code>if a=5;a&gt;4</code></p>
</blockquote>
<h3 id="嵌套分支"><a href="#嵌套分支" class="headerlink" title="嵌套分支"></a>嵌套分支</h3><blockquote>
<p>  在一个分支结构中又完整的嵌套了另一个完整的分支结构，里面的分支的结构称为内层分支外面的分支结构称为外层分支。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件 &#123;</span><br><span class="line">    <span class="keyword">if</span> 条件 &#123;</span><br><span class="line">        PASS</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        PASS</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="switch分支"><a href="#switch分支" class="headerlink" title="switch分支"></a>switch分支</h3><ul>
<li>switch 语句用于基于不同条件执行不同动作，每一个 case 分支都是唯一的，从上到下逐一测 试，直到匹配为止。</li>
<li>匹配项后面也不需要再加 break</li>
</ul>
<p>基本语法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> 表达式 &#123;</span><br><span class="line"><span class="keyword">case</span> 表达式<span class="number">1</span>:</span><br><span class="line">    PASS</span><br><span class="line"><span class="keyword">case</span> 表达式<span class="number">2</span>:</span><br><span class="line">    PASS</span><br><span class="line">    ...</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    PASS</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>总结:</strong></p>
<p>1) switch的执行的流程是，先执行表达式，得到值，然后和case的表达式进行比较，如果相等，<br>    就匹配到，然后执行对应的 case 的语句块，然后退出 switch 控制。<br>2) 如果 switch 的表达式的值没有和任何的 case 的表达式匹配成功，则执行 default 的语句块。执行后退出 switch 的控制.<br>3) golang的case后的表达式可以有多个，使用逗号间隔.<br>4) golang 中的 case 语句块不需要写 break , 因为默认会有,即在默认情况下，当程序执行完 case 语<br>    句块后，就直接退出该 switch 控制结构。</p>
<p>案例</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span></span><br><span class="line">	fmt.Println(<span class="string">"请输入一个数字: "</span>)</span><br><span class="line">	fmt.Scanf(<span class="string">"%v"</span>, &amp;i)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> i &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">		fmt.Println(<span class="string">"数值1"</span>)</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">		fmt.Println(<span class="string">"数值2"</span>)</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">		fmt.Println(<span class="string">"数值3"</span>)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">"输入错误"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j75mydaaj20b9037aa6.jpg" alt="image-20220725151918021"></p>
<p>也可以写成下面这样</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span></span><br><span class="line">	fmt.Println(<span class="string">"请输入一个数字: "</span>)</span><br><span class="line">	fmt.Scanf(<span class="string">"%v"</span>, &amp;i)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> &#123;</span><br><span class="line">	<span class="keyword">case</span> i == <span class="number">1</span>:</span><br><span class="line">		fmt.Println(<span class="string">"数值1"</span>)</span><br><span class="line">	<span class="keyword">case</span> i == <span class="number">2</span>:</span><br><span class="line">		fmt.Println(<span class="string">"数值2"</span>)</span><br><span class="line">	<span class="keyword">case</span> i == <span class="number">3</span>:</span><br><span class="line">		fmt.Println(<span class="string">"数值3"</span>)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">"输入错误"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>switch 穿透-fallthrough: 如果在 case 语句块后增加 fallthrough ,则会继续执行下一个 case，也 叫 switch 穿透</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> num <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> num &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">		fmt.Println(<span class="string">"OK1"</span>)</span><br><span class="line">		<span class="keyword">fallthrough</span></span><br><span class="line">	<span class="keyword">case</span> <span class="number">20</span>:</span><br><span class="line">		fmt.Println(<span class="string">"OK2"</span>)</span><br><span class="line">		<span class="keyword">fallthrough</span></span><br><span class="line">	<span class="keyword">case</span> <span class="number">30</span>:</span><br><span class="line">		fmt.Println(<span class="string">"OK3"</span>)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Print(<span class="string">"没有匹配到"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j7l5weowj20b301l3ye.jpg" alt="image-20220725153413174"></p>
<h2 id="循环控制"><a href="#循环控制" class="headerlink" title="循环控制"></a>循环控制</h2><h3 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h3><h4 id="方式一"><a href="#方式一" class="headerlink" title="方式一"></a>方式一</h4><ul>
<li>基本语法</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 循环变量初始化;循环条件;循环变量迭代&#123;</span><br><span class="line">	PASS</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>例子: 打印十遍<code>Hello World</code></li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">		fmt.Println(<span class="string">"Hello World"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j7xsl5cdj20az04aaa4.jpg" alt="image-20220725154621742"></p>
<h4 id="方式二"><a href="#方式二" class="headerlink" title="方式二"></a>方式二</h4><blockquote>
<p>  将变量初始化和变量迭代写到其它位置</p>
</blockquote>
<ul>
<li>基本语法</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> 循环判断条件 &#123;</span><br><span class="line">	PASS</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>例子: 打印十遍<code>Hello World</code></li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i <span class="keyword">int</span> = <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> i &lt;= <span class="number">10</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"Hello World"</span>)</span><br><span class="line">		i++</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="方式三-无限循环"><a href="#方式三-无限循环" class="headerlink" title="方式三: 无限循环"></a>方式三: 无限循环</h4><blockquote>
<p>  等价 for ; ; {} 是一个无限循环， 通常需要配合 break 语句使用</p>
</blockquote>
<ul>
<li>基本语法</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> &#123;</span><br><span class="line">	PASS</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>例子:输出1-10</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	i := <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> i &lt;= <span class="number">10</span> &#123;</span><br><span class="line">			fmt.Println(i)</span><br><span class="line">			i++</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">break</span> <span class="comment">//退出循环</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j8dsyxrmj20av04dglk.jpg" alt="image-20220725160145059"></p>
<h4 id="for-range"><a href="#for-range" class="headerlink" title="for-range"></a>for-range</h4><blockquote>
<p>  可以方便的遍历字符串与数组</p>
</blockquote>
<ul>
<li>例子(传统方式): 按照索引顺序,输出字符串的单个字符</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="keyword">var</span> str <span class="keyword">string</span> = <span class="string">"Hello,World!"</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i&lt;<span class="built_in">len</span>(str);i++&#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%c \n"</span>, str[i])</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j8o1897kj20b90533yg.jpg" alt="image-20220725161130562"></p>
<ul>
<li>例子(for-range): 字符串遍历</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="keyword">var</span> str <span class="keyword">string</span> = <span class="string">"Hello,World!"</span></span><br><span class="line">	<span class="keyword">for</span> index,value := <span class="keyword">range</span> str&#123;</span><br><span class="line">		fmt.Printf(<span class="string">"index=%d, value=%c \n"</span>, index, value)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4j8w8k1ykj20b0055glt.jpg" alt="image-20220725161927874"></p>
<blockquote>
<p>  对于传统的字符串遍历来说,如果字符串中含有中文,会报错</p>
<p>  原因是传统的对字符串的遍历是按照字节来遍历，而一个汉字在 utf8 编码是对应 3 个字节。 </p>
<p>  如何解决?需要要将 str 转成 []rune 切片</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="keyword">var</span> str <span class="keyword">string</span> = <span class="string">"Hello,World!你好世界!"</span></span><br><span class="line">	str_rune := []<span class="keyword">rune</span>(str)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i&lt;<span class="built_in">len</span>(str_rune);i++&#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%c \n"</span>, str_rune[i])</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>for-range的方式处理中文不会出问题</p>
<h3 id="while-和-do-while"><a href="#while-和-do-while" class="headerlink" title="while 和 do..while"></a>while 和 do..while</h3><h4 id="while"><a href="#while" class="headerlink" title="while"></a>while</h4><blockquote>
<p>  Go 语言没有 while 和 do…while 语法，这一点需要注意一下，如果我们需要使用类似其它语<br>  言(比如 java / c 的 while 和 do…while )，可以通过 for 循环来实现其使用效果。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	i := <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> i &gt; <span class="number">10</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125; </span><br><span class="line">        fmt.Println(i)</span><br><span class="line">		i++</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>就是上面for循环中说的<code>for ; ; {} 是一个无限循环</code></p>
<h4 id="do-while"><a href="#do-while" class="headerlink" title="do..while"></a>do..while</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	i := <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">        fmt.Println(i)</span><br><span class="line">		i++</span><br><span class="line">        <span class="keyword">if</span> i &gt; <span class="number">10</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>练习: 利用<code>*</code>输出金字塔</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> line <span class="keyword">int</span></span><br><span class="line">	fmt.Println(<span class="string">"请输入金字塔的行数: "</span>)</span><br><span class="line">	fmt.Scanf(<span class="string">"%d"</span>, &amp;line)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 输出一个矩形</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= line; i++ &#123;</span><br><span class="line">		<span class="comment">// 空格</span></span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= line-i; j++ &#123;</span><br><span class="line">			fmt.Print(<span class="string">" "</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">// 星号</span></span><br><span class="line">		<span class="keyword">for</span> k := <span class="number">1</span>; k &lt;= <span class="number">2</span>*i<span class="number">-1</span>; k++ &#123;</span><br><span class="line">			fmt.Print(<span class="string">"*"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="break"><a href="#break" class="headerlink" title="break"></a>break</h3><blockquote>
<p>  这个很好理解,主动退出循环嘛,这里不做过多解释,但是有一个标签的功能需要说一下</p>
</blockquote>
<ul>
<li>break语句出现在多层嵌套的语句块中时，可以通过<code>标签指明</code>要终止的是哪一层语句块</li>
<li>break默认跳出最近的 for 循环</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> line <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">	label:</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= line; i++ &#123;</span><br><span class="line">		fmt.Println(<span class="string">"1"</span>)</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= line-i; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> j == <span class="number">5</span>&#123;</span><br><span class="line">				<span class="keyword">break</span> label	<span class="comment">//直接跳出指定位置的循环</span></span><br><span class="line">			&#125;</span><br><span class="line">			fmt.Println(<span class="string">"2"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4jalmx5xej20b502c0sn.jpg" alt="image-20220725171828159"></p>
<h3 id="continue"><a href="#continue" class="headerlink" title="continue"></a>continue</h3><blockquote>
<p>  continue 语句用于结束本次循环，继续执行下一次循环。</p>
<p>  continue 语句出现在多层嵌套的循环语句体中时，可以通过<code>标签指明</code>要跳过的是哪一层循环 , 这个和前面的 break 标签的使用的规则一样.</p>
</blockquote>
<p>这里就不演示了</p>
<p>放个截图</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4jaqxzflbj20mw0dj0ta.jpg" alt="image-20220725172334025"></p>
<h3 id="goto"><a href="#goto" class="headerlink" title="goto"></a>goto</h3><p>1) Go 语言的 goto 语句可以无条件地转移到程序中指定的行。<br>2) goto语句通常与条件语句配合使用。可用来实现条件转移，跳出循环体等功能。<br>3) 在 Go 程序设计中一般不主张使用 goto 语句， 以免造成程序流程的混乱，使理解和调试程序<br>    都产生困难</p>
<ul>
<li>一个案例演示快速说明,麻利滴!</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> num <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> num &gt; <span class="number">5</span> &#123;</span><br><span class="line">		<span class="keyword">goto</span> label</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"我小于5!"</span>)</span><br><span class="line"></span><br><span class="line">label:</span><br><span class="line">	fmt.Println(<span class="string">"我大于5!"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4jbho8qdfj20av00v3ye.jpg" alt="image-20220725174915995"></p>
<h3 id="return"><a href="#return" class="headerlink" title="return"></a>return</h3><blockquote>
<p>  return 使用在方法或者函数中，表示跳出所在的方法或函数，在讲解函数的时候，会详细的介绍。</p>
</blockquote>
<p><strong>说明:</strong></p>
<p>1) 如果 return 是在普通的函数，则表示跳出该函数，即不再执行函数中 return 后面代码，也可以理解成终止函数。<br>2) 如果 return 是在 main 函数，表示终止 main 函数，也就是说终止程序。</p>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><blockquote>
<p>  因为本人有一定基础,这里就不做太详细的解释,直接上干货,兄弟们!</p>
</blockquote>
<h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><blockquote>
<p>  函数可以有返回值,也可以没有</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> 函数名 [形参列表] [返回值列表]</span>&#123;</span><br><span class="line">	PASS</span><br><span class="line">    <span class="keyword">return</span> [返回值列表]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">calculate</span><span class="params">(n1 <span class="keyword">float64</span>, n2 <span class="keyword">float64</span>, operator <span class="keyword">byte</span>)</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> res <span class="keyword">float64</span></span><br><span class="line">	<span class="keyword">switch</span> operator &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">		res = n1 + n2</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">		res = n1 - n2</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'*'</span>:</span><br><span class="line">		res = n1 * n2</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'/'</span>:</span><br><span class="line">		res = n1 / n2</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">"操作符号错误"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> n1 <span class="keyword">float64</span> = <span class="number">1.2</span></span><br><span class="line">	<span class="keyword">var</span> n2 <span class="keyword">float64</span> = <span class="number">2.3</span></span><br><span class="line">	<span class="keyword">var</span> operator <span class="keyword">byte</span> = <span class="string">'+'</span></span><br><span class="line">	result := calculate(n1, n2, operator)</span><br><span class="line">	fmt.Println(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4k50q2mt6j20ag00rq2s.jpg" alt="image-20220726105053724"></p>
<h2 id="包"><a href="#包" class="headerlink" title="包"></a>包</h2><ul>
<li><p>在实际的开发中，我们往往需要在不同的文件中，去调用其它文件的定义的函数，比如 main.go 中，去使用 utils.go 文件中的函数，如何实现? =&gt; 包</p>
</li>
<li><p>现在有两个程序员共同开发一个 Go 项目,程序员 xiaoming 希望定义函数 Cal ,程序员 xiaoqiang 也想定义函数也叫 Cal。两个程序员为此还吵了起来,怎么办? =&gt; 包</p>
</li>
</ul>
<h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><blockquote>
<p>  包的本质实际上就是创建不同的文件夹，来存放程序文件。</p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k5se1rk6j20r506p0th.jpg" alt="image-20220726111732328"></p>
<ul>
<li>说明: go 的每一个文件都是属于一个包的，也就是说 go 是以包的形式来管理文件和项目目录结构</li>
</ul>
<h3 id="三大作用"><a href="#三大作用" class="headerlink" title="三大作用"></a>三大作用</h3><ul>
<li>区分相同名字的函数、变量等标识符</li>
<li>当程序文件很多时,可以很好的管理项目</li>
<li>控制函数、变量等访问范围，即作用域</li>
</ul>
<h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><p>打包基本语法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> 包名</span><br></pre></td></tr></table></figure>

<p>引入包的基本语法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"包的路径"</span></span><br></pre></td></tr></table></figure>

<h3 id="快速入门-1"><a href="#快速入门-1" class="headerlink" title="快速入门"></a>快速入门</h3><blockquote>
<p>  注意: golang在找包的时候,默认会在<code>/usr/local/go/src/</code>寻找,所以文件要放在golang的src目录下,我目前main.go的绝对路径是<code>/usr/local/go/src/golang_study/08-hanshu/main</code>,所以下面调用utils包时,只需要从<code>golang_study</code>开始写就可以了</p>
</blockquote>
<ul>
<li>目录格式</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k7bdjtrpj206z033dfp.jpg" alt="image-20220726121022878"></p>
<ul>
<li>utils.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> utils</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Calculate</span><span class="params">(n1 <span class="keyword">float64</span>, n2 <span class="keyword">float64</span>, operator <span class="keyword">byte</span>)</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> res <span class="keyword">float64</span></span><br><span class="line">	<span class="keyword">switch</span> operator &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">		res = n1 + n2</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">		res = n1 - n2</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'*'</span>:</span><br><span class="line">		res = n1 * n2</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'/'</span>:</span><br><span class="line">		res = n1 / n2</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">"操作符号错误"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>main.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/08-hanshu/utils"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> n1 <span class="keyword">float64</span> = <span class="number">1.2</span></span><br><span class="line">	<span class="keyword">var</span> n2 <span class="keyword">float64</span> = <span class="number">2.3</span></span><br><span class="line">	<span class="keyword">var</span> operator <span class="keyword">byte</span> = <span class="string">'+'</span></span><br><span class="line">	result := utils.Calculate(n1, n2, operator)</span><br><span class="line">	fmt.Println(result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="注意事项和细节"><a href="#注意事项和细节" class="headerlink" title="注意事项和细节"></a>注意事项和细节</h3><ol>
<li>在给一个文件打包时，该包对应一个文件夹，比如这里的 utils 文件夹对应的包名就是 utils, 文件的包名通常和文件所在的文件夹名一致，一般为小写字母。</li>
<li>当一个文件要使用其它包函数或变量时，需要先引入对应的包</li>
</ol>
<ul>
<li>引入方式 1:</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"包名"</span></span><br></pre></td></tr></table></figure>

<ul>
<li>引入方式 2:</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ( </span><br><span class="line">	<span class="string">"包名"</span></span><br><span class="line">	<span class="string">"包名"</span> </span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>package 指令在 文件第一行，然后是 import 指令。</li>
<li>在 import 包时，路径从 <code>$GOPATH</code> 的 <code>src</code> 下开始，不用带 src , 编译器会自动从 src 下开始引入</li>
<li>为了让其它包的文件，可以访问到本包的函数，则该<code>函数名的首字母需要大写</code>，类似其它语言 的 public ,这样才能跨包访问。比如 utils.go 的<code>Calculate</code></li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k9g3q8myj20h10cjmxs.jpg" alt="image-20220726132407437"></p>
<ol start="6">
<li>在访问其它包函数，变量时，其语法是 包名.函数名， 比如这里的 main.go 文件中</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k9nwnr3wj20cv09nq3e.jpg" alt="image-20220726133137898"></p>
<ol start="7">
<li>如果包名较长，Go 支持给包取别名， 注意细节:取别名后，原来的包名就不能使用了</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k9plh9v8j20ab031jra.jpg" alt="image-20220726133314963"></p>
<ol start="8">
<li>如果你要编译成一个可执行程序文件，就需要将这个包声明为 main , 即 package main .这个就<pre><code>是一个语法规范，如果你是写一个库 ，包名可以自定义</code></pre></li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4k9z0ydnpj20hv038gln.jpg" alt="image-20220726134218663"></p>
<p>打包生成可执行文件命令如下:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> build -o bin/my.exe golang_study/<span class="number">08</span>-hanshu/main</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ka4qyid8j20ge00n747.jpg" alt="image-20220726134749000"></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ka6a7p58j2091039aa8.jpg" alt="image-20220726134917258"></p>
<h2 id="函数的调用机制"><a href="#函数的调用机制" class="headerlink" title="函数的调用机制"></a>函数的调用机制</h2><blockquote>
<p>  为了让大家更好的理解函数调用过程, 看两个案例，并画出示意图，这个很重要</p>
</blockquote>
<ul>
<li>传入一个数+1</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(n1 <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	n1 = n1 + <span class="number">1</span></span><br><span class="line">	fmt.Println(<span class="string">"test n1="</span>, n1)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSum</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	sum := n1 + n2</span><br><span class="line">	fmt.Println(<span class="string">"getSum sum="</span>, sum)</span><br><span class="line">	<span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	n1 := <span class="number">10</span></span><br><span class="line">	test(n1)</span><br><span class="line">	fmt.Println(<span class="string">"main() n1="</span>, n1)</span><br><span class="line"></span><br><span class="line">	sum := getSum(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">"main() sum="</span>, sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4kb9raa7pj20cl020mx4.jpg" alt="image-20220726142713706"></p>
<blockquote>
<p>  为什么上面代码执行结果中,n1的值没有真正的改变呢?请看下面这个解释吧</p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4kckeyrjaj20lz0890tl.jpg" alt="image-20220726151204173"></p>
<ol>
<li>在调用一个函数时，会给该函数分配一个新的空间，编译器会通过自身的处理让这个新的空间 和其它的栈的空间区分开来</li>
<li>在每个函数对应的栈中，数据空间是独立的，不会混淆</li>
<li>当一个函数调用完毕(执行完毕)后,程序会销毁这个函数对应的栈空间</li>
</ol>
<h2 id="return语句"><a href="#return语句" class="headerlink" title="return语句"></a>return语句</h2><h3 id="基本语法与说明"><a href="#基本语法与说明" class="headerlink" title="基本语法与说明"></a>基本语法与说明</h3><blockquote>
<p>  Golang函数支持返回多个值,这一点是其他编程语言没有的</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(形参列表)</span> <span class="params">(返回值类型列表)</span></span>&#123;</span><br><span class="line">	语句...</span><br><span class="line">    <span class="keyword">return</span> 返回值列表</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>说明:</p>
<ol>
<li>如果返回多个值时,在接收时,如果希望忽略某个值,则使用<code>_</code>符号表示占位忽略</li>
<li>如果返回值只有一个,<code>(返回值类型列表)</code>可以不写</li>
</ol>
<h3 id="案例-计算两个数的和and差"><a href="#案例-计算两个数的和and差" class="headerlink" title="案例: 计算两个数的和and差"></a>案例: 计算两个数的和and差</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算两个数的 和/查 值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSumAndSub</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>&#123;</span><br><span class="line">	sum := n1 + n2</span><br><span class="line">	sub := n1 - n2</span><br><span class="line">	<span class="keyword">return</span> sum, sub</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	<span class="keyword">var</span> n1 <span class="keyword">int</span> = <span class="number">30</span></span><br><span class="line">	<span class="keyword">var</span> n2 <span class="keyword">int</span> = <span class="number">20</span></span><br><span class="line">	sum, sub := getSumAndSub(n1, n2)</span><br><span class="line">	fmt.Printf(<span class="string">"sum=%d, sub=%d \n"</span>, sum, sub)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4keaq3dqkj20bz00vdfr.jpg" alt="image-20220726161157132"></p>
<h2 id="函数的递归"><a href="#函数的递归" class="headerlink" title="函数的递归"></a>函数的递归</h2><blockquote>
<p>  一个函数在函数体内又调用了本身，我们称为递归调用</p>
</blockquote>
<p>快速通过代码理解一下</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> n &gt; <span class="number">2</span> &#123;</span><br><span class="line">		n--</span><br><span class="line">		test(n)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"n="</span>, n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	test(<span class="number">4</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4kfmvxn9lj20bv01nmx3.jpg" alt="image-20220726165814493"></p>
<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4kfp7tpl0j20bs0bsdg9.jpg" alt="image-20220726170028404" style="zoom:67%;">

<p>???</p>
<p>为什么是 2 2 3 ???</p>
<blockquote>
<p>  递归说白了就是套娃,优先执行最里边的,然后由里到外依次执行,所以你会看到 2 2 3 这个结果</p>
<p>  什么?还不明白?</p>
<p>  那我给你解释一下上面的代码</p>
</blockquote>
<ul>
<li>test(4) – 第一步<ul>
<li>符合if判断条件<ul>
<li>n– 此时n由4-1变为了3</li>
<li>test(3)</li>
</ul>
</li>
<li>n=3</li>
</ul>
</li>
<li>test(3) – 第二步<ul>
<li>符合if判断条件<ul>
<li>n– 此时n由3-1变为了2</li>
<li>test(2)</li>
</ul>
</li>
<li>n=2</li>
</ul>
</li>
<li>test(2) – 第三步<ul>
<li>不符合if判断条件</li>
<li>n=2</li>
</ul>
</li>
</ul>
<blockquote>
<p>  由下到上(从里到外)输出n的结果,就是 2 2 3</p>
</blockquote>
<p>原来如此</p>
<blockquote>
<p>  将上面的案例代码改变一下</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> n &gt; <span class="number">2</span> &#123;</span><br><span class="line">		n--</span><br><span class="line">		test(n)</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;	<span class="comment">//增加了else判断分支</span></span><br><span class="line">	fmt.Println(<span class="string">"n="</span>, n)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>  &#123;</span><br><span class="line">	test(<span class="number">4</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>请问,输出结果是什么?</p>
<p>经过我掐指一算,n=2</p>
<p>是的,结果只是<code>n=2</code></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><strong>函数递归需要遵守的重要原则:</strong></p>
<p>1) 执行一个函数时，就创建一个新的受保护的独立空间(新函数栈)<br>2) 函数的局部变量是独立的，不会相互影响<br>3) 递归必须向退出递归的条件逼近，否则就是无限递归，死龟了:)<br>4) 当一个函数执行完毕，或者遇到 return，就会返回，遵守谁调用，就将结果返回给谁，同时当函数执行完毕或者返回时，该函数本身也会被系统销毁</p>
<h3 id="递归函数练习"><a href="#递归函数练习" class="headerlink" title="递归函数练习"></a>递归函数练习</h3><ul>
<li>给出一个整数n,求斐波那契数列中的第n位是什么</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 计算斐波那契数,给出一个整数n(n为斐波那契数列中的第几位),输出第n位的数值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">f</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">1</span> || n == <span class="number">2</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> f(n<span class="number">-1</span>) + f(n<span class="number">-2</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"f(3)="</span>, f(<span class="number">3</span>))</span><br><span class="line">	fmt.Println(<span class="string">"f(5)="</span>, f(<span class="number">5</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4l79o0owmj20bs017747.jpg" alt="image-20220727085416484"></p>
<ul>
<li><p>猴子吃桃子问题:</p>
<ul>
<li><p>有一堆桃子，猴子第一天吃了其中的一半，并再多吃了一个!以后每天猴子都吃其中的一半，然后<br>再多吃一个。当到第十天时，想再吃时(还没吃)，发现只有 1 个桃子了。问题:最初共多少个桃子? </p>
</li>
<li><p>思路分析:</p>
<ul>
<li><p>第10 天只有一个桃子</p>
</li>
<li><p>第9天有几个桃子 = (第10天桃子数量 + 1) * 2</p>
</li>
<li><p>规律: 第 n 天的桃子数据 peach(n) = (peach(n+1) + 1) * 2</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// -   有一堆桃子，猴子第一天吃了其中的一半，并再多吃了一个!以后每天猴子都吃其中的一半，然后</span></span><br><span class="line"><span class="comment">// 再多吃一个。当到第十天时，想再吃时(还没吃)，发现只有 1 个桃子了。问题:最初共多少个桃子?</span></span><br><span class="line"><span class="comment">// -   思路分析:</span></span><br><span class="line"><span class="comment">//     -   第10 天只有一个桃子</span></span><br><span class="line"><span class="comment">//     -   第9天有几个桃子 = (第10天桃子数量 + 1) * 2</span></span><br><span class="line"><span class="comment">//     -   规律: 第 n 天的桃子数据 peach(n) = (peach(n+1) + 1) * 2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">peach</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> n == <span class="number">10</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> (peach(n+<span class="number">1</span>) + <span class="number">1</span>) * <span class="number">2</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"第一天的桃子数量为"</span>, peach(<span class="number">1</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4l8022xpbj20bt00wjrb.jpg" alt="image-20220727091940161"></p>
<h2 id="函数的注意事项和细节"><a href="#函数的注意事项和细节" class="headerlink" title="函数的注意事项和细节"></a>函数的注意事项和细节</h2><p>1) 函数的<code>形参列表</code>可以是多个，<code>返回值列表</code>也可以是多个。<br>2) 形参列表和返回值列表的数据类型可以是<code>值类型</code>和<code>引用类型</code>。<br>3) 函数的命名遵循标识符命名规范，首字母不能是数字，<code>首字母大写该函数</code>可以被本包文件和其<br>    它包文件使用，类似 public , 首字母小写，只能被本包文件使用，其它包文件不能使用，类似 privat<br>4) <code>函数</code>中的变量是<code>局部</code>的，函数外不生效<br>5) 基本数据类型和数组默认都是值传递的，即进行值拷贝。在函数内修改，不会影响到原来的值。可以参考<a href="##函数的调用机制">函数的调用机制</a><br>6) 如果希望<code>函数内的变量</code>能修改<code>函数外的变量</code>(指的是默认以值传递的方式的数据类型)，可以传入变量的地址&amp;，函数内以指针的方式操作变量。从效果上看类似引用 。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(n *<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	*n = *n + <span class="number">10</span></span><br><span class="line">	fmt.Println(<span class="string">"n="</span>, *n)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> n1 <span class="keyword">int</span> = <span class="number">20</span></span><br><span class="line">	test(&amp;n1)</span><br><span class="line">	fmt.Println(<span class="string">"n1="</span>, n1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果为</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">n= <span class="number">30</span></span><br><span class="line">n1= <span class="number">30</span></span><br></pre></td></tr></table></figure>

<ol start="7">
<li>Go函数不支持函数重载</li>
</ol>
<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4li4soq97j20je07rjrt.jpg" alt="image-20220727151013127" style="zoom:67%;">

<ol start="8">
<li>在 Go 中，<code>函数</code>也是一种<code>数据类型</code>，可以赋值给一个变量，则该变量就是一个函数类型的变量了。通过该变量可以对函数调用</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSum</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> n1 + n2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	a := getSum</span><br><span class="line">	fmt.Printf(<span class="string">"a的类型是%T, getSum的类型是%T \n"</span>, a, getSum)</span><br><span class="line"></span><br><span class="line">	n1 := <span class="number">10</span></span><br><span class="line">	n2 := <span class="number">20</span></span><br><span class="line">	fmt.Println(<span class="string">"n1+n2="</span>, a(n1, n2))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4lii7d2d7j20c9016dft.jpg" alt="image-20220727152305861"></p>
<ol start="9">
<li><code>函数</code>既然是一种<code>数据类型</code>，因此在 Go 中，函数可以作为形参，并且调用</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSum</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> n1 + n2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 下面的funvar表示函数的变量名,例如int的变量名是num1和num2</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">myFun</span><span class="params">(funvar <span class="keyword">func</span>(<span class="keyword">int</span>, <span class="keyword">int</span>)</span> <span class="title">int</span>, <span class="title">num1</span> <span class="title">int</span>, <span class="title">num2</span> <span class="title">int</span>) <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> funvar(num1, num2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	n1 := <span class="number">10</span></span><br><span class="line">	n2 := <span class="number">20</span></span><br><span class="line">	fmt.Println(<span class="string">"n1+n2="</span>, myFun(getSum, n1, n2))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4lir7u9a7j20bw00tq2u.jpg" alt="image-20220727153145866"></p>
<ol start="10">
<li>为了简化数据类型定义，Go 支持<code>自定义数据类型</code></li>
</ol>
<p>基本语法:</p>
<ul>
<li>type 自定义数据类型名 数据类型     // 理解: 相当于一个别名 </li>
</ul>
<p>案例1:</p>
<ul>
<li>type myInt int     // 这时 myInt 就等价 int 来使用了.</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">type</span> myInt <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> n1 myInt</span><br><span class="line">	<span class="keyword">var</span> n2 <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line">	n1 = <span class="number">1</span></span><br><span class="line">	n2 = <span class="keyword">int</span>(n1) <span class="comment">//虽然能自定义,但是系统认为这是两个不同的变量类型</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"n1="</span>, n1, <span class="string">"n2="</span>, n2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>案例2:</p>
<ul>
<li>自定义函数类型</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSum</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> n1 + n2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> myFunType <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span> <span class="title">int</span>	// 在刚才的代码上进行修改,增加此行</span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function"><span class="title">func</span> <span class="title">myFun</span><span class="params">(funvar myFunType, num1 <span class="keyword">int</span>, num2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;	<span class="comment">// 直接使用myFunType类型定义funvar变量参数</span></span><br><span class="line">	<span class="keyword">return</span> funvar(num1, num2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	n1 := <span class="number">10</span></span><br><span class="line">	n2 := <span class="number">20</span></span><br><span class="line">	fmt.Println(<span class="string">"n1+n2="</span>, myFun(getSum, n1, n2))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="11">
<li>支持对函数返回值命名</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">getSumAndSub1</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="params">(sum <span class="keyword">int</span>, sub <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	sum = n1 + n2</span><br><span class="line">	sub = n1 - n2</span><br><span class="line">	<span class="keyword">return</span> sum, sub</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	sum, sub := getSumAndSub1(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">	fmt.Printf(<span class="string">"sum=%d, sub=%d \n"</span>, sum, sub)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="12">
<li>使用 _ 标识符，忽略返回值</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	sum, _ := getSumAndSub1(<span class="number">2</span>, <span class="number">1</span>)</span><br><span class="line">	fmt.Printf(<span class="string">"sum=%d \n"</span>, sum)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="13">
<li>Go支持可变参数</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(n1 <span class="keyword">int</span>, args ...<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	sum := n1</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(args); i++ &#123;</span><br><span class="line">		sum += args[i]</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sum</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	result := sum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">	fmt.Println(<span class="string">"1+2+3+4="</span>, result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="init函数"><a href="#init函数" class="headerlink" title="init函数"></a>init函数</h2><blockquote>
<p>  每一个源文件都可以包含一个 init 函数，该函数会在 main 函数执行前，被 Go 运行框架调用，也 就是说 init 会在 main 函数前被调用。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"init()..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"main()..."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4lk1a9rkdj20bu017glj.jpg" alt="image-20220727161602326"></p>
<h3 id="init函数的注意事项和细节"><a href="#init函数的注意事项和细节" class="headerlink" title="init函数的注意事项和细节"></a>init函数的注意事项和细节</h3><ol>
<li>如果一个文件同时包含<code>全局变量定义</code>，<code>init 函数</code>和 <code>main 函数</code>，则执行的流程为:</li>
</ol>
<ul>
<li>全局变量定义</li>
<li>init函数</li>
<li>main 函数</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义全局变量</span></span><br><span class="line"><span class="keyword">var</span> age = test()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"test()..."</span>)</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"init()..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"main... num="</span>, age)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4lkcz5qhmj20br01ha9y.jpg" alt="image-20220727162716758"></p>
<p>从上图可以看到,函数<code>test()</code>先被执行了,也就是说全局变量<code>age</code>首先被执行</p>
<ol start="2">
<li>init函数最主要的作用，就是完成一些初始化的工作</li>
<li>分析下图的执行顺序</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mfwe9qhqj20mq0cfjrt.jpg" alt="image-20220728103828158"></p>
<h2 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h2><blockquote>
<p>  Go 支持匿名函数，匿名函数就是没有名字的函数，如果我们某个函数只是希望使用一次，可以考 虑使用匿名函数，匿名函数也可以实现多次调用。</p>
</blockquote>
<ul>
<li>案例一</li>
</ul>
<blockquote>
<p>   在定义匿名函数时就直接调用，这种方式匿名函数只能调用一次。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// 直接调用,只能使用一次</span></span><br><span class="line">	result := <span class="function"><span class="keyword">func</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">		<span class="keyword">return</span> n1 + n2</span><br><span class="line">	&#125;(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"n1+n2="</span>, result)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>案例二</li>
</ul>
<blockquote>
<p>  将匿名函数赋给一个变量(函数变量)，再通过该变量来调用匿名函数</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 直接调用,只能使用一次</span></span><br><span class="line">	result := <span class="function"><span class="keyword">func</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">		<span class="keyword">return</span> n1 + n2</span><br><span class="line">	&#125;(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"n1+n2="</span>, result)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// a的数据类型为函数类型,通过该变量来调用匿名函数</span></span><br><span class="line">	a := <span class="function"><span class="keyword">func</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">		<span class="keyword">return</span> n1 + n2</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	res := a(<span class="number">20</span>, <span class="number">30</span>)</span><br><span class="line">	fmt.Println(<span class="string">"res="</span>, res)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="全局匿名函数"><a href="#全局匿名函数" class="headerlink" title="全局匿名函数"></a>全局匿名函数</h3><blockquote>
<p>  如果将匿名函数赋给一个全局变量，那么这个匿名函数，就成为一个全局匿名函数，可以在程序有效。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明全局变量</span></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	Fun = <span class="function"><span class="keyword">func</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">		<span class="keyword">return</span> n1 * n2</span><br><span class="line">	&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	res := Fun(<span class="number">3</span>, <span class="number">4</span>)</span><br><span class="line">	fmt.Println(<span class="string">"n1 * n2 ="</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h2><blockquote>
<p>  闭包就是一个函数和与其相关的引用环境组合的一个整体(实体)</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AddUpper</span><span class="params">()</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> n <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(x <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">		n = n + x</span><br><span class="line">		<span class="keyword">return</span> n</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	f := AddUpper()</span><br><span class="line">	fmt.Println(f(<span class="number">1</span>))</span><br><span class="line">	fmt.Println(f(<span class="number">1</span>))</span><br><span class="line">	fmt.Println(f(<span class="number">1</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mhmi2b3fj20dm01lt8l.jpg" alt="image-20220728113811995"></p>
<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4kfp7tpl0j20bs0bsdg9.jpg" alt="image-20220726170028404" style="zoom:67%;">

<p>我表示很懵逼啊,什么玩意儿???</p>
<ul>
<li>对上面代码的说明和总结</li>
</ul>
<p>1) AddUpper 是一个函数，返回的数据类型是<code>fun (int) int</code><br>2) 闭包的说明: 返回的是一个<code>匿名函数</code>, 但是这个匿名函数引用到<code>函数外</code>的 <code>n</code> ,因此这个<code>匿名函数</code>就和<code>n</code> 形成一个整体，构成闭包<br>3) 大家可以这样理解: <code>闭包是类</code>,<code>函数是操作</code>，<code>n 是字段</code>。函数和它使用到 n 构成闭包。<br>4) 当我们反复的调用<code>f 函数</code>时，因为 n 是初始化一次，因此每调用一次就进行累计。<br>5) 我们要搞清楚闭包的关键，就是要分析出返回的函数它使用(引用)到哪些变量，因为函数和它引用到的变量共同构成闭包。</p>
<ul>
<li>更改一下上面的代码</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AddUpper</span><span class="params">()</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> n <span class="keyword">int</span> = <span class="number">10</span></span><br><span class="line">	<span class="keyword">var</span> str <span class="keyword">string</span> = <span class="string">"hello"</span></span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(x <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">		n = n + x</span><br><span class="line">		str += <span class="keyword">string</span>(<span class="number">36</span>) <span class="comment">//ASCII码中,36对应的是 "$"</span></span><br><span class="line">		fmt.Println(<span class="string">"str="</span>, str)</span><br><span class="line">		<span class="keyword">return</span> n</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	f := AddUpper()</span><br><span class="line">	fmt.Println(f(<span class="number">1</span>))</span><br><span class="line">	fmt.Println(f(<span class="number">1</span>))</span><br><span class="line">	fmt.Println(f(<span class="number">1</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mkh72fz9j20dc02q0so.jpg" alt="image-20220728131653658"></p>
<h3 id="闭包的最佳实践"><a href="#闭包的最佳实践" class="headerlink" title="闭包的最佳实践"></a>闭包的最佳实践</h3><ul>
<li>请编写一个程序,具体要求如下<ul>
<li>编写一个函数 <code>makeSuffix(suffix string)</code>可以接收一个文件后缀名(比如.jpg)，并返回一个闭包</li>
<li>调用闭包，可以传入一个文件名，如果该文件名没有指定的后缀(比如.jpg) ,则返回文件名.jpg , 如果已经有.jpg 后缀，则返回原文件名。</li>
<li>要求使用闭包的方式完成</li>
<li>strings.HasSuffix , 该函数可以判断某个字符串是否有指定的后缀。</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"strings"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// -   编写一个函数 makeSuffix(suffix string) 可以接收一个文件后缀名(比如.jpg)，并返回一个闭包</span></span><br><span class="line"><span class="comment">// -   调用闭包，可以传入一个文件名，如果该文件名没有指定的后缀(比如.jpg) ,则返回 文件名.jpg , 如果已经有.jpg 后缀，则返回原文件名。</span></span><br><span class="line"><span class="comment">// -   要求使用闭包的方式完成</span></span><br><span class="line"><span class="comment">// -   strings.HasSuffix , 该函数可以判断某个字符串是否有指定的后缀。</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeSuffix</span><span class="params">(suffix <span class="keyword">string</span>)</span> <span class="title">func</span><span class="params">(<span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(name <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">		<span class="comment">// 如果 name 没有指定后缀,则加上,否则就返回原来的名字</span></span><br><span class="line">		<span class="keyword">if</span> !strings.HasSuffix(name, suffix) &#123;</span><br><span class="line">			<span class="keyword">return</span> name + suffix</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> name</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	f := makeSuffix(<span class="string">".jpg"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"文件名处理后="</span>, f(<span class="string">"1"</span>))</span><br><span class="line">	fmt.Println(<span class="string">"文件名处理后="</span>, f(<span class="string">"2.jpg"</span>))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mluxbyrbj20dj018748.jpg" alt="image-20220728140441341"></p>
<h2 id="defer"><a href="#defer" class="headerlink" title="defer"></a>defer</h2><blockquote>
<p>  在函数中，程序员经常需要创建资源(比如:数据库连接、文件句柄、锁等) ，为了在函数执行完毕后，及时的释放资源，Go 的设计者提供 defer (延时机制)。</p>
</blockquote>
<h3 id="快速入门-2"><a href="#快速入门-2" class="headerlink" title="快速入门"></a>快速入门</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="comment">// 当执行到defer时,暂时不执行,会将defer后面的语句压入到独立的栈(defer栈)</span></span><br><span class="line">	<span class="comment">// 当函数执行完毕后,再从defer栈,按照先入后出的方式出栈执行</span></span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">"ok1 n1="</span>, n1)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">"ok2 n2="</span>, n2)</span><br><span class="line"></span><br><span class="line">	res := n1 + n2</span><br><span class="line">	fmt.Println(<span class="string">"ok3 res="</span>, res)</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	res := sum(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">"res="</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mm9al52yj20f9020t8o.jpg" alt="image-20220728141829569"></p>
<h3 id="注意事项和细节-1"><a href="#注意事项和细节-1" class="headerlink" title="注意事项和细节"></a>注意事项和细节</h3><p>1) 当 go 执行到一个 defer 时，不会立即执行 defer 后的语句，而是将 defer 后的语句压入到一个<code>栈</code>中[我为了讲课方便，暂时称该栈为 <code>defer 栈</code>], 然后继续执行函数下一个语句。<br>2) 当函数执行完毕后，在从 defer 栈中，依次从栈顶取出语句执行(注:遵守栈<code>先入后出</code>的机制)<br>3) 在 defer 将语句放入到栈时，也会将相关的值拷贝同时入栈。</p>
<ul>
<li>看代码</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sum</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="comment">// 当执行到defer时,暂时不执行,会将defer后面的语句压入到独立的栈(defer栈)</span></span><br><span class="line">	<span class="comment">// 当函数执行完毕后,再从defer栈,按照先入后出的方式出栈执行</span></span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">"ok1 n1="</span>, n1)</span><br><span class="line">	<span class="keyword">defer</span> fmt.Println(<span class="string">"ok2 n2="</span>, n2)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 增加部分</span></span><br><span class="line">	n1++           <span class="comment">// n1 = 11</span></span><br><span class="line">	n2++           <span class="comment">// n2 = 21</span></span><br><span class="line">	res := n1 + n2 <span class="comment">// res = 32</span></span><br><span class="line">	fmt.Println(<span class="string">"ok3 res="</span>, res)</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	res := sum(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">"res="</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>看执行结果</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4mmkphvyij20eu0230sq.jpg" alt="image-20220728142928572"></p>
<blockquote>
<p>  当执行两个<code>defer</code>语句的时候,这两行被放入了<code>defer栈</code>中,所以它并没有参与到下面的计算之中,等函数执行完毕后,才会根据先入后出的原则依次执行,所以我们会看到这样的结果</p>
</blockquote>
<h3 id="defer-的最佳实践"><a href="#defer-的最佳实践" class="headerlink" title="defer 的最佳实践"></a>defer 的最佳实践</h3><blockquote>
<p>  defer 最主要的价值是在，当函数执行完毕后，可以及时的释放函数创建的资源。</p>
</blockquote>
<p>模拟代码:</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 关闭文件资源</span></span><br><span class="line">    file = openfile(文件名)</span><br><span class="line">    <span class="keyword">defer</span> file.<span class="built_in">close</span>()</span><br><span class="line">    <span class="comment">// 其他代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>使用defer的好处:</li>
</ul>
<p>1) 在 golang 编程中的通常做法是，创建资源后，比如(打开了文件，获取了数据库的链接，或者是<br>    锁资源)， 可以执行 defer file.Close() defer connect.Close()<br>2) 在 defer 后，可以继续使用创建资源.<br>3) 当函数完毕后，系统会依次从 defer 栈中，取出语句，关闭资源.<br>4) 这种机制，非常简洁，程序员不用再为在什么时机关闭资源而烦心。</p>
<h2 id="字符串常用系统函数"><a href="#字符串常用系统函数" class="headerlink" title="字符串常用系统函数"></a>字符串常用系统函数</h2><h3 id="统计字符串长度-len"><a href="#统计字符串长度-len" class="headerlink" title="统计字符串长度: len()"></a>统计字符串长度: len()</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str <span class="keyword">string</span> = <span class="string">"Hello"</span></span><br><span class="line">fmt.Println(<span class="string">"str len"</span>, <span class="built_in">len</span>(str))</span><br></pre></td></tr></table></figure>

<h3 id="字符串遍历"><a href="#字符串遍历" class="headerlink" title="字符串遍历"></a>字符串遍历</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">str := <span class="string">"Hello北京"</span></span><br><span class="line"><span class="comment">// 字符串遍历,同时处理有中文的问题 r := []rune(str)</span></span><br><span class="line">r := []<span class="keyword">rune</span>(str)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i&lt; <span class="built_in">len</span>(r); i++ &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"字符=%c \n"</span>, r[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="字符串转整数"><a href="#字符串转整数" class="headerlink" title="字符串转整数"></a>字符串转整数</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">n, err := strconv.Atoi(<span class="string">"hello"</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">"转换错误"</span>, err)</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    fmt.Println(<span class="string">"转成的结果是"</span>, n)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="整数转字符串"><a href="#整数转字符串" class="headerlink" title="整数转字符串"></a>整数转字符串</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str = strconv.Itoa(<span class="number">12345</span>)</span><br><span class="line">fmt.Printf(<span class="string">"str=%v, str=%T \n"</span>, str, str)</span><br></pre></td></tr></table></figure>

<h3 id="字符串转-byte"><a href="#字符串转-byte" class="headerlink" title="字符串转[]byte"></a>字符串转[]byte</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bytes = []<span class="keyword">byte</span>(<span class="string">"Hello go"</span>)</span><br><span class="line">fmt.Println(<span class="string">"bytes=%v \n"</span>, bytes)</span><br></pre></td></tr></table></figure>

<h3 id="byte转字符串"><a href="#byte转字符串" class="headerlink" title="[]byte转字符串"></a>[]byte转字符串</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="keyword">string</span>([]<span class="keyword">byte</span>&#123;<span class="number">12</span>,<span class="number">34</span>,<span class="number">56</span>&#125;)</span><br><span class="line">fmt.Printf(<span class="string">"str=%v \n"</span>, str)</span><br></pre></td></tr></table></figure>

<h3 id="十进制转其它进制-1"><a href="#十进制转其它进制-1" class="headerlink" title="十进制转其它进制"></a>十进制转其它进制</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str = strconv.FormatInt(<span class="number">123</span>, <span class="number">2</span>)</span><br><span class="line">fmt.Printf(<span class="string">"123对应的二进制是:%v \n"</span>, str)</span><br><span class="line">str = strconv.FormatInt(<span class="number">123</span>, <span class="number">16</span>)</span><br><span class="line">fmt.Printf(<span class="string">"123对应的十六进制是:%v \n"</span>, str)</span><br></pre></td></tr></table></figure>

<h3 id="查找子串是否在指定的字符串中"><a href="#查找子串是否在指定的字符串中" class="headerlink" title="查找子串是否在指定的字符串中"></a>查找子串是否在指定的字符串中</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">b := strings.Contains(<span class="string">"seafood"</span>, <span class="string">"foo"</span>)</span><br><span class="line">fmt.Printf(<span class="string">"b=%v \n"</span>, b)</span><br></pre></td></tr></table></figure>

<h3 id="统计子串个数"><a href="#统计子串个数" class="headerlink" title="统计子串个数"></a>统计子串个数</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num := strings.Count(<span class="string">"ceheese"</span>, <span class="string">"e"</span>)</span><br><span class="line">fmt.Printf(<span class="string">"num=%v \n"</span>, num)</span><br></pre></td></tr></table></figure>

<h3 id="不区分大小写的字符串比较"><a href="#不区分大小写的字符串比较" class="headerlink" title="不区分大小写的字符串比较"></a>不区分大小写的字符串比较</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b = strings.EqualFold(<span class="string">"abc"</span>, <span class="string">"Abc"</span>)</span><br><span class="line">fmt.Printf(<span class="string">"b=%v \n"</span>, b)	<span class="comment">// true</span></span><br><span class="line">fmt.Println(<span class="string">"结果"</span>, <span class="string">"abc"</span> == <span class="string">"Abc"</span>)	<span class="comment">// false, 区分大小写</span></span><br></pre></td></tr></table></figure>

<h3 id="获取指定字符的索引"><a href="#获取指定字符的索引" class="headerlink" title="获取指定字符的索引"></a>获取指定字符的索引</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回子串在字符串第一次出现的 index 值，如果没有返回-1</span></span><br><span class="line">index := strings.Index(<span class="string">"NLT_abcabcabc"</span>, <span class="string">"abc"</span>)	<span class="comment">//4</span></span><br><span class="line">fmt.Printf(<span class="string">"index=%v \n"</span>, index)</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 返回子串在字符串最后一次出现的 index，如没有返回-1</span></span><br><span class="line">index := strings.LastIndex(<span class="string">"go golang"</span>, <span class="string">"go"</span>)	<span class="comment">//3</span></span><br><span class="line">fmt.Printf(<span class="string">"index=%v \n"</span>, index)</span><br></pre></td></tr></table></figure>

<h3 id="字符串的替换"><a href="#字符串的替换" class="headerlink" title="字符串的替换"></a>字符串的替换</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// strings.Replace("go go hello", "go", "go 语言", n) </span></span><br><span class="line"><span class="comment">// n 可以指定你希望替换几个，如果 n=-1 表示全部替换</span></span><br><span class="line">str1 = <span class="string">"go go hello"</span></span><br><span class="line">str2 = strings.Replace(str1, <span class="string">"go"</span>, <span class="string">"北京"</span>, <span class="number">-1</span>)</span><br><span class="line">fmt.Printf(<span class="string">"str1=%v str2=%v \n"</span>, str1, str2)</span><br></pre></td></tr></table></figure>

<h3 id="分隔字符串"><a href="#分隔字符串" class="headerlink" title="分隔字符串"></a>分隔字符串</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 按照指定的某个字符，为分割标识，将一个字符串拆分成字符串数组</span></span><br><span class="line">strArr := strings.Split(<span class="string">"Hello,world,ok"</span>, <span class="string">","</span>)</span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(strArr); i++ &#123;</span><br><span class="line">    fmt.Printf(<span class="string">"str[%v]=%v \n"</span>, i, strArr[i])</span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">"strArr=%v \n"</span>, strArr)</span><br></pre></td></tr></table></figure>

<h3 id="大小写转换"><a href="#大小写转换" class="headerlink" title="大小写转换"></a>大小写转换</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str = <span class="string">"golang Hello"</span></span><br><span class="line">str = strings.ToLower(str)</span><br><span class="line">str = strings.toUpper(str)</span><br><span class="line">fmt.Printf(<span class="string">"str=%v \n"</span>, str)	<span class="comment">//golang hello</span></span><br></pre></td></tr></table></figure>

<h3 id="去除两边空格"><a href="#去除两边空格" class="headerlink" title="去除两边空格"></a>去除两边空格</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str = strings.TrimSpace(<span class="string">" a b c d "</span>)</span><br><span class="line">fmt.Printf(<span class="string">"str=%v \n"</span>, str)</span><br></pre></td></tr></table></figure>

<h3 id="去除两遍指定字符"><a href="#去除两遍指定字符" class="headerlink" title="去除两遍指定字符"></a>去除两遍指定字符</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str = strings.Trim(<span class="string">"! a b c d! "</span>, <span class="string">" !"</span>)</span><br><span class="line">fmt.Printf(<span class="string">"str=%v \n"</span>, str)</span><br><span class="line"><span class="comment">// 将字符串左边指定的字符去掉 : strings.TrimLeft("! hello! ", " !")</span></span><br><span class="line"><span class="comment">// 将字符串右边指定的字符去掉 :strings.TrimRight("! hello! ", " !")</span></span><br></pre></td></tr></table></figure>

<h3 id="判断字符串开头-结束内容"><a href="#判断字符串开头-结束内容" class="headerlink" title="判断字符串开头/结束内容"></a>判断字符串开头/结束内容</h3><ul>
<li>判断字符串是否以指定的字符串开头: strings.HasPrefix(“<a href="ftp://192.168.10.1&quot;" target="_blank" rel="noopener">ftp://192.168.10.1&quot;</a>, “ftp”)    //true</li>
<li>判断字符串是否以指定的字符串结束: strings.HasSuffix(“NLT_abc.jpg”, “abc”) //false</li>
</ul>
<h2 id="时间和日期相关函数"><a href="#时间和日期相关函数" class="headerlink" title="时间和日期相关函数"></a>时间和日期相关函数</h2><blockquote>
<p>  在编程中，程序员会经常使用到日期相关的函数，比如:统计某段代码执行花费的时间等等。</p>
</blockquote>
<ul>
<li>获取当前时间</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//看看日期和时间相关函数和方法使用</span></span><br><span class="line">	<span class="comment">//获取当前时间</span></span><br><span class="line">	now := time.Now()</span><br><span class="line">	fmt.Printf(<span class="string">"now=%v now-type=%T \n"</span>, now, now)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果为</p>
<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4npzswif3j20f600rglm.jpg" alt="image-20220729131319622" style="zoom:120%;">

<ul>
<li>获取其他日期信息</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//看看日期和时间相关函数和方法使用</span></span><br><span class="line">	<span class="comment">//获取当前时间</span></span><br><span class="line">	now := time.Now()</span><br><span class="line">	fmt.Printf(<span class="string">"now=%v now-type=%T \n"</span>, now, now)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//通过now可以获取到年月日时分秒</span></span><br><span class="line">	fmt.Printf(<span class="string">"年=%v \n"</span>, now.Year())</span><br><span class="line">	fmt.Printf(<span class="string">"月=%v \n"</span>, now.Month())</span><br><span class="line">	fmt.Printf(<span class="string">"月=%v \n"</span>, <span class="keyword">int</span>(now.Month()))</span><br><span class="line">	fmt.Printf(<span class="string">"日=%v \n"</span>, now.Day())</span><br><span class="line">	fmt.Printf(<span class="string">"时=%v \n"</span>, now.Hour())</span><br><span class="line">	fmt.Printf(<span class="string">"分=%v \n"</span>, now.Minute())</span><br><span class="line">	fmt.Printf(<span class="string">"秒=%v \n"</span>, now.Second())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果为</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4nq745jvtj20f303jglr.jpg" alt="image-20220729132021387"></p>
<ul>
<li>时间格式化输出</li>
</ul>
<p><strong>Printf 或者 Sprintf</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//格式化输出</span></span><br><span class="line"><span class="comment">//Printf</span></span><br><span class="line">fmt.Printf(<span class="string">"%d-%d-%d %d:%d:%d \n"</span>, now.Year(), now.Month(), now.Day(), now.Hour(), now.Minute(), now.Second())</span><br><span class="line"><span class="comment">//SPrintf</span></span><br><span class="line">date := fmt.Sprintf(<span class="string">"%d-%d-%d %d:%d:%d \n"</span>, now.Year(), now.Month(), now.Day(), now.Hour(), now.Minute(), now.Second())</span><br><span class="line">fmt.Printf(<span class="string">"date=%v"</span>, date)</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4nqftryiej205300t0sj.jpg" alt="image-20220729132844121" style="zoom:150%;">

<p><strong>time.Format()</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Format(),里面必须写成 2006-01-02 15:04:05 !</span></span><br><span class="line">fmt.Printf(now.Format(<span class="string">"2006-01-02 15:04:05"</span>))</span><br><span class="line">fmt.Println()</span><br><span class="line">fmt.Printf(now.Format(<span class="string">"2006-01-02"</span>))</span><br><span class="line">fmt.Println()</span><br><span class="line">fmt.Printf(now.Format(<span class="string">"15:04:05"</span>))</span><br><span class="line">fmt.Println()</span><br></pre></td></tr></table></figure>

<ul>
<li>时间的常量</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ( </span><br><span class="line">    Nanosecond	Duration = <span class="number">1</span> <span class="comment">//纳秒</span></span><br><span class="line">	Microsecond	= <span class="number">1000</span> * Nanosecond <span class="comment">//微秒</span></span><br><span class="line">    Millisecond = <span class="number">1000</span> * Microsecond <span class="comment">//毫秒</span></span><br><span class="line">    Second = <span class="number">1000</span> * Millisecond <span class="comment">//秒</span></span><br><span class="line">    Minute = <span class="number">60</span> * Second <span class="comment">//分钟</span></span><br><span class="line">	Hour = <span class="number">60</span> * Minute <span class="comment">//小时</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>常量的作用:</p>
<blockquote>
<p>  在程序中可用于获取指定时间单位的时间，比如想得到 100 毫秒</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">100</span> * time.Millisecond</span><br></pre></td></tr></table></figure>

<p>也可以结合Sleep使用</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time.Sleep(time.Millisecond * <span class="number">100</span>)	<span class="comment">//等待0.1秒</span></span><br></pre></td></tr></table></figure>

<ul>
<li>时间戳</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fmt.Printf(<span class="string">"unix时间戳=%v, unixnano时间戳=%v \n"</span>, now.Unix(), now.UnixNano())</span><br></pre></td></tr></table></figure>

<p>返回结果:</p>
<blockquote>
<p>  unix时间戳=1659074372,  unixnano时间戳=1659074372349450000 </p>
</blockquote>
<h2 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h2><p>文档地址: <a href="https://studygolang.com/pkgdoc" target="_blank" rel="noopener">https://studygolang.com/pkgdoc</a></p>
<ul>
<li><p><strong>len:</strong> 用来求长度，比如<code>string</code>、<code>array</code>、<code>slice</code>、<code>map</code>、<code>channel</code></p>
</li>
<li><p><strong>new:</strong> 用来分配内存，主要用来分配值类型，比如<code>int</code>、<code>float32</code>, <code>struct</code>…返回的是指针</p>
</li>
</ul>
<h3 id="new的使用"><a href="#new的使用" class="headerlink" title="new的使用"></a>new的使用</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	num1 := <span class="number">100</span></span><br><span class="line">	fmt.Printf(<span class="string">"num1的类型为%T, num1的值为%v, num1的地址为%v \n"</span>, num1, num1, &amp;num1)</span><br><span class="line"></span><br><span class="line">	num2 := <span class="built_in">new</span>(<span class="keyword">int</span>) <span class="comment">//*int</span></span><br><span class="line">	<span class="comment">//num2的类型%T =&gt; *int</span></span><br><span class="line">	<span class="comment">//num2的值 = 系统分配的地址 0xc0000140a8</span></span><br><span class="line">	<span class="comment">//num2的地址%v = 系统分配的地址 0xc00000e030</span></span><br><span class="line">	<span class="comment">//num2指向的值 = 100</span></span><br><span class="line">	*num2 = <span class="number">100</span></span><br><span class="line">	fmt.Printf(<span class="string">"num2的类型=%T, num2的值=%v, num2的地址=%v, num2指针指向的值=%v \n"</span>, num2, num2, &amp;num2, *num2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果为</p>
<blockquote>
<p>  num1的类型为int, num1的值为100, num1的地址为0xc0000140a0<br>  num2的类型=*int, num2的值=0xc0000140a8, num2的地址=0xc00000e030, num2指针指向的值=100</p>
</blockquote>
<ul>
<li>make</li>
</ul>
<blockquote>
<p>  用来分配内存，主要用来分配引用类型，比如channel、map、slice。</p>
</blockquote>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><blockquote>
<p>  Go 中可以抛出一个<code>panic</code> 的异常，然后在 <code>defer</code> 中通过 <code>recover</code>捕获这个异常，然后正常处理</p>
</blockquote>
<h3 id="defer-recover-处理错误"><a href="#defer-recover-处理错误" class="headerlink" title="defer+recover 处理错误"></a>defer+recover 处理错误</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//使用 defer + recover 来捕获和处理异常</span></span><br><span class="line">    <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span>&#123;</span><br><span class="line">        err := <span class="built_in">recover</span>()	<span class="comment">//recover()内置函数,可以捕获到异常</span></span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;		<span class="comment">//说明捕获到错误</span></span><br><span class="line">            fmt.Println(<span class="string">"err="</span>, err)</span><br><span class="line">            <span class="comment">//可以将错误信息通过邮箱发送给管理员</span></span><br><span class="line">            fmt.Println(<span class="string">"发送邮件给管理员"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;()</span><br><span class="line">    </span><br><span class="line">    num1 := <span class="number">10</span></span><br><span class="line">    num2 := <span class="number">0</span></span><br><span class="line">    res := num1 / num2</span><br><span class="line">    fmt.Println(<span class="string">"res="</span>, res)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    test()</span><br><span class="line">    <span class="keyword">for</span> &#123;</span><br><span class="line">        fmt.Println(<span class="string">"main()下面的代码..."</span>)</span><br><span class="line">        time.Sleep(time.Second)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ns373hszj20ed056jrp.jpg" alt="image-20220729142547680"></p>
<h3 id="自定义错误"><a href="#自定义错误" class="headerlink" title="自定义错误"></a>自定义错误</h3><blockquote>
<p>  Go 程序中，也支持自定义错误， 使用 errors.New 和 panic 内置函数</p>
</blockquote>
<p>1) <code>errors.New</code>(“错误说明”) , 会返回一个 <code>error</code>类型的值，表示一个错误<br>2) <code>panic</code> 内置函数 ,接收一个 <code>interface{}</code> 类型的值(也就是任何值了)作为参数。可以接收 error 类型的变量，输出错误信息，并退出程序</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"errors"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数去读取配置文件init.conf的信息</span></span><br><span class="line"><span class="comment">//如果文件名传入不正确,我们就返回一个自定义的错误</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">readConf</span><span class="params">(name <span class="keyword">string</span>)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> name == <span class="string">"config.ini"</span> &#123;</span><br><span class="line">		<span class="comment">//读取...</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">//返回一个自定义错误</span></span><br><span class="line">		<span class="keyword">return</span> errors.New(<span class="string">"读取文件错误.."</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test02</span><span class="params">()</span></span> &#123;</span><br><span class="line">	err := readConf(<span class="string">"config2.ini"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="comment">//如果读取文件发送错误,panic就输出这个错误,并终止程序</span></span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"test02继续执行..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	test02()</span><br><span class="line">	fmt.Println(<span class="string">"main下面的代码"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ntmk9yvkj20fw03j0t2.jpg" alt="image-20220729151859997"></p>
<blockquote>
<p>  因为传入<code>test02</code>中的配置文件名为<code>config2.ini</code>,触发了if判断,所以panic已经输出并终止程序,所以不会看到下面的内容了</p>
</blockquote>
<h1 id="数组与切片"><a href="#数组与切片" class="headerlink" title="数组与切片"></a>数组与切片</h1><h2 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h2><blockquote>
<p>  数组可以存放多个同一类型数据。数组也是一种数据类型，在 Go 中，数组是值类型。</p>
</blockquote>
<h3 id="快速入门-3"><a href="#快速入门-3" class="headerlink" title="快速入门"></a>快速入门</h3><ul>
<li>一个养鸡场有 6 只鸡，它们的体重分别是 3kg,5kg,1kg,3.4kg,2kg,50kg 。请问这六只鸡的总体重是<br>多少?平均体重是多少? 请你编一个程序。使用数组解决!</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//1.定义一个数组</span></span><br><span class="line">	<span class="keyword">var</span> hens [<span class="number">7</span>]<span class="keyword">float64</span></span><br><span class="line">	<span class="comment">//2.给数组的每个元素赋值,元素的下标是从0开始的 0-5</span></span><br><span class="line">	hens[<span class="number">0</span>] = <span class="number">3.0</span></span><br><span class="line">	hens[<span class="number">1</span>] = <span class="number">5.0</span></span><br><span class="line">	hens[<span class="number">2</span>] = <span class="number">1.0</span></span><br><span class="line">	hens[<span class="number">3</span>] = <span class="number">3.4</span></span><br><span class="line">	hens[<span class="number">4</span>] = <span class="number">2.0</span></span><br><span class="line">	hens[<span class="number">5</span>] = <span class="number">50.0</span></span><br><span class="line">	hens[<span class="number">6</span>] = <span class="number">150.0</span> <span class="comment">//增加一只鸡...鸡你太美</span></span><br><span class="line">	<span class="comment">//3.遍历数组求出总体重</span></span><br><span class="line">	totalWeight2 := <span class="number">0.0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(hens); i++ &#123;</span><br><span class="line">		totalWeight2 += hens[i]</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//4.求出平均体重</span></span><br><span class="line">	avgWeight2 := fmt.Sprintf(<span class="string">"%.2f"</span>, totalWeight2/<span class="keyword">float64</span>(<span class="built_in">len</span>(hens)))</span><br><span class="line">	fmt.Printf(<span class="string">"totalWeight2=%v, avgWeight2=%v \n"</span>, totalWeight2, avgWeight2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4nuuvltsmj20dv00t749.jpg" alt="image-20220729160135788"></p>
<h3 id="数组定义与内存布局"><a href="#数组定义与内存布局" class="headerlink" title="数组定义与内存布局"></a>数组定义与内存布局</h3><ul>
<li>数组的定义</li>
</ul>
<blockquote>
<p>  var 数组名 [数组大小]数据类型</p>
<p>  example:</p>
<p>  ​    var a [5]int</p>
</blockquote>
<ul>
<li>数组的内存布局(<code>重要</code>)</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> intArr [<span class="number">3</span>]<span class="keyword">int</span> <span class="comment">//int占8个字节</span></span><br><span class="line">	<span class="comment">//当我们定义完数组后,其实数组的各个元素有默认值 0</span></span><br><span class="line">	fmt.Println(intArr)</span><br><span class="line">	intArr[<span class="number">0</span>] = <span class="number">10</span></span><br><span class="line">	intArr[<span class="number">1</span>] = <span class="number">20</span></span><br><span class="line">	intArr[<span class="number">2</span>] = <span class="number">30</span></span><br><span class="line">	fmt.Println(intArr)</span><br><span class="line">	fmt.Printf(<span class="string">"intArr的地址=%p, intArr[0]地址=%p, intArr[1]地址=%p, intArr[2]地址=%p \n"</span>, &amp;intArr, &amp;intArr[<span class="number">0</span>], &amp;intArr[<span class="number">1</span>], &amp;intArr[<span class="number">2</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4nvm5zdn7j20lj01k0sv.jpg" alt="image-20220729162749243"></p>
<p>对上图的总结:<br>1) 数组的地址可以通过数组名来获取 <code>&amp;intArr</code><br>2) 数组的第一个元素的地址，就是数组的首地址,后面依次加<code>n个字节</code><br>3) 数组的各个元素的地址间隔是依据数组的类型决定，比如 int64 -&gt; 8, int32-&gt;4…</p>
<h3 id="数组的使用"><a href="#数组的使用" class="headerlink" title="数组的使用"></a>数组的使用</h3><ul>
<li>从终端循环输入5个成绩,保存到float64数组并输出</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> score [<span class="number">5</span>]<span class="keyword">float64</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(score); i++ &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"请输入第%d个元素的值 \n"</span>, i+<span class="number">1</span>)</span><br><span class="line">		fmt.Scanln(&amp;score[i])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(score); i++ &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"score[%d]=%v \n"</span>, i, score[i])</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4nwgaq7ngj20ea068aab.jpg" alt="image-20220729165647184"></p>
<ul>
<li>四种初始化数组的方式</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//传统方式</span></span><br><span class="line">	<span class="keyword">var</span> numArr01 [<span class="number">3</span>]<span class="keyword">int</span> = [<span class="number">3</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;</span><br><span class="line">	fmt.Println(<span class="string">"numArr01="</span>, numArr01)</span><br><span class="line">	<span class="comment">//简化方式</span></span><br><span class="line">	<span class="keyword">var</span> numArr02 = [<span class="number">3</span>]<span class="keyword">int</span>&#123;<span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>&#125;</span><br><span class="line">	fmt.Println(<span class="string">"numArr02="</span>, numArr02)</span><br><span class="line">	<span class="comment">//缺省方式</span></span><br><span class="line">	<span class="keyword">var</span> numArr03 = [...]<span class="keyword">int</span>&#123;<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>&#125;</span><br><span class="line">	fmt.Println(<span class="string">"numArr03="</span>, numArr03)</span><br><span class="line">	<span class="comment">//缺省+索引方式</span></span><br><span class="line">	<span class="keyword">var</span> numArr04 = [...]<span class="keyword">int</span>&#123;<span class="number">1</span>: <span class="number">800</span>, <span class="number">0</span>: <span class="number">900</span>, <span class="number">2</span>: <span class="number">999</span>&#125;</span><br><span class="line">	fmt.Println(<span class="string">"numArr04="</span>, numArr04)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//类型推导</span></span><br><span class="line">	strArr05 := [...]<span class="keyword">string</span>&#123;<span class="number">1</span>: <span class="string">"tom"</span>, <span class="number">0</span>: <span class="string">"jack"</span>, <span class="number">2</span>: <span class="string">"mary"</span>&#125;</span><br><span class="line">	fmt.Println(<span class="string">"strArr05="</span>, strArr05)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4nxb4egttj20e402gjrh.jpg" alt="image-20220729172625047"></p>
<h3 id="数组的遍历"><a href="#数组的遍历" class="headerlink" title="数组的遍历"></a>数组的遍历</h3><h4 id="常规遍历"><a href="#常规遍历" class="headerlink" title="常规遍历"></a>常规遍历</h4><p>见前面的<a href="###数组的使用">数组的使用</a></p>
<h4 id="for-range结构遍历"><a href="#for-range结构遍历" class="headerlink" title="for-range结构遍历"></a>for-range结构遍历</h4><blockquote>
<p>  这是 Go 语言一种独有的结构，可以用来遍历访问数组的元素。</p>
</blockquote>
<ul>
<li>语法结构</li>
</ul>
<blockquote>
<p>  for index, value := range array01 {</p>
<p>  ​    …</p>
<p>  }</p>
</blockquote>
<ul>
<li>案例</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	heroes := [...]<span class="keyword">string</span>&#123;<span class="string">"宋江"</span>, <span class="string">"吴用"</span>, <span class="string">"卢俊义"</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i, v := <span class="keyword">range</span> heroes &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"i=%v, v=%v \n"</span>, i, v)</span><br><span class="line">		fmt.Printf(<span class="string">"heroes[%d]=%v \n"</span>, i, heroes[i])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> heroes &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"元素的值=%v \n"</span>, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="数组的注意事项和细节"><a href="#数组的注意事项和细节" class="headerlink" title="数组的注意事项和细节"></a>数组的注意事项和细节</h3><ul>
<li>数组是多个<code>相同类型数据</code>的组合,一个数组一旦声明/定义了,其长度是<code>固定</code>的, 不能动态变化</li>
<li>var arr []int 这时 arr 就是一个 slice 切片，切片后面专门讲解，不急哈.</li>
<li>数组中的元素可以是任何数据类型，包括值类型和引用类型，但是不能混用。</li>
<li>数组创建后，如果没有赋值，有默认值(零值)<ul>
<li>数值类型数组:默认值为 0 </li>
<li>字符串数组: 默认值为 “” </li>
<li>bool 数组: 默认值为 false</li>
</ul>
</li>
<li>使用数组的步骤 <ul>
<li>1 声明数组并开辟空间 </li>
<li>2 给数组各个元素赋值(默认零值) </li>
<li>3 使用数组</li>
</ul>
</li>
<li>数组的下标是从 0 开始的</li>
<li>数组下标必须在指定范围内使用，否则报 panic:数组越界，比如 <code>var arr [5]int</code> 则有效下标为 <code>0-4</code></li>
<li>Go的数组属值类型，在默认情况下是值传递，因此会进行值拷贝。数组间不会相互影响(就是说如果一个函数直接更改数组中的某一个值,只要不直接修改地址的值,原值就不会改变)</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(arr [3]<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">88</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">arr := [<span class="number">3</span>]<span class="keyword">int</span>&#123;<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>&#125;</span><br><span class="line">test(arr)</span><br></pre></td></tr></table></figure>

<ul>
<li>如想在其它函数中，去修改原来的数组，可以使用引用传递(指针方式)</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(arr *[3]<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    *arr[<span class="number">0</span>] = <span class="number">88</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">arr := [<span class="number">3</span>]<span class="keyword">int</span>&#123;<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>&#125;</span><br><span class="line">test(&amp;arr)</span><br></pre></td></tr></table></figure>

<ul>
<li>长度是数组类型的一部分，在传递函数参数时 需要考虑数组的长度</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4nxvczswtj20n608nwfq.jpg" alt="image-20220729174551635"></p>
<h3 id="数组应用案例"><a href="#数组应用案例" class="headerlink" title="数组应用案例"></a>数组应用案例</h3><ul>
<li>案例一<ul>
<li>创建一个 byte 类型的 26 个元素的数组，分别 放置’A’-‘Z‘。使用 for 循环访问所有元素并打印<br>出来。</li>
<li>提示:字符数据运算 ‘A’+1 -&gt; ‘B’</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> myChars [<span class="number">26</span>]<span class="keyword">byte</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">26</span>; i++ &#123;</span><br><span class="line">		myChars[i] = <span class="string">'A'</span> + <span class="keyword">byte</span>(i)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">26</span>; i++ &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%c "</span>, myChars[i])</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ooqx5i1ej20e300ut8p.jpg" alt="image-20220730091542976"></p>
<ul>
<li><p>案例二</p>
<ul>
<li>请求出一个数组的最大值，并得到对应的下标</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> intArr = [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">-1</span>, <span class="number">9</span>, <span class="number">90</span>, <span class="number">11</span>, <span class="number">33</span>&#125;</span><br><span class="line">	maxVal := intArr[<span class="number">0</span>]</span><br><span class="line">	maxValIndex := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt; <span class="built_in">len</span>(intArr); i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> maxVal &lt; intArr[i] &#123;</span><br><span class="line">			maxVal = intArr[i]</span><br><span class="line">			maxValIndex = i</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">"maxVal=%v, maxValIndex=%v \n"</span>, maxVal, maxValIndex)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4op11epy6j20e100v0sp.jpg" alt="image-20220730092529783"></p>
</li>
<li><p>案例三</p>
<ul>
<li>请求出一个数组的和和平均值。for-range</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> intArr = [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">-1</span>, <span class="number">9</span>, <span class="number">90</span>, <span class="number">11</span>, <span class="number">33</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//求数组的平均值</span></span><br><span class="line">	sum := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> _, value := <span class="keyword">range</span> intArr &#123;</span><br><span class="line">		sum += value</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"sum=%v, 平均值为=%v \n"</span>, sum, <span class="keyword">float64</span>(sum)/<span class="keyword">float64</span>(<span class="built_in">len</span>(intArr)))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>案例四<ul>
<li>要求:随机生成五个数，并将其反转打印</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"math/rand"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//随机生成5个数,rand.Intn()函数</span></span><br><span class="line"><span class="comment">//当我们得到随机数后,就放到一个int数组中</span></span><br><span class="line"><span class="comment">//反转打印,交换的次数是 len / 2, 倒数第一个和第一个元素交换,倒数第二个和第二个元素交换</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> intArr [<span class="number">5</span>]<span class="keyword">int</span></span><br><span class="line">	<span class="built_in">len</span> := <span class="built_in">len</span>(intArr)</span><br><span class="line"></span><br><span class="line">	rand.Seed(time.Now().UnixNano())</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>; i++ &#123;</span><br><span class="line">		intArr[i] = rand.Intn(<span class="number">100</span>) <span class="comment">// 0 &lt;= n &lt; 100</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"交换前~="</span>, intArr)</span><br><span class="line">	<span class="comment">//反转打印,交换的次数是 len / 2</span></span><br><span class="line">	temp := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>/<span class="number">2</span>; i++ &#123;</span><br><span class="line">		temp = intArr[<span class="built_in">len</span><span class="number">-1</span>-i]</span><br><span class="line">		intArr[<span class="built_in">len</span><span class="number">-1</span>-i] = intArr[i]</span><br><span class="line">		intArr[i] = temp</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"交换后~="</span>, intArr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4oql74lqpj20dw01at8q.jpg" alt="image-20220730101927926"></p>
<h2 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h2><blockquote>
<p>  先看一个需求:我们需要一个数组用于保存学生的成绩，但是学生的个数是不确定的，请问怎么办?解决方案 =&gt; 使用切片。</p>
</blockquote>
<h3 id="基本介绍-3"><a href="#基本介绍-3" class="headerlink" title="基本介绍"></a>基本介绍</h3><p>1) 切片的英文是 slice<br>2) 切片是数组的一个<code>引用</code>，因此切片是<code>引用类型</code>，在进行传递时，遵守引用传递的机制。<br>3) 切片的使用和数组类似，遍历切片、访问切片的元素和求切片长度 len(slice)都一样。<br>4) 切片的长度是可以变化的，因此切片是一个可以动态变化数组。<br>5) 切片定义的基本语法:<code>var 切片名 []类型</code></p>
<h3 id="快速入门-4"><a href="#快速入门-4" class="headerlink" title="快速入门"></a>快速入门</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> intArr [<span class="number">5</span>]<span class="keyword">int</span> = [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">66</span>, <span class="number">99</span>&#125;</span><br><span class="line">	<span class="comment">//声明一个切片</span></span><br><span class="line">	<span class="comment">//slice := intArr[1:3]</span></span><br><span class="line">	<span class="comment">//1.slice就是切片名</span></span><br><span class="line">	<span class="comment">//2.intArr[1:3] 表示 slice 引用到intArr这个数组</span></span><br><span class="line">	<span class="comment">//3.引用intArr数组的起始下标为1,最后的下标为3</span></span><br><span class="line">	slice := intArr[<span class="number">1</span>:<span class="number">3</span>]</span><br><span class="line">	fmt.Println(<span class="string">"intArr"</span>, intArr)</span><br><span class="line">	fmt.Println(<span class="string">"slice 的元素是:"</span>, slice)</span><br><span class="line">	fmt.Println(<span class="string">"slice的元素个数="</span>, <span class="built_in">len</span>(slice))</span><br><span class="line">	fmt.Println(<span class="string">"slice 的容量="</span>, <span class="built_in">cap</span>(slice)) <span class="comment">//切片的容量可以动态变化,根据目前切片的大小自动分配调整</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4oszxis4kj20ea01zwej.jpg" alt="image-20220730114248953"></p>
<h3 id="切片在内存中形式-重要"><a href="#切片在内存中形式-重要" class="headerlink" title="切片在内存中形式(重要)"></a>切片在内存中形式(重要)</h3><blockquote>
<p>  为了让大家更加深入的理解切片，我们画图分析一下切片在内存中是如何布局的，这个是一个非常重要的知识点:(以前面的案例来分析)</p>
</blockquote>
<ul>
<li>画出前面的切片内存布局</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ow03tlluj20hd06rdg1.jpg" alt="image-20220730132646416"></p>
<p>总结:</p>
<ol>
<li>slice 是一个<code>引用类型</code>,改变切片中的内容,对应的数组内容也会发生改变,因为指向的是同一个地址</li>
<li>slice 从底层来说，其实就是一个数据结构(struct 结构体) </li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> slice <span class="keyword">struct</span> &#123;</span><br><span class="line">	ptr *[<span class="number">2</span>]<span class="keyword">int</span> </span><br><span class="line">    <span class="built_in">len</span> <span class="keyword">int</span> </span><br><span class="line">    <span class="built_in">cap</span> <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果更改切片的内容,对应的数组内容也会发生改变,因为指向的是同一个地址</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> intArr [<span class="number">5</span>]<span class="keyword">int</span> = [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">66</span>, <span class="number">99</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//更改前</span></span><br><span class="line">	slice := intArr[<span class="number">1</span>:<span class="number">3</span>]</span><br><span class="line">	fmt.Println(<span class="string">"更改前的intArr="</span>, intArr)</span><br><span class="line">	fmt.Println(<span class="string">"更改后的slice="</span>, slice)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//更改后</span></span><br><span class="line">	slice[<span class="number">1</span>] = <span class="number">100</span> <span class="comment">//将切片的第一个元素的值改为 100</span></span><br><span class="line">	fmt.Println(<span class="string">"更改后的intArr="</span>, intArr)</span><br><span class="line">	fmt.Println(<span class="string">"更改后的slice="</span>, slice)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ow8rinzhj20e801zglp.jpg" alt="image-20220730133506159"></p>
<h3 id="切片的使用"><a href="#切片的使用" class="headerlink" title="切片的使用"></a>切片的使用</h3><h4 id="方式一-1"><a href="#方式一-1" class="headerlink" title="方式一"></a>方式一</h4><blockquote>
<p>  第一种方式:定义一个切片，然后让切片去引用一个已经创建好的数组，比如前面的案例就是这样的。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> intArr [<span class="number">5</span>]<span class="keyword">int</span> = [...]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">66</span>, <span class="number">99</span>&#125;		<span class="comment">//创建数组</span></span><br><span class="line">slice := intArr[<span class="number">1</span>:<span class="number">3</span>]	<span class="comment">//切片引用</span></span><br></pre></td></tr></table></figure>

<h4 id="方式二-1"><a href="#方式二-1" class="headerlink" title="方式二"></a>方式二</h4><blockquote>
<p>  通过 make 来创建切片.<br>  基本语法: <code>var 切片名 []type = make([]type, len, [cap])</code></p>
</blockquote>
<p>参数说明: </p>
<ul>
<li><strong>type:</strong> 就是==数据类型==</li>
<li><strong>len :</strong> 大小 </li>
<li>*<em>cap : *</em>指定切片容量(可选， 如果你分配了 cap,则要求 cap&gt;=len)</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> slice []<span class="keyword">float64</span> = <span class="built_in">make</span>([]<span class="keyword">float64</span>, <span class="number">5</span>, <span class="number">10</span>)</span><br><span class="line">	slice[<span class="number">1</span>] = <span class="number">10</span></span><br><span class="line">	slice[<span class="number">2</span>] = <span class="number">20</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(slice)</span><br><span class="line">	fmt.Println(<span class="string">"slice的size="</span>, <span class="built_in">len</span>(slice))</span><br><span class="line">	fmt.Println(<span class="string">"slice的cap="</span>, <span class="built_in">cap</span>(slice))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4owogomnyj20dy01ndfu.jpg" alt="image-20220730135011354"></p>
<p>小结:</p>
<p>1) 通过 make 方式创建切片可以指定切片的大小和容量<br>2) 如果没有给切片的各个元素赋值，那么就会使用默认值[int , float=&gt; 0, string =&gt;””,  bool =&gt;false]<br>3) 通过 make 方式创建的切片对应的数组是由 make 底层维护，对外不可见，即只能通过 slice 去访问各个元素.</p>
<h4 id="方式三"><a href="#方式三" class="headerlink" title="方式三"></a>方式三</h4><blockquote>
<p>  定义一个切片，直接就指定具体数组，使用原理类似 make 的方式</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">var</span> strSlice []<span class="keyword">string</span> = []<span class="keyword">string</span>&#123;<span class="string">"tom"</span>, <span class="string">"jack"</span>, <span class="string">"mary"</span>&#125;</span><br><span class="line">	fmt.Println(<span class="string">"strSlice="</span>, strSlice)</span><br><span class="line">	fmt.Println(<span class="string">"strSlice size="</span>, <span class="built_in">len</span>(strSlice))</span><br><span class="line">	fmt.Println(<span class="string">"strSlice cap="</span>, <span class="built_in">cap</span>(strSlice))</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4owztdc16j209801fjr8.jpg" alt="image-20220730140105588"></p>
<h4 id="方式一与方式二的区别"><a href="#方式一与方式二的区别" class="headerlink" title="方式一与方式二的区别"></a>方式一与方式二的区别</h4><p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4ox0qqx6aj20jj06ywev.jpg" alt="image-20220730140158207"></p>
<h3 id="切片的遍历"><a href="#切片的遍历" class="headerlink" title="切片的遍历"></a>切片的遍历</h3><p>切片的遍历和数组一样，也有两种方式:</p>
<ul>
<li>for 循环常规方式遍历</li>
<li>for-range 结构遍历切片</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> arr [<span class="number">5</span>]<span class="keyword">int</span> = [...]<span class="keyword">int</span>&#123;<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>, <span class="number">40</span>, <span class="number">50</span>&#125;</span><br><span class="line">	slice := arr[<span class="number">1</span>:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">	<span class="comment">//常规遍历</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(slice); i++ &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"slice[%v]=%v \n"</span>, i, slice[i])</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//for-range遍历</span></span><br><span class="line">	<span class="keyword">for</span> i, v := <span class="keyword">range</span> slice &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"i=%v, v=%v \n"</span>, i, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4oyfp9xbbj20dy02tt8r.jpg" alt="image-20220730145058698"></p>
<h3 id="切片的注意事项和细节"><a href="#切片的注意事项和细节" class="headerlink" title="切片的注意事项和细节"></a>切片的注意事项和细节</h3><p>1) 切片初始化时 var slice = arr[startIndex:endIndex]<br>    说明:从 arr 数组下标为 startIndex，取到 下标为 endIndex 的元素(不含 arr[endIndex])。<br>2) 切片初始化时，仍然不能越界。范围在 [0-len(arr)] 之间，但是可以动态增长.</p>
<ul>
<li>var slice = arr[0:end] 可以简写 var slice = arr[:end]</li>
<li>var slice = arr[start:len(arr)] 可以简写: var slice = arr[start:]</li>
<li>var slice = arr[0:len(arr)] 可以简写: var slice = arr[:]</li>
</ul>
<ol start="3">
<li><p>cap是一个内置函数，用于统计切片的容量，即最大可以存放多少个元素。</p>
</li>
<li><p>切片定义完后，还不能使用，因为本身是一个空的，需要让其引用到一个数组，或者 make 一个空间供切片来使用</p>
</li>
<li><p>切片可以继续切片</p>
</li>
<li><p>用 append 内置函数，可以对切片进行动态追加</p>
</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> slice []<span class="keyword">int</span> = []<span class="keyword">int</span>&#123;<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>&#125;</span><br><span class="line">	<span class="comment">//通过append直接给slice追加具体的元素</span></span><br><span class="line">	slice = <span class="built_in">append</span>(slice, <span class="number">400</span>, <span class="number">500</span>, <span class="number">600</span>)</span><br><span class="line">	fmt.Println(<span class="string">"slice="</span>, slice)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//通过append将切片slice追加给slice,没错,我追加我自己</span></span><br><span class="line">	slice = <span class="built_in">append</span>(slice, slice...)</span><br><span class="line">	fmt.Println(<span class="string">"slice="</span>, slice)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4oz7l3zk6j20e60163yk.jpg" alt="image-20220730151746567"></p>
<ol start="7">
<li>切片的拷贝操作</li>
</ol>
<blockquote>
<p>  切片使用 copy 内置函数完成 拷贝，举例说明</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> slice []<span class="keyword">int</span> = []<span class="keyword">int</span>&#123;<span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>&#125;</span><br><span class="line">	<span class="keyword">var</span> sliceCopy = <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">10</span>)</span><br><span class="line">	<span class="built_in">copy</span>(sliceCopy, slice)</span><br><span class="line">	fmt.Println(<span class="string">"sliceCopy="</span>, sliceCopy)</span><br><span class="line">	fmt.Println(<span class="string">"slice="</span>, slice)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ozgejsn8j20e50193yj.jpg" alt="image-20220730152614994"></p>
<ol start="8">
<li>切片是引用类型，所以在传递时，遵守引用传递机制。看两段代码，并分析底层原理</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ozi5x1szj20ja06ut9c.jpg" alt="image-20220730152755854"></p>
<h3 id="string-和-slice"><a href="#string-和-slice" class="headerlink" title="string 和 slice"></a>string 和 slice</h3><ul>
<li><code>string</code>底层是一个<code>byte数组</code>，因此<code>string</code>也可以进行切片处理案例演示:</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//string底层是一个byte数组,因此string也可以进行切片处理</span></span><br><span class="line">	str := <span class="string">"hello@atguigu"</span></span><br><span class="line">	<span class="comment">//使用切片获取到 atguigu</span></span><br><span class="line">	slice := str[<span class="number">6</span>:]</span><br><span class="line">	fmt.Println(<span class="string">"slice="</span>, slice)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ozs1m4q5j20e600tdfs.jpg" alt="image-20220730153726089"></p>
<ul>
<li>string 和切片在内存的形式，以 “abcd” 画出内存示意图</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4oztlt8gvj20dj06et8p.jpg" alt="image-20220730153855974"></p>
<ul>
<li>string 是<code>不可变</code>的，也就说不能通过 <code>str[0] = &#39;z&#39;</code> 方式来修改字符串</li>
<li>如果需要修改字符串，可以先将 <code>string</code> -&gt; <code>[]byte</code> / 或者 <code>[]rune</code> -&gt; 修改 -&gt; 重写转成 string</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//string底层是一个byte数组,因此string也可以进行切片处理</span></span><br><span class="line">	str := <span class="string">"hello@atguigu"</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//字符串不能直接修改</span></span><br><span class="line">	arr1 := []<span class="keyword">byte</span>(str)</span><br><span class="line">	arr1[<span class="number">0</span>] = <span class="string">'z'</span></span><br><span class="line">	str = <span class="keyword">string</span>(arr1)</span><br><span class="line">	fmt.Println(<span class="string">"str="</span>, str)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//上面的写法不能赋值中文</span></span><br><span class="line">	<span class="comment">//下面的可以</span></span><br><span class="line">	arr2 := []<span class="keyword">rune</span>(str)</span><br><span class="line">	arr2[<span class="number">0</span>] = <span class="string">'北'</span></span><br><span class="line">	str = <span class="keyword">string</span>(arr2)</span><br><span class="line">	fmt.Println(<span class="string">"str="</span>, str)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="排序和查找"><a href="#排序和查找" class="headerlink" title="排序和查找"></a>排序和查找</h1><h2 id="冒泡排序"><a href="#冒泡排序" class="headerlink" title="冒泡排序"></a>冒泡排序</h2><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4p21fpg10j20m10a7js6.jpg" alt="image-20220730165539742"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BubbleSort</span><span class="params">(arr *[5]<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"排序前arr="</span>, (*arr))</span><br><span class="line">	temp := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//冒泡排序</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(*arr)<span class="number">-1</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="built_in">len</span>(*arr)<span class="number">-1</span>-i; j++ &#123;</span><br><span class="line">			<span class="keyword">if</span> (*arr)[j] &gt; (*arr)[j+<span class="number">1</span>] &#123;</span><br><span class="line">				temp = (*arr)[j]</span><br><span class="line">				(*arr)[j] = (*arr)[j+<span class="number">1</span>]</span><br><span class="line">				(*arr)[j+<span class="number">1</span>] = temp</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"排序后arr="</span>, *arr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//定义数组</span></span><br><span class="line">	arr := [<span class="number">5</span>]<span class="keyword">int</span>&#123;<span class="number">24</span>, <span class="number">69</span>, <span class="number">80</span>, <span class="number">57</span>, <span class="number">13</span>&#125;</span><br><span class="line">	<span class="comment">//将数组传递给一个函数,完成排序</span></span><br><span class="line">	BubbleSort(&amp;arr)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"main arr="</span>, arr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4sa4sfnh3j20dl01lmx6.jpg" alt="image-20220802115219645"></p>
<h2 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h2><h3 id="顺序查找"><a href="#顺序查找" class="headerlink" title="顺序查找"></a>顺序查找</h3><ul>
<li>案例</li>
</ul>
<blockquote>
<p>  有一个数列:白眉鹰王、金毛狮王、紫衫龙王、青翼蝠王</p>
<p>   猜数游戏:从键盘中任意输入一个名称，判断数列中是否包含此名称【顺序查找】</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 有一个数列:白眉鹰王、金毛狮王、紫衫龙王、青翼蝠王</span></span><br><span class="line">	<span class="comment">// 猜数游戏:从键盘中任意输入一个名称，判断数列中是否包含此名称【顺序查找】</span></span><br><span class="line"></span><br><span class="line">	names := [<span class="number">4</span>]<span class="keyword">string</span>&#123;<span class="string">"白眉鹰王"</span>, <span class="string">"金毛狮王"</span>, <span class="string">"紫衫龙王"</span>, <span class="string">"青翼蝠王"</span>&#125;</span><br><span class="line">	<span class="keyword">var</span> heroName = <span class="string">""</span></span><br><span class="line">	fmt.Println(<span class="string">"请输入要查找的人名: "</span>)</span><br><span class="line">	fmt.Scanln(&amp;heroName)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//顺序查找: 方式一</span></span><br><span class="line">	<span class="comment">// for i := 0; i &lt; len(names); i++ &#123;</span></span><br><span class="line">	<span class="comment">// 	if heroName == names[i] &#123;</span></span><br><span class="line">	<span class="comment">// 		fmt.Printf("找到%v, 下标为%v \n", heroName, i)</span></span><br><span class="line">	<span class="comment">// 		break</span></span><br><span class="line">	<span class="comment">// 	&#125; else if i == (len(names) - 1) &#123;</span></span><br><span class="line">	<span class="comment">// 		fmt.Printf("没有找到%v \n", heroName)</span></span><br><span class="line">	<span class="comment">// 	&#125;</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//顺序查找: 方式二(推荐)</span></span><br><span class="line">	index := <span class="number">-1</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(names); i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> heroName == names[i] &#123;</span><br><span class="line">			index = i <span class="comment">//将找到的值对应的下标赋给 index</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> index != <span class="number">-1</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"找到%v, 下标%v \n"</span>, heroName, index)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"没有找到"</span>, heroName)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4sgnuzq8wj20cw01n0sq.jpg" alt="image-20220802153817660"></p>
<h3 id="二分查找"><a href="#二分查找" class="headerlink" title="二分查找"></a>二分查找</h3><blockquote>
<p>  二分查找就是查找每次将值与中位数进行对比,不断进行判断缩小范围</p>
</blockquote>
<ul>
<li>思路分析</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4sgrxngu9j20jv0d0t9o.jpg" alt="image-20220802154212526"></p>
<ul>
<li>代码实现</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">BinaryFind</span><span class="params">(arr *[7]<span class="keyword">int</span>, leftIndex <span class="keyword">int</span>, rightIndex <span class="keyword">int</span>, findVal <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="comment">// 判断 leftIndex 是否大于 rightIndex</span></span><br><span class="line">	<span class="keyword">if</span> leftIndex &gt; rightIndex &#123;</span><br><span class="line">		fmt.Println(<span class="string">"找不到"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 先找到中间的下标</span></span><br><span class="line">	middle := (leftIndex + rightIndex) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (*arr)[middle] &gt; findVal &#123;</span><br><span class="line">		<span class="comment">// 说明我们要查找的数,应该在 leftIndex - middle-1</span></span><br><span class="line">		BinaryFind(arr, leftIndex, middle<span class="number">-1</span>, findVal)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> (*arr)[middle] &lt; findVal &#123;</span><br><span class="line">		<span class="comment">// 说明我们要查找的数,应该在 middle+1 - rightIndex</span></span><br><span class="line">		BinaryFind(arr, middle+<span class="number">1</span>, rightIndex, findVal)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">// 找到了</span></span><br><span class="line">		fmt.Printf(<span class="string">"找到了,下标为%v\n"</span>, middle)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	arr := [<span class="number">7</span>]<span class="keyword">int</span>&#123;<span class="number">1</span>, <span class="number">8</span>, <span class="number">15</span>, <span class="number">39</span>, <span class="number">128</span>, <span class="number">333</span>, <span class="number">1111</span>&#125;</span><br><span class="line">	<span class="comment">//BinaryFind(&amp;arr, 0, len(arr)-1, 39)</span></span><br><span class="line">    BinaryFind(&amp;arr, <span class="number">0</span>, <span class="built_in">len</span>(arr)<span class="number">-1</span>, <span class="number">1112</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4shr3kw8yj20d501mdfx.jpg" alt="image-20220802161600143"></p>
<h1 id="二维数组"><a href="#二维数组" class="headerlink" title="二维数组"></a>二维数组</h1><h2 id="快速入门-5"><a href="#快速入门-5" class="headerlink" title="快速入门"></a>快速入门</h2><ul>
<li>案例</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4shwpu4syj207v04o0sm.jpg" alt="image-20220802162123996"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 声明二维数组</span></span><br><span class="line">	<span class="keyword">var</span> arr [<span class="number">4</span>][<span class="number">6</span>]<span class="keyword">int</span></span><br><span class="line">	<span class="comment">//赋初值</span></span><br><span class="line">	arr[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">	arr[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">	arr[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="number">6</span>; j++ &#123;</span><br><span class="line">			fmt.Print(arr[i][j], <span class="string">" "</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4si23oa8dj20c00203yh.jpg" alt="image-20220802162634448"></p>
<h2 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h2><ul>
<li>方式一: 先声明再赋值</li>
</ul>
<p><strong>语法:</strong> <code>var 数组名 [大小][大小]类型</code></p>
<p><strong>比如:</strong>  <code>var arr [2][3]int</code> ， 再赋值。</p>
<p><strong>使用演示</strong></p>
<p>二维数组在内存的存在形式(重点)</p>
<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4si9der36j20kc072q39.jpg" alt="image-20220802163333574" style="zoom:150%;">

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//详细的解释一下上面的图片</span></span><br><span class="line"><span class="comment">//比如arr2[2]</span></span><br><span class="line"><span class="comment">//因为是arr2[2],所以就会在一个区域内划分出两个指针</span></span><br><span class="line"><span class="comment">//这两个指针分别对应第一行和第二行</span></span><br><span class="line"><span class="comment">//也就是说,arr2[0]的起始地址 = arr2[0][0]</span></span><br><span class="line"><span class="comment">//arr2[1]的起始地址 = arr2[1][0]</span></span><br><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 声明二维数组</span></span><br><span class="line">	<span class="keyword">var</span> arr [<span class="number">4</span>][<span class="number">6</span>]<span class="keyword">int</span></span><br><span class="line">	<span class="comment">//赋初值</span></span><br><span class="line">	arr[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span></span><br><span class="line">	arr[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">	arr[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="number">6</span>; j++ &#123;</span><br><span class="line">			fmt.Print(arr[i][j], <span class="string">" "</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> arr2 [<span class="number">2</span>][<span class="number">3</span>]<span class="keyword">int</span></span><br><span class="line">	fmt.Println(arr2)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"arr2[0]的地址%p\n"</span>, &amp;arr2[<span class="number">0</span>])</span><br><span class="line">	fmt.Printf(<span class="string">"arr[1]的地址%p\n"</span>, &amp;arr2[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"arr2[0][0]的地址%p\n"</span>, &amp;arr2[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">	fmt.Printf(<span class="string">"arr2[1][0]的地址%p\n"</span>, &amp;arr2[<span class="number">1</span>][<span class="number">0</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4sk2c5bnhj20br03zgls.jpg" alt="image-20220802173559774" style="zoom:150%;">

<p>从上图可以看出,<code>arr2[0]</code>与<code>arr2[1]</code>两个地址相差了<code>24</code>个字节(底层都是使用16进制,满16进一位,150+24=168)</p>
<p>而且<code>arr2[0]</code>与<code>arr2[0][0]</code>的地址是相同的</p>
<ul>
<li>方式二: 直接初始化</li>
</ul>
<p><strong>声明:</strong> </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 数组名 [大小][大小]类型 = [大小][大小]类型&#123;&#123;初值..&#125;,&#123;初值..&#125;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>赋值</strong>(有默认值，比如 int 类型的就是 0)</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr3 [<span class="number">2</span>][<span class="number">3</span>]<span class="keyword">int</span> = [<span class="number">2</span>][<span class="number">3</span>]<span class="keyword">int</span>&#123;&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;&#125;</span><br><span class="line">fmt.Println(<span class="string">"arr3="</span>, arr3)</span><br></pre></td></tr></table></figure>

<p><strong>说明:</strong></p>
<p>二维数组在声明时也对应有四种写法[和一维数组类似]</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> 数组名 大小类型 = 大小类型&#123;&#123;初值..&#125;,&#123;初值..&#125;&#125; </span><br><span class="line"><span class="keyword">var</span> 数组名 大小类型 = ...类型&#123;&#123;初值..&#125;,&#123;初值..&#125;&#125; </span><br><span class="line"><span class="keyword">var</span> 数组名 = 大小类型&#123;&#123;初值..&#125;,&#123;初值..&#125;&#125;</span><br><span class="line"><span class="keyword">var</span> 数组名 = ...类型&#123;&#123;初值..&#125;,&#123;初值..&#125;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="二维数组的遍历"><a href="#二维数组的遍历" class="headerlink" title="二维数组的遍历"></a>二维数组的遍历</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> arr = [<span class="number">2</span>][<span class="number">3</span>]<span class="keyword">int</span>&#123;&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>&#125;, &#123;<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//普通遍历</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(arr); i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">0</span>; j &lt; <span class="built_in">len</span>(arr[i]); j++ &#123;</span><br><span class="line">			fmt.Printf(<span class="string">"%v\t"</span>, arr[i][j])</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//for-range遍历二维数组</span></span><br><span class="line">	<span class="keyword">for</span> i, v := <span class="keyword">range</span> arr &#123;</span><br><span class="line">		<span class="keyword">for</span> j, v2 := <span class="keyword">range</span> v &#123;</span><br><span class="line">			fmt.Printf(<span class="string">"arr[%v][%v]=%v \t"</span>, i, j, v2)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4tlsomqqkj20c601yt8q.jpg" alt="image-20220803152126615"></p>
<h1 id="map"><a href="#map" class="headerlink" title="map"></a>map</h1><blockquote>
<p>  map 是 key-value 数据结构，又称为字段或者关联数组。类似其它编程语言的集合，在编程中是经常使用到。</p>
</blockquote>
<h2 id="map的声明"><a href="#map的声明" class="headerlink" title="map的声明"></a>map的声明</h2><h3 id="基本语法-1"><a href="#基本语法-1" class="headerlink" title="基本语法"></a>基本语法</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="keyword">map</span> 变量名 <span class="keyword">map</span>[keytype]valuetype</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>key</code> 可以是什么类型</p>
<p>golang 中的 map，的 key 可以是很多种类型，比如 bool, 数字，string, 指针, channel , 还可以是只 包含前面几个类型的接口, 结构体, 数组</p>
<p>通常 ==key== 为 <code>int</code> 、<code>string</code></p>
<p><strong>注意:</strong> slice, map 还有 function 不可以，因为这几个没法用 == 来判断</p>
</li>
<li><p><code>valuetype</code> 可以是什么类型</p>
<p>valuetype 的类型和 key 基本一样，这里我就不再赘述了 </p>
<p>==通常为:== <code>数字</code>(整数,浮点数), <code>string</code>, <code>map</code>, <code>struct</code></p>
</li>
</ul>
<h3 id="map-声明的举例"><a href="#map-声明的举例" class="headerlink" title="map 声明的举例"></a>map 声明的举例</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span></span><br><span class="line"><span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span></span><br><span class="line"><span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>  <strong>注意:</strong> 声明是不会分配内存的，初始化需要 make ，分配内存后才能赋值和使用。</p>
</blockquote>
<h3 id="案例演示-1"><a href="#案例演示-1" class="headerlink" title="案例演示"></a>案例演示</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line">	<span class="comment">//在使用map前,需要先make,make的作用就是给map分配数据空间</span></span><br><span class="line">	a = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">10</span>)</span><br><span class="line">	a[<span class="string">"no1"</span>] = <span class="string">"宋江"</span></span><br><span class="line">	a[<span class="string">"no2"</span>] = <span class="string">"吴用"</span></span><br><span class="line">	a[<span class="string">"no1"</span>] = <span class="string">"武松"</span></span><br><span class="line">	a[<span class="string">"no3"</span>] = <span class="string">"吴用"</span></span><br><span class="line">	fmt.Println(a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>对上面代码的说明:</strong></p>
<p>1) map在使用前一定要make<br>2) map的key是不能重复，如果重复了，则以最后这个key-value为准<br>3) map的value是可以相同的.<br>4) map 的 key-value 是无序<br>5) make内置函数数目</p>
<h2 id="map的使用"><a href="#map的使用" class="headerlink" title="map的使用"></a>map的使用</h2><ul>
<li>方式一</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一种方式</span></span><br><span class="line"><span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line">a = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">10</span>)</span><br><span class="line">a[<span class="string">"no1"</span>] = <span class="string">"宋江"</span></span><br><span class="line">a[<span class="string">"no2"</span>] = <span class="string">"吴用"</span></span><br><span class="line">a[<span class="string">"no1"</span>] = <span class="string">"武松"</span></span><br><span class="line">a[<span class="string">"no3"</span>] = <span class="string">"吴用"</span></span><br><span class="line">fmt.Println(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">//返回结果</span></span><br><span class="line"><span class="keyword">map</span>[no1:武松 no2:吴用 no3:吴用]</span><br></pre></td></tr></table></figure>

<ul>
<li>方式二</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第二种方式</span></span><br><span class="line">cities := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">cities[<span class="string">"no1"</span>] = <span class="string">"北京"</span></span><br><span class="line">cities[<span class="string">"no2"</span>] = <span class="string">"天津"</span></span><br><span class="line">cities[<span class="string">"no3"</span>] = <span class="string">"上海"</span></span><br><span class="line">fmt.Println(cities)</span><br><span class="line"></span><br><span class="line"><span class="comment">//返回结果</span></span><br><span class="line"><span class="keyword">map</span>[no1:北京 no2:天津 no3:上海]</span><br></pre></td></tr></table></figure>

<ul>
<li>方式三</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第三种方式</span></span><br><span class="line">heroes := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">    <span class="string">"hero1"</span>: <span class="string">"宋江"</span>,</span><br><span class="line">    <span class="string">"hero2"</span>: <span class="string">"卢俊义"</span>,</span><br><span class="line">    <span class="string">"hero3"</span>: <span class="string">"吴用"</span>,</span><br><span class="line">&#125;</span><br><span class="line">heroes[<span class="string">"heros"</span>] = <span class="string">"林冲"</span></span><br><span class="line">fmt.Println(<span class="string">"heroes="</span>, heroes)</span><br><span class="line"></span><br><span class="line"><span class="comment">//返回结果</span></span><br><span class="line">heroes= <span class="keyword">map</span>[hero1:宋江 hero2:卢俊义 hero3:吴用 heros:林冲]</span><br></pre></td></tr></table></figure>

<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><blockquote>
<p>   演示一个 key-value 的 value 是 map 的案例 </p>
<p>  比如:我们要存放 3 个学生信息, 每个学生有 name 和 sex 信息 </p>
<p>  思路: map[string]map[string]string</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	studentMap := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line"></span><br><span class="line">	studentMap[<span class="string">"stu01"</span>] = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">3</span>)</span><br><span class="line">	studentMap[<span class="string">"stu01"</span>][<span class="string">"name"</span>] = <span class="string">"tom"</span></span><br><span class="line">	studentMap[<span class="string">"stu01"</span>][<span class="string">"sex"</span>] = <span class="string">"男"</span></span><br><span class="line">	studentMap[<span class="string">"stu01"</span>][<span class="string">"address"</span>] = <span class="string">"北京长安街~"</span></span><br><span class="line"></span><br><span class="line">	studentMap[<span class="string">"stu02"</span>] = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">3</span>)</span><br><span class="line">	studentMap[<span class="string">"stu02"</span>][<span class="string">"name"</span>] = <span class="string">"mary"</span></span><br><span class="line">	studentMap[<span class="string">"stu02"</span>][<span class="string">"sex"</span>] = <span class="string">"女"</span></span><br><span class="line">	studentMap[<span class="string">"stu02"</span>][<span class="string">"address"</span>] = <span class="string">"上海黄浦江~"</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(studentMap)</span><br><span class="line">	fmt.Println(studentMap[<span class="string">"stu02"</span>])</span><br><span class="line">	fmt.Println(studentMap[<span class="string">"stu02"</span>][<span class="string">"address"</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="map的增删改查"><a href="#map的增删改查" class="headerlink" title="map的增删改查"></a>map的增删改查</h2><h3 id="map的增加和更新"><a href="#map的增加和更新" class="headerlink" title="map的增加和更新"></a>map的增加和更新</h3><blockquote>
<p>   map增加和更新:<br>  map[“key”] = value //如果 key 还没有，就是增加，如果 key 存在就是修改。</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	cities := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">	cities[<span class="string">"no1"</span>] = <span class="string">"北京"</span></span><br><span class="line">	cities[<span class="string">"no2"</span>] = <span class="string">"天津"</span></span><br><span class="line">	cities[<span class="string">"no3"</span>] = <span class="string">"上海"</span></span><br><span class="line">	fmt.Println(cities)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//因为 no3 这个key已经存在,因此下面的这句话就是修改</span></span><br><span class="line">	cities[<span class="string">"no3"</span>] = <span class="string">"上海~"</span></span><br><span class="line">	fmt.Println(cities)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ukacar4aj20bq014glk.jpg" alt="image-20220804111447689"></p>
<h3 id="map的删除"><a href="#map的删除" class="headerlink" title="map的删除"></a>map的删除</h3><blockquote>
<p>  <strong>说明:</strong><br>  delete(map，”key”) ，delete 是一个内置函数，如果 key 存在，就删除该 key-value,如果 key 不存在， 不操作，但是也不会报错</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	cities := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">	cities[<span class="string">"no1"</span>] = <span class="string">"北京"</span></span><br><span class="line">	cities[<span class="string">"no2"</span>] = <span class="string">"天津"</span></span><br><span class="line">	cities[<span class="string">"no3"</span>] = <span class="string">"上海"</span></span><br><span class="line">	fmt.Println(cities)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//因为 no3 这个key已经存在,因此下面的这句话就是修改</span></span><br><span class="line">	cities[<span class="string">"no3"</span>] = <span class="string">"上海~"</span></span><br><span class="line">	fmt.Println(cities)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//演示删除</span></span><br><span class="line">	<span class="built_in">delete</span>(cities, <span class="string">"no1"</span>)</span><br><span class="line">	fmt.Println(cities)</span><br><span class="line">	<span class="comment">//当delete指定的key不存在时,删除不会操作,也不会报错</span></span><br><span class="line">	<span class="built_in">delete</span>(cities, <span class="string">"no4"</span>)</span><br><span class="line">	fmt.Println(cities)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4up3imfhlj20bm021dfw.jpg" alt="image-20220804140113501"></p>
<blockquote>
<p>  细节说明</p>
<p>  如果我们要删除 map 的所有 key ,没有一个专门的方法一次删除，可以<code>遍历</code>一下 key, 逐个删除</p>
<p>  或者 <code>map = make(...)</code>，make 一个新的，让原来的成为==垃圾==，被 <code>gc</code> 回收</p>
</blockquote>
<ul>
<li>方式一: 遍历删除</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> k, _ := <span class="keyword">range</span> caties &#123;</span><br><span class="line">    <span class="built_in">delete</span>(cities, k)   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>方式二: 重新make暴力删除</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cities = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">fmt.Println(cities)</span><br></pre></td></tr></table></figure>

<h3 id="map的查找"><a href="#map的查找" class="headerlink" title="map的查找"></a>map的查找</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	cities := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">	cities[<span class="string">"no1"</span>] = <span class="string">"北京"</span></span><br><span class="line">	cities[<span class="string">"no2"</span>] = <span class="string">"天津"</span></span><br><span class="line">	cities[<span class="string">"no3"</span>] = <span class="string">"上海"</span></span><br><span class="line">	fmt.Println(cities)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//因为 no3 这个key已经存在,因此下面的这句话就是修改</span></span><br><span class="line">	cities[<span class="string">"no3"</span>] = <span class="string">"上海~"</span></span><br><span class="line">	fmt.Println(cities)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//演示删除</span></span><br><span class="line">	<span class="built_in">delete</span>(cities, <span class="string">"no1"</span>)</span><br><span class="line">	fmt.Println(cities)</span><br><span class="line">	<span class="comment">//当delete指定的key不存在时,删除不会操作,也不会报错</span></span><br><span class="line">	<span class="built_in">delete</span>(cities, <span class="string">"no4"</span>)</span><br><span class="line">	fmt.Println(cities)</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//演示map的查找</span></span><br><span class="line">	val, ok := cities[<span class="string">"no1"</span>]</span><br><span class="line">	<span class="keyword">if</span> ok &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"有no1 key 值为%v\n"</span>, val)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"没有no1 key\n"</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cities = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">	fmt.Println(cities)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4uq5rpeezj20cn02sglp.jpg" alt="image-20220804143801687"></p>
<h2 id="map的遍历"><a href="#map的遍历" class="headerlink" title="map的遍历"></a>map的遍历</h2><blockquote>
<p>  案例演示相对复杂的 map 遍历:该 map 的 value 又是一个 map</p>
<p>  说明:map 的遍历使用 for-range 的结构遍历</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	cities := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">	cities[<span class="string">"no1"</span>] = <span class="string">"北京"</span></span><br><span class="line">	cities[<span class="string">"no2"</span>] = <span class="string">"天津"</span></span><br><span class="line">	cities[<span class="string">"no3"</span>] = <span class="string">"上海"</span></span><br><span class="line">	fmt.Println(cities)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> k, v := <span class="keyword">range</span> cities &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"k=%v v=%v\n"</span>, k, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ur5wbajsj20ce021dft.jpg" alt="image-20220804151245088"></p>
<p>遍历一个复杂的结构</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	studentMap := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line"></span><br><span class="line">	studentMap[<span class="string">"stu01"</span>] = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">3</span>)</span><br><span class="line">	studentMap[<span class="string">"stu01"</span>][<span class="string">"name"</span>] = <span class="string">"tom"</span></span><br><span class="line">	studentMap[<span class="string">"stu01"</span>][<span class="string">"sex"</span>] = <span class="string">"男"</span></span><br><span class="line">	studentMap[<span class="string">"stu01"</span>][<span class="string">"address"</span>] = <span class="string">"北京长安街~"</span></span><br><span class="line"></span><br><span class="line">	studentMap[<span class="string">"stu02"</span>] = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">3</span>)</span><br><span class="line">	studentMap[<span class="string">"stu02"</span>][<span class="string">"name"</span>] = <span class="string">"mary"</span></span><br><span class="line">	studentMap[<span class="string">"stu02"</span>][<span class="string">"sex"</span>] = <span class="string">"女"</span></span><br><span class="line">	studentMap[<span class="string">"stu02"</span>][<span class="string">"address"</span>] = <span class="string">"上海黄浦江~"</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//for-range遍历一个结构复杂的map</span></span><br><span class="line">	<span class="keyword">for</span> k1, v1 := <span class="keyword">range</span> studentMap &#123;</span><br><span class="line">		fmt.Println(<span class="string">"k1="</span>, k1)</span><br><span class="line">		<span class="keyword">for</span> k2, v2 := <span class="keyword">range</span> v1 &#123;</span><br><span class="line">			fmt.Printf(<span class="string">"\t k2=%v v2=%v \n"</span>, k2, v2)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// fmt.Println(studentMap)</span></span><br><span class="line">	<span class="comment">// fmt.Println(studentMap["stu02"])</span></span><br><span class="line">	<span class="comment">// fmt.Println(studentMap["stu02"]["address"])</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4ur4vtw56j20c304474d.jpg" alt="image-20220804151146272"></p>
<h2 id="map切片"><a href="#map切片" class="headerlink" title="map切片"></a>map切片</h2><blockquote>
<p>  切片的数据类型如果是 map，则我们称为 slice of map，map 切片，这样使用则 map 个数就可以动态变化了。</p>
</blockquote>
<ul>
<li>案例</li>
</ul>
<p>要求:使用一个 map 来记录 monster 的信息 name 和 age, 也就是说一个 monster 对应一个 map,并且妖怪的个数可以动态的增加=&gt;map 切片</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//演示map切片的使用</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//1.声明一个map切片</span></span><br><span class="line">	<span class="keyword">var</span> monsters []<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line">	monsters = <span class="built_in">make</span>([]<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">2</span>)</span><br><span class="line">	<span class="comment">//2.增加一个妖怪的信息</span></span><br><span class="line">	<span class="keyword">if</span> monsters[<span class="number">0</span>] == <span class="literal">nil</span> &#123;</span><br><span class="line">		monsters[<span class="number">0</span>] = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">		monsters[<span class="number">0</span>][<span class="string">"name"</span>] = <span class="string">"牛魔王"</span></span><br><span class="line">		monsters[<span class="number">0</span>][<span class="string">"age"</span>] = <span class="string">"500"</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> monsters[<span class="number">1</span>] == <span class="literal">nil</span> &#123;</span><br><span class="line">		monsters[<span class="number">1</span>] = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">2</span>)</span><br><span class="line">		monsters[<span class="number">1</span>][<span class="string">"name"</span>] = <span class="string">"玉兔精"</span></span><br><span class="line">		monsters[<span class="number">1</span>][<span class="string">"age"</span>] = <span class="string">"400"</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//下面这个写法越界</span></span><br><span class="line">	<span class="comment">// if monsters[1] == nil &#123;</span></span><br><span class="line">	<span class="comment">// 	monsters[1] = make(map[string]string, 2)</span></span><br><span class="line">	<span class="comment">// 	monsters[1]["name"] = "狐狸精"</span></span><br><span class="line">	<span class="comment">// 	monsters[1]["age"] = "400"</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//这里我们需要使用到切片的append函数,可以动态的增加monster</span></span><br><span class="line">	<span class="comment">//1.先定义一个monster信息</span></span><br><span class="line">	newMonster := <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;</span><br><span class="line">		<span class="string">"name"</span> : <span class="string">"新妖怪-火云邪神"</span>,</span><br><span class="line">		<span class="string">"age"</span> : <span class="string">"200"</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	monsters = <span class="built_in">append</span>(monsters, newMonster)</span><br><span class="line"></span><br><span class="line">	fmt.Println(monsters)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4usgifjpqj20gs00tq2y.jpg" alt="image-20220804155733247"></p>
<h2 id="map的排序"><a href="#map的排序" class="headerlink" title="map的排序"></a>map的排序</h2><ul>
<li>golang中没有一个专门的方法针对map的key进行排序</li>
<li>golang中的map默认是无序的，注意也不是按照添加的顺序存放的，你每次遍历，得到的输出可能不一样.</li>
<li>golang中map的排序，是先将key进行排序，然后根据key值遍历输出即可</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"sort"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//map的排序</span></span><br><span class="line">	map1 := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">int</span>, <span class="number">10</span>)</span><br><span class="line">	map1[<span class="number">10</span>] = <span class="number">100</span></span><br><span class="line">	map1[<span class="number">1</span>] = <span class="number">13</span></span><br><span class="line">	map1[<span class="number">4</span>] = <span class="number">56</span></span><br><span class="line">	map1[<span class="number">8</span>] = <span class="number">90</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(map1)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果按照map的key的顺序进行排序输出</span></span><br><span class="line">	<span class="comment">//1.先将map的key放入到切片中</span></span><br><span class="line">	<span class="comment">//2.对切片排序</span></span><br><span class="line">	<span class="comment">//3.遍历切片,然后按照key来输出map的值</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> keys []<span class="keyword">int</span></span><br><span class="line">	<span class="keyword">for</span> k, _ := <span class="keyword">range</span> map1 &#123;</span><br><span class="line">		keys = <span class="built_in">append</span>(keys, k)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//排序</span></span><br><span class="line">	sort.Ints(keys)</span><br><span class="line">	fmt.Println(keys)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> _, k := <span class="keyword">range</span> keys &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"map1[%v]=%v \n"</span>, k, map1[k])</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4utaplpxnj20bj02r74a.jpg" alt="image-20220804162634091"></p>
<h2 id="map的使用细节"><a href="#map的使用细节" class="headerlink" title="map的使用细节"></a>map的使用细节</h2><ul>
<li>map是<code>引用类型</code>，遵守引用类型传递的机制，在一个函数接收map，修改后，会直接修改原来的 map</li>
<li>map 的容量达到后，再想 map 增加元素，会自动扩容，并不会发生 panic，也就是说 map 能动态的增长键值对(key-value)</li>
<li>map 的 value 也经常使用 struct 类型，更适合管理复杂的数据(比前面 value 是一个 map 更好),比如 value 为 Student 结构体</li>
</ul>
<h2 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">modifyUser</span><span class="params">(users <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, name <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//判断 users 中是否有 name //v , ok := users[name]</span></span><br><span class="line">	<span class="keyword">if</span> users[name] != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="comment">//有这个用户</span></span><br><span class="line">		users[name][<span class="string">"pwd"</span>] = <span class="string">"888888"</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">//没有这个用户</span></span><br><span class="line">		users[name] = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">2</span>)</span><br><span class="line">		users[name][<span class="string">"pwd"</span>] = <span class="string">"888888"</span></span><br><span class="line">		users[name][<span class="string">"nickname"</span>] = <span class="string">"昵称~"</span> + name <span class="comment">//示意</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	users := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">10</span>)</span><br><span class="line">	users[<span class="string">"smith"</span>] = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">2</span>)</span><br><span class="line">	users[<span class="string">"smith"</span>][<span class="string">"pwd"</span>] = <span class="string">"999999"</span></span><br><span class="line">	users[<span class="string">"smith"</span>][<span class="string">"nickname"</span>] = <span class="string">"小花猫"</span></span><br><span class="line"></span><br><span class="line">	modifyUser(users, <span class="string">"tom"</span>)</span><br><span class="line">	modifyUser(users, <span class="string">"mary"</span>)</span><br><span class="line">	modifyUser(users, <span class="string">"smith"</span>)</span><br><span class="line">	</span><br><span class="line">	fmt.Println(users)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4uu5y8o6rj20od00uaa4.jpg" alt="image-20220804165636270"></p>
<h1 id="面向对象编程"><a href="#面向对象编程" class="headerlink" title="面向对象编程"></a>面向对象编程</h1><blockquote>
<p>  激动人心的面向对象编程他来喽~</p>
</blockquote>
<h2 id="说明-1"><a href="#说明-1" class="headerlink" title="说明"></a>说明</h2><ul>
<li><p><code>Golang</code>也支持<code>面向对象编程</code>(OOP)，但是和传统的面向对象编程有区别，并不是纯粹的面向对象语言。所以我们说 Golang 支持<code>面向对象编程特性</code>是比较准确的。</p>
</li>
<li><p>Golang<strong>没有</strong><code>类</code>(class)，Go语言的结构体(struct)和其它编程语言的类(class)有同等的地位，你可以理解 Golang 是基于 <code>struct</code> 来实现 OOP 特性的。</p>
</li>
<li><p>Golang面向对象编程<code>非常简洁</code>，去掉了传统OOP语言的继承、方法重载、构造函数和析构函数、隐藏的 this 指针等等</p>
</li>
<li><p>Golang仍然有<code>面向对象编程</code>的<code>继承</code>，<code>封装</code>和<code>多态</code>的特性，只是实现的方式和其它OOP语言不一样，比如继承 :Golang 没有 extends 关键字，继承是通过匿名字段来实现。</p>
</li>
<li><p>Golang面向对象(OOP)很优雅，OOP本身就是语言类型系统(typesystem)的一部分，通过<code>接口</code>(interface)关联，耦合性低，也非常灵活。后面会充分体会到这个特点。也就是说在 Golang 中面向接口编程是非常重要的特性。</p>
</li>
</ul>
<h2 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h2><h3 id="快速入门-6"><a href="#快速入门-6" class="headerlink" title="快速入门"></a>快速入门</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义一个Cat结构体,将Cat的各个字段/属性信息,放入到Cat结构体进行管理</span></span><br><span class="line">	<span class="keyword">type</span> Cat <span class="keyword">struct</span> &#123;</span><br><span class="line">		Name  <span class="keyword">string</span></span><br><span class="line">		Age   <span class="keyword">int</span></span><br><span class="line">		Color <span class="keyword">string</span></span><br><span class="line">		Hobby <span class="keyword">string</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建一个Cat的变量</span></span><br><span class="line">	<span class="keyword">var</span> cat1 Cat</span><br><span class="line">	cat1.Name = <span class="string">"cat1"</span></span><br><span class="line">	cat1.Age = <span class="number">3</span></span><br><span class="line">	cat1.Color = <span class="string">"white"</span></span><br><span class="line">	cat1.Hobby = <span class="string">"eat"</span></span><br><span class="line">	fmt.Println(<span class="string">"cat1="</span>, cat1)</span><br><span class="line">	fmt.Println(<span class="string">"cat1的详细信息如下:"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"name="</span>, cat1.Name)</span><br><span class="line">	fmt.Println(<span class="string">"Age="</span>, cat1.Age)</span><br><span class="line">	fmt.Println(<span class="string">"Color="</span>, cat1.Color)</span><br><span class="line">	fmt.Println(<span class="string">"hobby="</span>, cat1.Hobby)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4vvmz38msj20dc02sdfw.jpg" alt="image-20220805143305506"></p>
<h3 id="结构体的声明"><a href="#结构体的声明" class="headerlink" title="结构体的声明"></a>结构体的声明</h3><blockquote>
<p>  结构体是一个<code>值类型</code>,并不是引用类型(引用类型指的是通过地址找到值),这一点需要注意</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> 结构体名称 <span class="keyword">struct</span> &#123;</span><br><span class="line">	field1 <span class="keyword">type</span></span><br><span class="line">	field2 <span class="keyword">type</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="字段-属性"><a href="#字段-属性" class="headerlink" title="字段/属性"></a>字段/属性</h3><ul>
<li>基本介绍</li>
</ul>
<p>1) 从概念或叫法上看: 结构体字段 = 属性 = field (即授课中，统一叫字段)<br>2) 字段是结构体的一个组成部分，一般是基本数据类型、数组,也可是引用类型。比如我们前面定义猫结构体的Name string 就是属性</p>
<h4 id="注意事项和细节说明"><a href="#注意事项和细节说明" class="headerlink" title="注意事项和细节说明"></a>注意事项和细节说明</h4><ol>
<li><p>字段声明语法同变量，示例:<code>字段名 字段类型</code></p>
</li>
<li><p>字段的类型可以为: <code>基本类型</code>、<code>数组</code>或<code>引用</code>类型</p>
</li>
<li><p>在创建一个结构体变量后，如果没有给字段赋值，都对应一个零值(默认值)，规则同前面讲的一样:</p>
<ul>
<li><p>布尔类型是 <code>false</code> ，数值是 <code>0</code> ，字符串是 <code>&quot;&quot;</code>。 </p>
</li>
<li><p><code>数组</code>类型的默认值和它的元素类型相关，比如 score [3]int 则为[0, 0, 0] </p>
</li>
<li><p>指针，slice，和 map 的零值都是 nil ，即还没有分配空间。</p>
</li>
</ul>
</li>
</ol>
<ul>
<li>演示案例</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name   <span class="keyword">string</span></span><br><span class="line">	Age    <span class="keyword">int</span></span><br><span class="line">	scores [<span class="number">5</span>]<span class="keyword">float64</span></span><br><span class="line">	ptr    *<span class="keyword">int</span>              <span class="comment">//指针</span></span><br><span class="line">	slice  []<span class="keyword">int</span>             <span class="comment">//切片</span></span><br><span class="line">	map1   <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span> <span class="comment">//map</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//定义结构体变量</span></span><br><span class="line">	<span class="keyword">var</span> p1 Person</span><br><span class="line">	fmt.Println(p1)</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> p1.ptr == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"ptr is nil"</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> p1.map1 == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"map1 is nil"</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> p1.slice == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"slice is nil"</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//使用slice,再次说明,一定要make</span></span><br><span class="line">	p1.slice = <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">10</span>)</span><br><span class="line">	p1.slice[<span class="number">0</span>] = <span class="number">100</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//使用map,一定要先make</span></span><br><span class="line">	p1.map1 = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">	p1.map1[<span class="string">"key1"</span>] = <span class="string">"tom~"</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(p1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4vwlszlapj20dx02dt8t.jpg" alt="image-20220805150635987"></p>
<ol start="4">
<li>不同结构体变量的字段是独立，互不影响，一个结构体变量字段的更改，不影响另外一个, 结构体是值类型。</li>
</ol>
<h3 id="创建结构体变量和访问结构体字段"><a href="#创建结构体变量和访问结构体字段" class="headerlink" title="创建结构体变量和访问结构体字段"></a>创建结构体变量和访问结构体字段</h3><ul>
<li>方式一: 直接声明</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> person Person</span><br><span class="line"><span class="comment">//上面已经演示过</span></span><br></pre></td></tr></table></figure>

<ul>
<li>方式二: { }</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p2 := Person&#123;<span class="string">"poker"</span>, <span class="string">"26"</span>&#125;</span><br><span class="line"><span class="comment">//p2.Name = "tom"</span></span><br><span class="line"><span class="comment">//p2.Age = 26</span></span><br></pre></td></tr></table></figure>

<ul>
<li>方式三: &amp;</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//var person *Person = new (Person)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p3 *Person = <span class="built_in">new</span> (Person)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">因为p3是一个指针,因此标准的给字段赋值方式</span></span><br><span class="line"><span class="comment">(*p3).Name = "smith" 也可以这样写=&gt; p3.Name = "smith"</span></span><br><span class="line"><span class="comment">原因: go的设计者,为了程序员使用方便,底层会对 p3.Name = "smith" 进行处理</span></span><br><span class="line"><span class="comment">会给 p3 加上取值运算 (*p3).Name = "smith"</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">(*p3).Name= <span class="string">"smith"</span></span><br><span class="line">p3.Name = <span class="string">"john"</span></span><br><span class="line"></span><br><span class="line">(*p3).Age = <span class="number">30</span></span><br><span class="line">p3.Age = <span class="number">100</span></span><br><span class="line">fmt.Println(*p3)</span><br></pre></td></tr></table></figure>

<ul>
<li>方式四: &amp;{ }</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//var person *Person = &amp;Person&#123;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p4 *Person = &amp;Person&#123;&#125;</span><br><span class="line">(*p4).Name = <span class="string">"scott"</span></span><br><span class="line">p4.Name = <span class="string">"scott~"</span></span><br><span class="line"></span><br><span class="line">(*p4).Age = <span class="number">88</span></span><br><span class="line">p4.Age = <span class="number">10</span></span><br><span class="line">fmt.Println(*p4)</span><br></pre></td></tr></table></figure>

<ul>
<li>说明<ul>
<li>第<code>3</code> 种和第 <code>4</code> 种方式返回的是<code>结构体指针</code>。</li>
<li>结构体指针访问字段的标准方式应该是: <code>(*结构体指针).字段名</code> ，比如 (*person).Name = “tom” </li>
<li>但 go 做了一个简化，也支持<code>结构体指针.字段名</code>, 比如 person.Name = “tom”。更加符合程序员使用的习惯，go 编译器底层对 person.Name 做了转化 (*person).Name。</li>
</ul>
</li>
</ul>
<h3 id="struct-类型的内存分配机制"><a href="#struct-类型的内存分配机制" class="headerlink" title="struct 类型的内存分配机制"></a>struct 类型的内存分配机制</h3><blockquote>
<p>  前面提到过,struct结构体的类型为值类型,当我们拷贝struct的一个实例时,会划分出一个新的地址空间存放值,所以两者不会影响</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name   <span class="keyword">string</span></span><br><span class="line">	Age    <span class="keyword">int</span></span><br><span class="line">	scores [<span class="number">5</span>]<span class="keyword">float64</span></span><br><span class="line">	ptr    *<span class="keyword">int</span>              <span class="comment">//指针</span></span><br><span class="line">	slice  []<span class="keyword">int</span>             <span class="comment">//切片</span></span><br><span class="line">	map1   <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span> <span class="comment">//map</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> p1 Person</span><br><span class="line">	p1.Name = <span class="string">"tom"</span></span><br><span class="line">	p1.Age = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//复制实例p1</span></span><br><span class="line">	<span class="keyword">var</span> p2 Person = p1</span><br><span class="line">	fmt.Println(<span class="string">"p2.Age="</span>, p2.Age)</span><br><span class="line">	fmt.Println(<span class="string">"p2.Name="</span>, p2.Name)</span><br><span class="line">    <span class="comment">//修改p2的值,观察p1的值是否会被修改</span></span><br><span class="line">	p2.Name = <span class="string">"jack"</span></span><br><span class="line">	fmt.Printf(<span class="string">"p2.Name=%v, p1.Name=%v\n"</span>, p2.Name, p1.Name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4w067o95hj20dj01ndfu.jpg" alt="image-20220805171000477"></p>
<blockquote>
<p>  从上面的结果来看,p1与p2根本毫无关联,谁修改谁都不会变化</p>
<p>  那么如何做才能产生关联呢?请看下面的代码!</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name   <span class="keyword">string</span></span><br><span class="line">	Age    <span class="keyword">int</span></span><br><span class="line">	scores [<span class="number">5</span>]<span class="keyword">float64</span></span><br><span class="line">	ptr    *<span class="keyword">int</span>              <span class="comment">//指针</span></span><br><span class="line">	slice  []<span class="keyword">int</span>             <span class="comment">//切片</span></span><br><span class="line">	map1   <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span> <span class="comment">//map</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> p1 Person</span><br><span class="line">	p1.Name = <span class="string">"tom"</span></span><br><span class="line">	p1.Age = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> p2 *Person = &amp;p1</span><br><span class="line">	fmt.Println(<span class="string">"p2.Age="</span>, (*p2).Age)</span><br><span class="line">	fmt.Println(<span class="string">"p2.Name="</span>, p2.Name)</span><br><span class="line">	p2.Name = <span class="string">"jack"</span></span><br><span class="line">	fmt.Printf(<span class="string">"p2.Name=%v, p1.Name=%v\n"</span>, p2.Name, p1.Name)</span><br><span class="line">	fmt.Printf(<span class="string">"p1的地址为%p\n"</span>, &amp;p1)</span><br><span class="line">	fmt.Printf(<span class="string">"p2的地址为%p, p2的值为%p\n"</span>, &amp;p2, p2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4w0ii52d4j20dl028wej.jpg" alt="image-20220805172148956"></p>
<p>可以看到,<code>p1.Name</code>与<code>p2.Name</code>同时发生了变化,因为两者指向了同一个内存地址</p>
<h3 id="结构体的注意事项与细节说明"><a href="#结构体的注意事项与细节说明" class="headerlink" title="结构体的注意事项与细节说明"></a>结构体的注意事项与细节说明</h3><ol>
<li>结构体的所有字段在内存中是连续的</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Point <span class="keyword">struct</span> &#123;</span><br><span class="line">	x <span class="keyword">int</span></span><br><span class="line">	y <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//矩形的左上角和右下角,两个点的坐标</span></span><br><span class="line"><span class="keyword">type</span> Rect <span class="keyword">struct</span> &#123;</span><br><span class="line">	leftUp, rightDown Point</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Rect2 <span class="keyword">struct</span> &#123;</span><br><span class="line">	leftUp, rightDown *Point</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r1 := Rect&#123;Point&#123;<span class="number">1</span>, <span class="number">2</span>&#125;, Point&#123;<span class="number">3</span>, <span class="number">4</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//r1有四个int, 在内存中是连续分布</span></span><br><span class="line">	<span class="comment">//打印地址</span></span><br><span class="line">	fmt.Printf(<span class="string">"r1.ledtUp.x 地址=%p, r1.leftUp.y 地址=%p, r1.rightDown.x 地址=%p, r1.rr1.rightDown.yr1 地址=%p \n"</span>, &amp;r1.leftUp.x, &amp;r1.leftUp.y, &amp;r1.rightDown.x, &amp;r1.rightDown.y)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//r2有两个 *Point 类型, 这两个*Point类型的本身地址也是连续的</span></span><br><span class="line">	<span class="comment">//但是他们指向的地址不一定是连续</span></span><br><span class="line">	r2 := Rect2&#123;&amp;Point&#123;<span class="number">10</span>, <span class="number">20</span>&#125;, &amp;Point&#123;<span class="number">30</span>, <span class="number">40</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"r2.leftUp 本身地址=%p, r2.rightDown 本身地址=%p \n"</span>, &amp;r2.leftUp, &amp;r2.rightDown)</span><br><span class="line">	<span class="comment">//他们指向的地址不一定是连续,这个要看系统在运行时是如何分配的</span></span><br><span class="line">	fmt.Printf(<span class="string">"r2.leftUp 指向地址=%p, r2.rightDown 指向地址=%p \n"</span>, r2.leftUp, r2.rightDown)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4w137zflrj20qn01k74l.jpg" alt="image-20220805174144136"></p>
<p>可以看到,上面结果中第一行和第二行的地址是连续的,但是第三行并不一定是连续的,a0和b0在十六进制上差了16个字节</p>
<ol start="2">
<li>结构体是用户单独定义的类型，和其它类型进行转换时需要有完全相同的字段(名字、个数和类型)</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> A <span class="keyword">struct</span> &#123;</span><br><span class="line">	Num <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> B <span class="keyword">struct</span> &#123;</span><br><span class="line">	Num <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> a A</span><br><span class="line">	<span class="keyword">var</span> b B</span><br><span class="line">	a = A(b) <span class="comment">//强制转换类型,但是结构体的字段必须要保证一样(名字 个数 类型)</span></span><br><span class="line">	fmt.Println(a, b)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4wvt3wpp6j20db00rt8m.jpg" alt="image-20220806112433067"></p>
<ol start="3">
<li>结构体进行 type 重新定义(相当于取别名)，Golang 认为是新的数据类型，但是相互间可以强转</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Stu Student</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> s1 Student</span><br><span class="line">	<span class="keyword">var</span> s2 Stu</span><br><span class="line">	<span class="comment">//s1 = s2, 这是不对的</span></span><br><span class="line">	s2 = Stu(s1) <span class="comment">//这样是正确的</span></span><br><span class="line">	fmt.Println(s1, s2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>struct 的每个字段上，可以写上一个 tag, 该 tag 可以通过反射机制获取，常见的使用场景就是序列化和反序列化。</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Monster <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span> <span class="string">`json:"name"`</span>	<span class="comment">//打标签,注意冒号后面不要加空格</span></span><br><span class="line">	Age   <span class="keyword">int</span>    <span class="string">`json:"age"`</span></span><br><span class="line">	Skill <span class="keyword">string</span> <span class="string">`json:"skill"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	monster := Monster&#123;<span class="string">"牛魔王"</span>, <span class="number">500</span>, <span class="string">"芭蕉扇"</span>&#125;</span><br><span class="line">	<span class="comment">//将monster变量序列化为 json 格式字符串</span></span><br><span class="line">	<span class="comment">//json.Marshal 函数中使用反射,这个讲解反射时,再详细介绍</span></span><br><span class="line">	jsonStr, err := json.Marshal(monster)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json 处理错误"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"> 	fmt.Println(<span class="string">"jsonStr"</span>, jsonStr)	<span class="comment">//输出byte</span></span><br><span class="line">	fmt.Println(<span class="string">"jsonStr"</span>, <span class="keyword">string</span>(jsonStr))	<span class="comment">//byte转字符串</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4x0hd9p1jj20r901kaab.jpg" alt="image-20220806140617419"></p>
<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><blockquote>
<p>  在某些情况下，我们要需要声明(定义)方法。比如 Person 结构体:除了有一些字段外( 年龄，姓名..),Person 结构体还有一些行为比如:可以说话、跑步…, 通过学习，还可以做算术题。这时就要用方法才能完成。</p>
<p>  Golang 中的方法是作用在指定的数据类型上的(即:和指定的数据类型绑定)，因此自定义类型，都可以有方法，而不仅仅是 struct。</p>
</blockquote>
<h3 id="小试牛刀"><a href="#小试牛刀" class="headerlink" title="小试牛刀"></a>小试牛刀</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> A <span class="keyword">struct</span> &#123;</span><br><span class="line">    Num <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a A)</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	fmt.Println(a.Num)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>说明<ul>
<li><code>func (a A) test() {}</code> 表示 <code>A</code> 结构体有一方法，方法名为 <code>test</code></li>
<li><code>(a A)</code> 体现 <code>test</code> 方法是和 <code>A</code> 类型绑定的</li>
</ul>
</li>
</ul>
<h4 id="案例-1"><a href="#案例-1" class="headerlink" title="案例"></a>案例</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//给Person类型绑定一个方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Person)</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"test() name="</span>, p.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> p Person</span><br><span class="line">	p.Name = <span class="string">"tom"</span></span><br><span class="line">	p.test() <span class="comment">//调用方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4x1jcwfhhj20ek00tglk.jpg" alt="image-20220806144248481"></p>
<ul>
<li>说明</li>
</ul>
<p>1) test方法和Person类型绑定<br>2) test 方法只能通过 Person 类型的变量来调用，而不能直接调用，也不能使用其它类型变量来调用<br>3) func (p Person) test() {}… p 表示哪个 Person 变量调用，这个 p 就是它的副本, 这点和函数传参非 常相似。<br>4) p 这个名字，有程序员指定，不是固定, 比如修改成 person 也是可以</p>
<h3 id="方法快速入门"><a href="#方法快速入门" class="headerlink" title="方法快速入门"></a>方法快速入门</h3><ul>
<li>给 Person 结构体添加 speak 方法,输出 xxx 是一个好人</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Person)</span> <span class="title">speak</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(p.Name, <span class="string">"是一个好人"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>给 Person 结构体添加 jisuan 方法,可以计算从 1+..+1000 的结果, 说明方法体内可以函数一样， 进行各种运算</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Person)</span> <span class="title">jisuan</span><span class="params">()</span></span> &#123;</span><br><span class="line">	res := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">1000</span>; i++ &#123;</span><br><span class="line">		res += i</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(p.Name, <span class="string">"计算的结果是="</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>给 Person 结构体 jisuan2 方法,该方法可以接收一个数 n，计算从 1+…+n 的结果</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Person)</span> <span class="title">jisuan2</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	res := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= n; i++ &#123;</span><br><span class="line">		res += i</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(p.Name, <span class="string">"计算的结果是="</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>给 Person 结构体添加 getSum 方法,可以计算两个数的和，并返回结果</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Person)</span> <span class="title">getSum</span><span class="params">(n1 <span class="keyword">int</span>, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> n1 + n2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>main主体调用方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> p Person</span><br><span class="line">	p.Name = <span class="string">"tom"</span></span><br><span class="line">	p.test() <span class="comment">//调用方法</span></span><br><span class="line">	p.jisuan()</span><br><span class="line">	p.jisuan2(<span class="number">50</span>)</span><br><span class="line">	res := p.getSum(<span class="number">10</span>, <span class="number">20</span>)</span><br><span class="line">	fmt.Println(<span class="string">"res="</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h4z3yw0i0uj20ef020wej.jpg" alt="image-20220808093800846"></p>
<h3 id="方法的调用和传参机制原理"><a href="#方法的调用和传参机制原理" class="headerlink" title="方法的调用和传参机制原理"></a>方法的调用和传参机制原理</h3><blockquote>
<p>  方法的调用和传参机制和函数基本一样，不一样的地方是方法调用时，会将调用方法的变量，当做实参也传递给方法。下面我们举例说明。</p>
</blockquote>
<h4 id="案例一"><a href="#案例一" class="headerlink" title="案例一"></a>案例一</h4><p>==画出前面 getSum 方法的执行过程+说明==</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4x6gp1qdnj20lo09bdgd.jpg" alt="image-20220806173314395"></p>
<ul>
<li>说明:<br>1) 在通过一个变量去调用方法时，其调用机制和函数一样<br>2) 不一样的地方时，变量调用方法时，该变量本身也会作为一个参数传递到方法(如果变量是值类型，则进行值拷贝，如果变量是引用类型，则进行地址拷贝)</li>
</ul>
<h4 id="案例二"><a href="#案例二" class="headerlink" title="案例二"></a>案例二</h4><p>请编写一个程序，要求如下:<br>1) 声明一个结构体 Circle, 字段为 radius<br>2) 声明一个方法 area 和 Circle 绑定，可以返回面积。<br>3) 提示: 画出 area 执行过程+说明</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Circle <span class="keyword">struct</span> &#123;</span><br><span class="line">	radius <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Circle)</span> <span class="title">area</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">3.14</span> * c.radius * c.radius</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> c Circle</span><br><span class="line">	c.radius = <span class="number">4.0</span></span><br><span class="line">	res := c.area()</span><br><span class="line">	fmt.Println(<span class="string">"面积是="</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z47pvi7uj20be0a60sx.jpg" alt="image-20220808094632707"></p>
<h3 id="方法的声明-定义"><a href="#方法的声明-定义" class="headerlink" title="方法的声明(定义)"></a>方法的声明(定义)</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(recevier <span class="keyword">type</span>)</span> <span class="title">methodName</span><span class="params">(参数列表)</span> <span class="params">(返回值列表)</span></span> &#123; </span><br><span class="line">    方法体</span><br><span class="line">	<span class="keyword">return</span> 返回值</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参数说明:</strong></p>
<p>1) 参数列表:表示方法输入<br>2) recevier type : 表示这个方法和 type 这个类型进行绑定，或者说该方法作用于 type 类型<br>3) receiver type : type 可以是结构体，也可以其它的自定义类型<br>4) receiver : 就是 type 类型的一个变量(实例)，比如 :Person 结构体 的一个变量(实例)<br>5) 返回值列表:表示返回的值，可以多个<br>6) 方法主体:表示为了实现某一功能代码块<br>7) return 语句不是必须的。</p>
<h3 id="方法的注意事项和细节"><a href="#方法的注意事项和细节" class="headerlink" title="方法的注意事项和细节"></a>方法的注意事项和细节</h3><ol>
<li>结构体类型是<code>值类型</code>，在方法调用中，遵守<code>值类型</code>的传递机制，是<code>值拷贝</code>传递方式</li>
<li>如程序员希望在方法中，修改结构体变量的值，可以通过结构体<code>指针</code>的方式来处理(这里可能不是太好理解)</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Circle <span class="keyword">struct</span> &#123;</span><br><span class="line">	radius <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//为了提高效率,通常我们方法和结构体的指针类型绑定</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Circle)</span> <span class="title">area2</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="comment">//因为c是指针,因此我们标准的访问其字段的方式是(*c)</span></span><br><span class="line">	<span class="comment">//return 3.14 * (*c).radius * (*c).radius</span></span><br><span class="line">	<span class="comment">// (*c).radius 等价 c.radius</span></span><br><span class="line">	c.radius = <span class="number">10</span>   <span class="comment">//这里为指针,直接指向main中的c的地址,相当于直接将main中c.radius的地址对应的值给修改掉了</span></span><br><span class="line">    <span class="comment">//下面使用 fmt 打印指针c的地址, 验证func方法中指针c是否指向main中c的地址</span></span><br><span class="line">	fmt.Printf(<span class="string">"func方法中的c.radius =%v, c的地址为%p \n"</span>, c.radius, c) <span class="comment">//这里取c的地址时,不需要加 &amp; 符号,因为c本身就是一个指针</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">3.14</span> * c.radius * c.radius</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> c Circle</span><br><span class="line">	c.radius = <span class="number">7.0</span> <span class="comment">//此时会在内存中生成一个地址</span></span><br><span class="line">	<span class="comment">//res2 := (&amp;c).area2()</span></span><br><span class="line">	<span class="comment">//编译器底层做了优化 (&amp;c).area2() 等价 c.area()</span></span><br><span class="line">	<span class="comment">//因为编译器会自动的给加上 &amp;c</span></span><br><span class="line">	fmt.Printf(<span class="string">"调用方法前, main中c.radius =%v, c的地址为%p \n"</span>, c.radius, &amp;c)</span><br><span class="line">	res2 := c.area2() <span class="comment">//调用方法</span></span><br><span class="line">	<span class="comment">//当执行上面方法的时候,指针是指向方法中的c的地址,而不是main中的 c.radius = 7.0</span></span><br><span class="line">	fmt.Printf(<span class="string">"调用方法后, main中c.radius =%v, c的地址为%p \n"</span>, c.radius, &amp;c)</span><br><span class="line">	fmt.Println(<span class="string">"面积是="</span>, res2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z6qsaz6nj20e701x74g.jpg" alt="image-20220808111403865"></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z6rbwj9vj209r09mjrf.jpg" alt="image-20220808111435136"></p>
<ol start="3">
<li>Golang中的方法作用在指定的数据类型上的(即:和指定的数据类型绑定)，因此自定义类型， 都可以有方法, 而不仅仅是 struct， 比如 int , float32 等都可以有方法</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> integer <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(i integer)</span> <span class="title">print</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"i="</span>, i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//编写一个方法,可以改变i的值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(i *integer)</span> <span class="title">change</span><span class="params">()</span></span> &#123;</span><br><span class="line">	*i = *i + <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i integer = <span class="number">10</span></span><br><span class="line">	i.<span class="built_in">print</span>()</span><br><span class="line">	i.change()</span><br><span class="line">	fmt.Println(<span class="string">"i="</span>, i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z7fr7xx6j20ea013t8m.jpg" alt="image-20220808113804128"></p>
<ol start="4">
<li>方法的访问范围控制的规则，和函数一样。方法名首字母小写，只能在本包访问; 方法首字母大写，可以在本包和其它包访问。</li>
<li>如果一个类型实现了 String()这个方法，那么 fmt.Println 默认会调用这个变量的 String()进行输出</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//给 *String 实现方法String()</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(stu *Student)</span> <span class="title">String</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	str := fmt.Sprintf(<span class="string">"Name=[%v], Age=[%v]"</span>, stu.Name, stu.Age)</span><br><span class="line">	<span class="keyword">return</span> str</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//定义一个Student变量</span></span><br><span class="line">	stu := Student&#123;</span><br><span class="line">		Name: <span class="string">"tom"</span>,</span><br><span class="line">		Age:  <span class="number">20</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果实现了 *Student 类型的 String 方法,就会自动调用</span></span><br><span class="line">	fmt.Println(&amp;stu)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z7wsm92zj20ek00sq2v.jpg" alt="image-20220808115426710"></p>
<h3 id="方法练习"><a href="#方法练习" class="headerlink" title="方法练习"></a>方法练习</h3><ul>
<li>编写结构体(MethodUtils)，编程一个方法，方法不需要参数，在方法中打印一个 10*8 的矩形，在 main 方法中调用该方法。</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MethodUtils <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//字段</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mu MethodUtils)</span> <span class="title">Print</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= <span class="number">8</span>; j++ &#123;</span><br><span class="line">			fmt.Print(<span class="string">"*"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> mu MethodUtils</span><br><span class="line">	mu.Print()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4z8jr1knaj20gf03wmx8.jpg" alt="image-20220808121630190"></p>
<ul>
<li>编写一个方法，提供 m 和 n 两个参数，方法中打印一个 m*n 的矩形</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> MethodUtils <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//字段</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(mu MethodUtils)</span> <span class="title">Print</span><span class="params">(m <span class="keyword">int</span>, n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= m; i++ &#123;</span><br><span class="line">		<span class="keyword">for</span> j := <span class="number">1</span>; j &lt;= n; j++ &#123;</span><br><span class="line">			fmt.Print(<span class="string">"*"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> mu MethodUtils</span><br><span class="line">	mu.Print(<span class="number">4</span>, <span class="number">10</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>定义小小计算器结构体(Calcuator)，实现加减乘除四个功能 实现形式 <ul>
<li>实现形式1: 分四个方法完成:</li>
<li>实现形式2: 用一个方法搞定</li>
</ul>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Calcuator <span class="keyword">struct</span> &#123;</span><br><span class="line">	Num1 <span class="keyword">float64</span></span><br><span class="line">	Num2 <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实现形式1</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(calcuator *Calcuator)</span> <span class="title">getSum</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> calcuator.Num1 + calcuator.Num2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(calcuator *Calcuator)</span> <span class="title">getSub</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> calcuator.Num1 - calcuator.Num2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实现形式2</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(calcuator *Calcuator)</span> <span class="title">getRes</span><span class="params">(operator <span class="keyword">byte</span>)</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	res := <span class="number">0.0</span></span><br><span class="line">	<span class="keyword">switch</span> operator &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'+'</span>:</span><br><span class="line">		res = calcuator.Num1 + calcuator.Num2</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'-'</span>:</span><br><span class="line">		res = calcuator.Num1 - calcuator.Num2</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'*'</span>:</span><br><span class="line">		res = calcuator.Num1 * calcuator.Num2</span><br><span class="line">	<span class="keyword">case</span> <span class="string">'/'</span>:</span><br><span class="line">		res = calcuator.Num1 / calcuator.Num2</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">"运算符输入有误!"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	c := Calcuator &#123;</span><br><span class="line">		Num1 : <span class="number">10</span>,</span><br><span class="line">		Num2 : <span class="number">20</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//使用方式二计算乘法</span></span><br><span class="line">	res := c.getRes(<span class="string">'*'</span>)</span><br><span class="line">	fmt.Println(<span class="string">"res="</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4zaxg2epcj20g600v0sp.jpg" alt="image-20220808133851814"></p>
<h3 id="方法和函数区别"><a href="#方法和函数区别" class="headerlink" title="方法和函数区别"></a>方法和函数区别</h3><ul>
<li><p>调用方式不一样</p>
<ul>
<li><p><strong>函数的调用方式:</strong> <code>函数名</code>(实参列表)</p>
</li>
<li><p><strong>方法的调用方式:</strong> <code>变量.方法名</code>(实参列表)</p>
</li>
</ul>
</li>
<li><p>对于普通函数，接收者为值类型时，不能将指针类型的数据直接传递，反之亦然</p>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test01</span><span class="params">(p Person)</span></span> &#123;</span><br><span class="line">	fmt.Println(p.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test02</span><span class="params">(p *Person)</span></span> &#123;</span><br><span class="line">	fmt.Println(p.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p := Person&#123;<span class="string">"tom"</span>&#125;</span><br><span class="line">	test01(p)</span><br><span class="line">	test02(&amp;p)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4zb93l2h3j20e8016a9z.jpg" alt="image-20220808135003870"></p>
<ul>
<li>对于方法(如 struct 的方法)，接收者为值类型时，可以直接用指针类型的变量调用方法，反过来同样也可以</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Person)</span> <span class="title">test03</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p.Name = <span class="string">"jack"</span></span><br><span class="line">	fmt.Println(<span class="string">"test03()="</span>, p.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Person)</span> <span class="title">test04</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p.Name = <span class="string">"mary"</span></span><br><span class="line">	fmt.Println(<span class="string">"test04()="</span>, p.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p := Person&#123;<span class="string">"tom"</span>&#125;</span><br><span class="line">	test01(p)</span><br><span class="line">	test02(&amp;p)</span><br><span class="line"></span><br><span class="line">	p.test03()</span><br><span class="line">	fmt.Println(<span class="string">"main() p.Name="</span>, p.Name)</span><br><span class="line">	(&amp;p).test03() <span class="comment">//形式上是传入地址,但是本质仍然是值拷贝</span></span><br><span class="line">	fmt.Println(<span class="string">"main() p.name="</span>, p.Name)</span><br><span class="line"></span><br><span class="line">	(&amp;p).test04()</span><br><span class="line">	fmt.Println(<span class="string">"main() p.Name="</span>, p.Name)</span><br><span class="line">	p.test04() <span class="comment">//等价 (&amp;p).test04, 从形式上是传入值类型,但是本质上仍然是地址拷贝</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h4zbr9mqorj205v02r747.jpg" alt="image-20220808140731655"></p>
<p><strong>总结:</strong></p>
<p>1) 不管调用形式如何，真正决定是值拷贝还是地址拷贝，看这个方法是和哪个类型绑定.<br>2) 如果是和值类型，比如 (p Person) , 则是值拷贝， 如果和指针类型，比如是 (p *Person) 则<br>    是地址拷贝。</p>
<h2 id="面向对象编程应用实例"><a href="#面向对象编程应用实例" class="headerlink" title="面向对象编程应用实例"></a>面向对象编程应用实例</h2><h3 id="步骤-1"><a href="#步骤-1" class="headerlink" title="步骤"></a>步骤</h3><p>1) 声明(定义)结构体，确定结构体名<br>2) 编写结构体的字段<br>3) 编写结构体的方法</p>
<h3 id="学生案例"><a href="#学生案例" class="headerlink" title="学生案例"></a>学生案例</h3><p>1) 编写一个 Student 结构体，包含 name、gender、age、id、score 字段，分别为 string、string、int、 int、float64 类型。<br>2) 结构体中声明一个 say 方法，返回 string 类型，方法返回信息中包含所有字段值。<br>3) 在 main 方法中，创建 Student 结构体实例(变量)，并访问 say 方法，并将调用结果打印输出</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1) 编写一个 Student 结构体，包含 name、gender、age、id、score 字段，分别为 string、string、int、 int、float64 类型。</span></span><br><span class="line"><span class="comment">2) 结构体中声明一个 say 方法，返回 string 类型，方法返回信息中包含所有字段值。</span></span><br><span class="line"><span class="comment">3) 在 main 方法中，创建 Student 结构体实例(变量)，并访问 say 方法，并将调用结果打印输出</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name   <span class="keyword">string</span></span><br><span class="line">	Gender <span class="keyword">string</span></span><br><span class="line">	Age    <span class="keyword">int</span></span><br><span class="line">	Id     <span class="keyword">int</span></span><br><span class="line">	Score  <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(stu *Student)</span> <span class="title">say</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	res := fmt.Sprintf(<span class="string">"Name=%v\nGender=%v\nAge=%v\nId=%v\nScore=%v"</span>, stu.Name, stu.Gender, stu.Age, stu.Id, stu.Score)</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> stu = Student&#123;</span><br><span class="line">		<span class="string">"poker"</span>,</span><br><span class="line">		<span class="string">"man"</span>,</span><br><span class="line">		<span class="number">26</span>,</span><br><span class="line">		<span class="number">01</span>,</span><br><span class="line">		<span class="number">99.99</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	res := stu.say()</span><br><span class="line">	fmt.Println(res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="创建结构体变量时指定字段值"><a href="#创建结构体变量时指定字段值" class="headerlink" title="创建结构体变量时指定字段值"></a>创建结构体变量时指定字段值</h2><h3 id="方式一-2"><a href="#方式一-2" class="headerlink" title="方式一"></a>方式一</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Stu <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//方式一</span></span><br><span class="line">	<span class="comment">//在创建结构体变量时,就直接指定字段的值</span></span><br><span class="line">	<span class="keyword">var</span> stu1 = Stu&#123;<span class="string">"小明"</span>, <span class="number">19</span>&#125; <span class="comment">//stu1, 结构体数据空间</span></span><br><span class="line"></span><br><span class="line">	stu2 := Stu&#123;<span class="string">"小明"</span>, <span class="number">20</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//在创建结构体变量时, 把字段名和字段值写在一起, 就不会依赖字段的定义顺序</span></span><br><span class="line">	<span class="keyword">var</span> stu3 = Stu&#123;</span><br><span class="line">		Name: <span class="string">"jack"</span>,</span><br><span class="line">		Age:  <span class="number">20</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	stu4 := Stu&#123;</span><br><span class="line">		Age:  <span class="number">30</span>,</span><br><span class="line">		Name: <span class="string">"mary"</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(stu1, stu2, stu3, stu4)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方式二-2"><a href="#方式二-2" class="headerlink" title="方式二"></a>方式二</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方式二, 返回结构体的指针类型</span></span><br><span class="line"><span class="keyword">var</span> stu5 *Stu = &amp;Stu&#123;<span class="string">"小王"</span>, <span class="number">29</span>&#125;</span><br><span class="line">stu6 := &amp;Stu&#123;<span class="string">"小王"</span>, <span class="number">39</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stu7 = &amp;Stu &#123;</span><br><span class="line">	Name : <span class="string">"小李"</span>,</span><br><span class="line">	Age : <span class="number">49</span>,</span><br><span class="line">&#125;</span><br><span class="line">stu8 := &amp;Stu &#123;</span><br><span class="line">	Age : <span class="number">59</span>,</span><br><span class="line">	Name : <span class="string">"小李~"</span>,</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(*stu5, *stu6, *stu7, *stu8)</span><br></pre></td></tr></table></figure>

<h2 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h2><blockquote>
<p>  Golang 的结构体没有构造函数，通常可以使用工厂模式来解决这个问题。</p>
</blockquote>
<h3 id="为什么会有工厂模式"><a href="#为什么会有工厂模式" class="headerlink" title="为什么会有工厂模式"></a>为什么会有工厂模式</h3><p>例如现在有一个结构体</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>因为这个结构体的名称的首字母为大写,所以我们可以在外部进行调用</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/object_oriented_programming/factory/model"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> stu model.Student</span><br><span class="line">	stu.Name = <span class="string">"tom"</span></span><br><span class="line">	stu.Age = <span class="number">26</span></span><br><span class="line"></span><br><span class="line">	fmt.Println(stu)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么如果这个结构体的名称首字母为小写时,其他文件就没有办法进行引用</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> student <span class="keyword">struct</span> &#123;	<span class="comment">//s为小写,外部无法调用</span></span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以就出现了”工厂模式”</p>
<h3 id="工厂模式的使用方法"><a href="#工厂模式的使用方法" class="headerlink" title="工厂模式的使用方法"></a>工厂模式的使用方法</h3><ul>
<li>案例</li>
</ul>
<p>model外部模块</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> student <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span></span><br><span class="line">	Score <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//因为student结构体首字母是小写,因此只能在model使用</span></span><br><span class="line"><span class="comment">//我们通过工厂模式来解决</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewStudent</span><span class="params">(n <span class="keyword">string</span>, s <span class="keyword">float64</span>)</span> *<span class="title">student</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;student&#123;</span><br><span class="line">		Name:  n,</span><br><span class="line">		Score: s,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>main主函数进行调用</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/object_oriented_programming/factory/model"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> stu = model.NewStudent(<span class="string">"tom"</span>, <span class="number">99.8</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(*stu) <span class="comment">//stu接受的是NewStudent返回的一个指针</span></span><br><span class="line">	fmt.Println(<span class="string">"name"</span>, stu.Name, <span class="string">" score="</span>, stu.Score)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h50d0iqrrjj20ff015jrc.jpg" alt="image-20220809113632923"></p>
<blockquote>
<p>  type student struct {<br>      Name  string<br>      Score float64<br>  }</p>
<p>  如果这一段代码中的<code>Score</code>改为<code>score</code>的话,外部同样无法进行调用,这里我们应该如何处理呢?</p>
</blockquote>
<p>model外部模块</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> student <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span></span><br><span class="line">	score <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//因为student结构体首字母是小写,因此只能在model使用</span></span><br><span class="line"><span class="comment">//我们通过工厂模式来解决</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewStudent</span><span class="params">(n <span class="keyword">string</span>, s <span class="keyword">float64</span>)</span> *<span class="title">student</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;student&#123;</span><br><span class="line">		Name:  n,</span><br><span class="line">		score: s,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *student)</span> <span class="title">GetScore</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> s.score</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>main主函数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/object_oriented_programming/factory/model"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> stu = model.NewStudent(<span class="string">"tom"</span>, <span class="number">99.8</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(*stu) <span class="comment">//stu接受的是NewStudent返回的一个指针</span></span><br><span class="line">	fmt.Println(<span class="string">"name"</span>, stu.Name, <span class="string">" score="</span>, stu.GetScore())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="面向对象编程思想-抽象"><a href="#面向对象编程思想-抽象" class="headerlink" title="面向对象编程思想-抽象"></a>面向对象编程思想-抽象</h2><blockquote>
<p>  我们在前面去定义一个结构体时候，实际上就是把一类事物的共有的属性(字段)和行为(方法)提取出来，形成一个物理模型(结构体)。这种研究问题的方法称为抽象。</p>
</blockquote>
<p>案例</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h50h3qjflzj20lo06ajrr.jpg" alt="image-20220809135803801"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Account <span class="keyword">struct</span> &#123;</span><br><span class="line">	AccountNo <span class="keyword">string</span></span><br><span class="line">	Pwd       <span class="keyword">string</span></span><br><span class="line">	Balance   <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法</span></span><br><span class="line"><span class="comment">//存款</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(account *Account)</span> <span class="title">SaveMoney</span><span class="params">(money <span class="keyword">float64</span>, pwd <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//检查输入的密码是否正确</span></span><br><span class="line">	<span class="keyword">if</span> pwd != account.Pwd &#123;</span><br><span class="line">		fmt.Println(<span class="string">"你输入的密码不正确"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//价差输入的存款金额是否正确</span></span><br><span class="line">	<span class="keyword">if</span> money &lt;= <span class="number">0</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"输入的金额不正确!"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	account.Balance += money</span><br><span class="line">	fmt.Println(<span class="string">"存款成功"</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//取款</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(account *Account)</span> <span class="title">WithDraw</span><span class="params">(money <span class="keyword">float64</span>, pwd <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//检查输入的密码是否正确</span></span><br><span class="line">	<span class="keyword">if</span> pwd != account.Pwd &#123;</span><br><span class="line">		fmt.Println(<span class="string">"你输入的密码不正确"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//价差输入的取款金额是否正确</span></span><br><span class="line">	<span class="keyword">if</span> money &lt;= <span class="number">0</span> || money &gt; account.Balance &#123;</span><br><span class="line">		fmt.Println(<span class="string">"输入的金额不正确!"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	account.Balance -= money</span><br><span class="line">	fmt.Println(<span class="string">"取款成功"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(account *Account)</span> <span class="title">QueryMoney</span><span class="params">(pwd <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> pwd != account.Pwd &#123;</span><br><span class="line">		fmt.Println(<span class="string">"你输入的密码不正确"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">"你的账号为%v 余额为%v \n"</span>, account.AccountNo, account.Balance)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> account = Account&#123;</span><br><span class="line">		AccountNo: <span class="string">"gs123456"</span>,</span><br><span class="line">		Pwd:       <span class="string">"123456"</span>,</span><br><span class="line">		Balance:   <span class="number">100.0</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	accountNo := <span class="string">""</span></span><br><span class="line">	passwd := <span class="string">""</span></span><br><span class="line">	fmt.Println(<span class="string">"请输入账户: "</span>)</span><br><span class="line">	fmt.Scanf(<span class="string">"%v"</span>, &amp;accountNo)</span><br><span class="line">	fmt.Println(<span class="string">"请输入密码: "</span>)</span><br><span class="line">	fmt.Scanf(<span class="string">"%v"</span>, &amp;passwd)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建变量 i ,当 i == 1 时,程序退出</span></span><br><span class="line">	i := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//相当于 while 循环</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//判断用户名与密码是否正确</span></span><br><span class="line">		<span class="keyword">if</span> accountNo == account.AccountNo &amp;&amp; passwd == account.Pwd &#123;</span><br><span class="line">			operate := <span class="string">""</span></span><br><span class="line">			fmt.Println(<span class="string">"==============================="</span>)</span><br><span class="line">			fmt.Println(<span class="string">"请选择您要进行的操作:[1|2|3|q] "</span>)</span><br><span class="line">			fmt.Println(<span class="string">"1. 查询余额\n2. 存款操作\n3. 取款操作\nq. 退出"</span>)</span><br><span class="line">			fmt.Println(<span class="string">"==============================="</span>)</span><br><span class="line">			fmt.Scanf(<span class="string">"%v"</span>, &amp;operate)</span><br><span class="line"></span><br><span class="line">			<span class="keyword">switch</span> operate &#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"1"</span>:</span><br><span class="line">				account.QueryMoney(account.Pwd)</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"2"</span>:</span><br><span class="line">				money := <span class="number">0.00</span></span><br><span class="line">				fmt.Println(<span class="string">"请输入存款金额: "</span>)</span><br><span class="line">				fmt.Scanf(<span class="string">"%v"</span>, &amp;money)</span><br><span class="line">				account.SaveMoney(money, account.Pwd)</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"3"</span>:</span><br><span class="line">				money := <span class="number">0.00</span></span><br><span class="line">				fmt.Println(<span class="string">"请输入取款金额: "</span>)</span><br><span class="line">				fmt.Scanf(<span class="string">"%v"</span>, &amp;money)</span><br><span class="line">				account.WithDraw(money, account.Pwd)</span><br><span class="line">			<span class="keyword">case</span> <span class="string">"q"</span>:</span><br><span class="line">				fmt.Println(<span class="string">"欢迎您下次光临~"</span>)</span><br><span class="line">				i = <span class="number">1</span> <span class="comment">//退出循环</span></span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				fmt.Println(<span class="string">"请输入正确的选项!"</span>)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"您输入的账户或密码错误!"</span>)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">        </span><br><span class="line">		<span class="keyword">if</span> i == <span class="number">1</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>测试</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h50k2vt9eyj20fn0okwg0.jpg" alt="image-20220809154102839"></p>
<h2 id="面向对象编程三大特性-封装"><a href="#面向对象编程三大特性-封装" class="headerlink" title="面向对象编程三大特性-封装"></a>面向对象编程三大特性-封装</h2><blockquote>
<p>  Golang 仍然有面向对象编程的继承，封装和多态的特性，只是实现的方式和其它 OOP 语言不一样，下面我们一一进行详细的讲解 Golang 的三大特性是如何实现的。</p>
<p>  封装(encapsulation)就是把抽象出的字段和对字段的操作封装在一起,数据被保护在内部,程序的其它包只有通过被授权的操作(方法),才能对字段进行操作</p>
</blockquote>
<h3 id="封装的好处"><a href="#封装的好处" class="headerlink" title="封装的好处"></a>封装的好处</h3><p>1) 隐藏实现细节<br>2) 提可以对数据进行验证，保证安全合理(Age)</p>
<h3 id="如何实现封装"><a href="#如何实现封装" class="headerlink" title="如何实现封装"></a>如何实现封装</h3><p>1) 对结构体中的属性进行封装<br>2) 通过方法，包实现封装</p>
<h3 id="封装的步骤"><a href="#封装的步骤" class="headerlink" title="封装的步骤"></a>封装的步骤</h3><p>1) 将结构体、字段(属性)的首字母小写(不能导出了，其它包不能使用，类似 private)<br>2) 给结构体所在包提供一个工厂模式的函数，首字母大写。类似一个构造函数。<br>3) 提供一个首字母大写的 Set 方法(类似其它语言的 public)，用于对属性判断并赋值</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(<span class="keyword">var</span> 结构体类型名)</span> <span class="title">SetXxx</span><span class="params">(参数列表)</span> <span class="params">(返回值列表)</span></span> &#123;</span><br><span class="line">	<span class="comment">//加入数据验证的业务逻辑</span></span><br><span class="line">	<span class="keyword">var</span>.字段 = 参数 </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>提供一个首字母大写的 Get 方法(类似其它语言的 public)，用于获取属性的值</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(<span class="keyword">var</span> 结构体类型名)</span> <span class="title">GetXxx</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">var</span>.age;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="快速入门案例"><a href="#快速入门案例" class="headerlink" title="快速入门案例"></a>快速入门案例</h3><blockquote>
<p>  请大家看一个程序(person.go),不能随便查看人的年龄,工资等隐私，并对输入的年龄进行合理的验证。设计: model 包(person.go) main 包(main.go 调用 Person 结构体)</p>
</blockquote>
<p>model外部模块</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> person <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name   <span class="keyword">string</span></span><br><span class="line">	age    <span class="keyword">int</span></span><br><span class="line">	salary <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//写一个工厂模式的函数,相当于构造函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewPerson</span><span class="params">(name <span class="keyword">string</span>)</span> *<span class="title">person</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;person&#123;</span><br><span class="line">		Name: name,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//为了访问age和sal 我们编写一对 Setxxx 的方法和Getxxx的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *person)</span> <span class="title">SetAge</span><span class="params">(age <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">if</span> age &gt; <span class="number">0</span> &amp;&amp; age &lt; <span class="number">150</span> &#123;</span><br><span class="line">		p.age = age</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"年龄范围不正确!"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *person)</span> <span class="title">GetAge</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> p.age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *person)</span> <span class="title">SetSalary</span><span class="params">(salary <span class="keyword">float64</span>)</span></span> &#123;</span><br><span class="line">	p.salary = salary</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *person)</span> <span class="title">GetSalary</span><span class="params">()</span> <span class="title">float64</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> p.salary</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>main</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/object_oriented_programming/FengZhuang/01/model"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	p := model.NewPerson(<span class="string">"poker"</span>)</span><br><span class="line">	p.SetAge(<span class="number">26</span>)</span><br><span class="line">	p.SetSalary(<span class="number">10000.0</span>)</span><br><span class="line">	fmt.Println(p)</span><br><span class="line">	fmt.Println(<span class="string">"Name="</span>, p.Name, <span class="string">"age="</span>, p.GetAge(), <span class="string">"salary="</span>, p.GetSalary())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h51jls02vqj20iy01974d.jpg" alt="image-20220810121009618"></p>
<h3 id="练习案例"><a href="#练习案例" class="headerlink" title="练习案例"></a>练习案例</h3><blockquote>
<p>  1) 创建程序,在 model 包中定义 Account 结构体:在 main 函数中体会 Golang 的封装性。<br>  2) Account结构体要求具有字段:账号(长度在6-10之间)、余额(必须&gt;20)、密码(必须是六<br>  3) 通过 SetXxx 的方法给 Account 的字段赋值。(同学们自己完成<br>  4) 在 main 函数中测试</p>
</blockquote>
<p>model外部模块</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> account <span class="keyword">struct</span> &#123;</span><br><span class="line">	accountNo <span class="keyword">string</span></span><br><span class="line">	pwd       <span class="keyword">string</span></span><br><span class="line">	balance   <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewAccount</span><span class="params">(accountNo <span class="keyword">string</span>, pwd <span class="keyword">string</span>, balance <span class="keyword">float64</span>)</span> *<span class="title">account</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//对输入的内容进行判断</span></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(accountNo) &lt; <span class="number">6</span> || <span class="built_in">len</span>(accountNo) &gt; <span class="number">10</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"账号的长度不正确!"</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(pwd) != <span class="number">6</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"账号的密码长度不正确!"</span>)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> balance &lt; <span class="number">20</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"余额的数目不正确!"</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> &amp;account&#123;</span><br><span class="line">		accountNo: accountNo,</span><br><span class="line">		pwd:       pwd,</span><br><span class="line">		balance:   balance,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法</span></span><br><span class="line"><span class="comment">//存款</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(account *account)</span> <span class="title">SaveMoney</span><span class="params">(money <span class="keyword">float64</span>, pwd <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//检查输入的密码是否正确</span></span><br><span class="line">	<span class="keyword">if</span> pwd != account.pwd &#123;</span><br><span class="line">		fmt.Println(<span class="string">"你输入的密码不正确"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//价差输入的存款金额是否正确</span></span><br><span class="line">	<span class="keyword">if</span> money &lt;= <span class="number">0</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"输入的金额不正确!"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	account.balance += money</span><br><span class="line">	fmt.Println(<span class="string">"存款成功"</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//取款</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(account *account)</span> <span class="title">WithDraw</span><span class="params">(money <span class="keyword">float64</span>, pwd <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//检查输入的密码是否正确</span></span><br><span class="line">	<span class="keyword">if</span> pwd != account.pwd &#123;</span><br><span class="line">		fmt.Println(<span class="string">"你输入的密码不正确"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//价差输入的取款金额是否正确</span></span><br><span class="line">	<span class="keyword">if</span> money &lt;= <span class="number">0</span> || money &gt; account.balance &#123;</span><br><span class="line">		fmt.Println(<span class="string">"输入的金额不正确!"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	account.balance -= money</span><br><span class="line">	fmt.Println(<span class="string">"取款成功"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查询</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(account *account)</span> <span class="title">QueryMoney</span><span class="params">(pwd <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> pwd != account.pwd &#123;</span><br><span class="line">		fmt.Println(<span class="string">"你输入的密码不正确"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">"你的账号为%v 余额为%v \n"</span>, account.accountNo, account.balance)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>main</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/object_oriented_programming/FengZhuang/02/model"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//创建一个 account 变量</span></span><br><span class="line">	account := model.NewAccount(<span class="string">"jzh11111"</span>, <span class="string">"000000"</span>, <span class="number">40</span>)</span><br><span class="line">	<span class="keyword">if</span> account != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"创建成功="</span>, account)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"创建失败"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h51jlaxavhj20k700uq2z.jpg" alt="image-20220810120940064"></p>
<h2 id="面向对象编程三大特性-继承"><a href="#面向对象编程三大特性-继承" class="headerlink" title="面向对象编程三大特性-继承"></a>面向对象编程三大特性-继承</h2><h3 id="为什么使用继承"><a href="#为什么使用继承" class="headerlink" title="为什么使用继承"></a>为什么使用继承</h3><ul>
<li>通过一个案例来说明</li>
</ul>
<p>model外部模块</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"golang_study/object_oriented_programming/JICheng/01/model"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> pupil = &amp;model.Pupil&#123;</span><br><span class="line">		Name: <span class="string">"tom"</span>,</span><br><span class="line">		Age:  <span class="number">10</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	pupil.Testing()</span><br><span class="line">	pupil.SetScore(<span class="number">90</span>)</span><br><span class="line">	pupil.ShowInfo()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> graduate = &amp;model.Graduate&#123;</span><br><span class="line">		Name: <span class="string">"tom"</span>,</span><br><span class="line">		Age:  <span class="number">10</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	graduate.Testing()</span><br><span class="line">	graduate.SetScore(<span class="number">90</span>)</span><br><span class="line">	graduate.ShowInfo()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>main</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//编写一个学生考试系统</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//小学生</span></span><br><span class="line"><span class="keyword">type</span> Pupil <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span></span><br><span class="line">	Age   <span class="keyword">int</span></span><br><span class="line">	Score <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//显示他的成绩</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Pupil)</span> <span class="title">ShowInfo</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Printf(<span class="string">"学生名=%v 年龄=%v 成绩=%v \n"</span>, p.Name, p.Age, p.Score)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Pupil)</span> <span class="title">SetScore</span><span class="params">(score <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="comment">//业务判断</span></span><br><span class="line">	p.Score = score</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Pupil)</span> <span class="title">Testing</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"小学生正在考试中..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//大学生</span></span><br><span class="line"><span class="keyword">type</span> Graduate <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span></span><br><span class="line">	Age   <span class="keyword">int</span></span><br><span class="line">	Score <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//显示他的成绩</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Graduate)</span> <span class="title">ShowInfo</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Printf(<span class="string">"学生名=%v 年龄=%v 成绩=%v \n"</span>, p.Name, p.Age, p.Score)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Graduate)</span> <span class="title">SetScore</span><span class="params">(score <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="comment">//业务判断</span></span><br><span class="line">	p.Score = score</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Graduate)</span> <span class="title">Testing</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"大学生正在考试中..."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h51m6xkvuij20i601zaa7.jpg" alt="image-20220810133941739"></p>
<ul>
<li>对上面代码的总结</li>
</ul>
<p>1) <code>Pupil</code> 和 <code>Graduate</code> 两个结构体的字段和方法几乎，但是我们却写了两份相同的代码，代码复用性不<br>    强<br>2) 出现<code>代码冗余</code>，而且代码不利于维护，同时也不利于功能的扩展。<br>3) 解决方法: 通过<code>继承方式</code>来解决</p>
<h3 id="继承的介绍"><a href="#继承的介绍" class="headerlink" title="继承的介绍"></a>继承的介绍</h3><blockquote>
<p>  继承可以解决代码复用,让我们的编程更加靠近人类思维。<br>  当多个结构体存在相同的属性(字段)和方法时,可以从这些结构体中抽象出结构体(比如刚才的Student),在该结构体中定义这些相同的属性和方法。</p>
</blockquote>
<p>其它的结构体不需要重新定义这些属性(字段)和方法，只需嵌套一个 Student 匿名结构体即可</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h51opype5ij20ex099dg8.jpg" alt="image-20220810150710847"></p>
<blockquote>
<p>  也就是说: 在 Golang 中，如果一个 struct 嵌套了另一个匿名结构体，那么这个结构体可以直接访问匿名结构体的字段和方法，从而实现了继承特性。</p>
</blockquote>
<h3 id="嵌套匿名结构体的基本语法"><a href="#嵌套匿名结构体的基本语法" class="headerlink" title="嵌套匿名结构体的基本语法"></a>嵌套匿名结构体的基本语法</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Goods <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span></span><br><span class="line">	Price <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Book <span class="keyword">struct</span> &#123;</span><br><span class="line">	Goods <span class="comment">//这里就是嵌套匿名结构体 Goods Writer string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="快速入门案例-1"><a href="#快速入门案例-1" class="headerlink" title="快速入门案例"></a>快速入门案例</h3><p>model外部函数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//编写一个学生考试系统</span></span><br><span class="line"><span class="comment">//实现继承</span></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span></span><br><span class="line">	Age   <span class="keyword">int</span></span><br><span class="line">	Score <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//显示他的成绩</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Student)</span> <span class="title">ShowInfo</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Printf(<span class="string">"学生名=%v 年龄=%v 成绩=%v \n"</span>, p.Name, p.Age, p.Score)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Student)</span> <span class="title">SetScore</span><span class="params">(score <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="comment">//业务判断</span></span><br><span class="line">	p.Score = score</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//小学生</span></span><br><span class="line"><span class="keyword">type</span> Pupil <span class="keyword">struct</span> &#123;</span><br><span class="line">	Student</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Pupil)</span> <span class="title">Testing</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"小学生正在考试中..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//大学生</span></span><br><span class="line"><span class="keyword">type</span> Graduate <span class="keyword">struct</span> &#123;</span><br><span class="line">	Student</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Graduate)</span> <span class="title">Testing</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"大学生正在考试中..."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>main</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"golang_study/object_oriented_programming/JICheng/01/model"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> pupil = &amp;model.Pupil&#123;&#125;</span><br><span class="line">	pupil.Student.Name = <span class="string">"tom"</span></span><br><span class="line">	pupil.Student.Age = <span class="number">10</span></span><br><span class="line">	pupil.Testing()</span><br><span class="line">	pupil.Student.SetScore(<span class="number">90</span>)</span><br><span class="line">	pupil.Student.ShowInfo()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> graduate = &amp;model.Graduate&#123;&#125;</span><br><span class="line">	graduate.Student.Name = <span class="string">"jack"</span></span><br><span class="line">	graduate.Student.Age = <span class="number">11</span></span><br><span class="line">	graduate.Testing()</span><br><span class="line">	graduate.Student.SetScore(<span class="number">90</span>)</span><br><span class="line">	graduate.Student.ShowInfo()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h51p7lii0dj20i601y0su.jpg" alt="image-20220810152407939"></p>
<h3 id="继承的深入讨论"><a href="#继承的深入讨论" class="headerlink" title="继承的深入讨论"></a>继承的深入讨论</h3><ul>
<li>结构体可以使用<code>嵌套匿名结构体</code>所有的字段和方法，即:首字母大写或者小写的字段、方法，<br>都可以使用</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> A <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	age <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> B <span class="keyword">struct</span> &#123;</span><br><span class="line">	A</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> b B</span><br><span class="line">	b.A.Name = <span class="string">"tom"</span></span><br><span class="line">	b.A.age = <span class="number">19</span></span><br><span class="line">	b.A.SayOk()</span><br><span class="line">	b.A.Hello()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>匿名结构体字段访问可以简化</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> b B</span><br><span class="line">	b.A.Name = <span class="string">"tom"</span></span><br><span class="line">	b.A.age = <span class="number">19</span></span><br><span class="line">	b.A.SayOk()</span><br><span class="line">	b.A.Hello()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//上面的写法可以进行简化</span></span><br><span class="line">	b.Name = <span class="string">"jack"</span></span><br><span class="line">	b.age = <span class="number">20</span></span><br><span class="line">	b.SayOk()</span><br><span class="line">	b.Hello()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>对上面代码的总结:</strong></p>
<p>(1) 当我们直接通过 <code>b</code> 访问字段或方法时，其执行流程如下比如 <code>b.Name</code><br>(2) 编译器会先看 <code>b</code> 对应的类型有没有 <code>Name</code>, 如果有，则直接调用 <code>B</code> 类型的 <code>Name</code> 字段<br>(3) 如果没有就去看 <code>B</code> 中嵌入的匿名结构体 <code>A</code> 有没有声明 <code>Name</code> 字段，如果有就调用,如果没有继续查找..如果都找不到就报错</p>
<ul>
<li>当<code>结构体</code>和<code>匿名结构体</code>有<code>相同的字段或者方法时</code>，编译器采用<code>就近访问原则</code>访问，如希望访问<code>匿名结构体</code>的字段和方法，可以通过<code>匿名结构体名</code>来区分</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> A <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> B <span class="keyword">struct</span> &#123;</span><br><span class="line">	A</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *B)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"B SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *B)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"B Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> b B</span><br><span class="line">	b.A.Name = <span class="string">"tom"</span></span><br><span class="line">	b.A.age = <span class="number">19</span></span><br><span class="line">	b.A.SayOk()</span><br><span class="line">	b.A.Hello()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//测试就近原则</span></span><br><span class="line">	b.Name = <span class="string">"poker"</span></span><br><span class="line">	b.age = <span class="number">26</span></span><br><span class="line">	b.SayOk()</span><br><span class="line">	b.Hello()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h51sdrxt6uj20ha01x0sr.jpg" alt="image-20220810171352523"></p>
<ul>
<li>结构体嵌入两个(或多个)匿名结构体，如两个<code>匿名结构体</code>有<code>相同的字段和方法</code>(同时结构体本身没有同名的字段和方法)，在访问时，就必须明确<code>指定匿名结构体名字</code>，否则编译<strong>报错</strong>。</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> A <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> B <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span></span><br><span class="line">	score <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *B)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"B SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *B)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"B Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//加入一个新的结构体</span></span><br><span class="line"><span class="keyword">type</span> C <span class="keyword">struct</span> &#123;</span><br><span class="line">	A</span><br><span class="line">	B</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> c C</span><br><span class="line">	c.A.Name = <span class="string">"jenny"</span></span><br><span class="line">	c.B.Name = <span class="string">"john"</span></span><br><span class="line">	<span class="comment">//c.Name = "test" //错误写法</span></span><br><span class="line">	fmt.Println(c)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h51slbi2rkj20he00taa2.jpg" alt="image-20220810172107115"></p>
<ul>
<li>如果一个<code>struct</code> 嵌套了一个<code>有名结构体</code>，这种模式就是<code>组合</code>，如果是<code>组合</code>关系，那么在访问<code>组合的结构体的字段或方法</code>时，必须带上结构体的名字</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> A <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> B <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span></span><br><span class="line">	score <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *B)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"B SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *B)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"B Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> D <span class="keyword">struct</span> &#123;</span><br><span class="line">	a A</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//注意下面的写法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> d D</span><br><span class="line">	d.a.Name = <span class="string">"tom"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>嵌套匿名结构体后，也可以在创建结构体变量(实例)时，<code>直接指定</code>各个匿名结构体字段的值</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> A <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> B <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span></span><br><span class="line">	score <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *B)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"B SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *B)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"B Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> C <span class="keyword">struct</span> &#123;</span><br><span class="line">	A</span><br><span class="line">	B</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//方式一</span></span><br><span class="line">	c1 := C&#123;A&#123;<span class="string">"tom"</span>, <span class="number">10</span>&#125;, B&#123;<span class="string">"jack"</span>, <span class="number">100.0</span>&#125;&#125;</span><br><span class="line">    <span class="comment">//方式二: 不需要担心顺序问题</span></span><br><span class="line">	c2 := C&#123;</span><br><span class="line">		A&#123;</span><br><span class="line">			Name: <span class="string">"tom1"</span>,</span><br><span class="line">			age:  <span class="number">20</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">		B&#123;</span><br><span class="line">			Name:  <span class="string">"jack1"</span>,</span><br><span class="line">			score: <span class="number">99.0</span>,</span><br><span class="line">		&#125;,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"c1="</span>, c1)</span><br><span class="line">	fmt.Println(<span class="string">"c2="</span>, c2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h51th1xwsij20h5016q2z.jpg" alt="image-20220810175137486"></p>
<ul>
<li>下面这段代码,会输出什么结果</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Monster <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> E <span class="keyword">struct</span> &#123;</span><br><span class="line">	Monster</span><br><span class="line">	<span class="keyword">int</span></span><br><span class="line">	n <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> e E</span><br><span class="line">	e.Name = <span class="string">"kkk"</span></span><br><span class="line">	e.Age = <span class="number">300</span></span><br><span class="line">	e.<span class="keyword">int</span> = <span class="number">20</span></span><br><span class="line">	e.n = <span class="number">40</span></span><br><span class="line">	fmt.Println(<span class="string">"e="</span>, e)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h51tmhmx8dj20hb00t74a.jpg" alt="image-20220810175650660"></p>
<p>说明:</p>
<p>1)   如果一个结构体有 int 类型的匿名字段，就<code>不能</code>有<code>第二个</code>。<br>2)   如果需要有多个 int 的字段，则必须给 int 字段<code>指定名字</code></p>
<h2 id="面向对象编程三大特性-多重继承"><a href="#面向对象编程三大特性-多重继承" class="headerlink" title="面向对象编程三大特性-多重继承"></a>面向对象编程三大特性-多重继承</h2><blockquote>
<p>  多重继承其实在前面的案例中已经体现过了</p>
<p>  如一个 <code>struct</code> 嵌套了<code>多个匿名结构体</code>，那么该结构体可以直接访问嵌套的匿名结构体的字段和方法，从而实现了多重继承。</p>
</blockquote>
<ul>
<li>案例说明</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> A <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *A)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"A Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> B <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span></span><br><span class="line">	score <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *B)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"B SayOk"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *B)</span> <span class="title">Hello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"B Hello"</span>, a.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//下面这就是多重继承</span></span><br><span class="line"><span class="keyword">type</span> C <span class="keyword">struct</span> &#123;</span><br><span class="line">	A</span><br><span class="line">	B</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h2><blockquote>
<p>  按顺序,我们应该讲解多态,但是在讲解多态前,我们需要讲解接口(interface)，因为在 Golang 中多态特性主要是通过接口来体现的。</p>
</blockquote>
<h3 id="接口快速入门"><a href="#接口快速入门" class="headerlink" title="接口快速入门"></a>接口快速入门</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个接口</span></span><br><span class="line"><span class="keyword">type</span> Usb <span class="keyword">interface</span> &#123;</span><br><span class="line">	<span class="comment">//声明两个没有实现的方法</span></span><br><span class="line">	Start()</span><br><span class="line">	Stop()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Phone <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//让 Phone实现 Usb接口的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Phone)</span> <span class="title">Start</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"手机开始工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Phone)</span> <span class="title">Stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"手机停止工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Camera <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//让 Camera 实现 Usb接口的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Camera)</span> <span class="title">Start</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"相机开始工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Camera)</span> <span class="title">Stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"相机停止工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Computer <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Computer)</span> <span class="title">Working</span><span class="params">(usb Usb)</span></span> &#123;</span><br><span class="line">	usb.Start()</span><br><span class="line">	usb.Stop()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	computer := Computer&#123;&#125;</span><br><span class="line">	phone := Phone&#123;&#125;</span><br><span class="line">	camera := Camera&#123;&#125;</span><br><span class="line"></span><br><span class="line">	computer.Working(phone)</span><br><span class="line">	computer.Working(camera)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h52tssg7ruj20hq01wdfv.jpg" alt="image-20220811144826030"></p>
<blockquote>
<p>  理解接口是什么东西了吗?</p>
<p>  我的理解就是,如果一个<code>结构体</code>想要用<code>其它结构体</code>的函数,就需要声明一个<code>接口</code>,接口中写入跟<code>被使用结构体</code>同名的<code>函数名称</code>,然后在<code>目前结构体</code>的<code>方法</code>中声明<code>接口</code>的一个<code>实例</code>,然后使用该<code>实例</code>来调用<code>被使用结构体</code>的<code>方法</code>,可能理解起来比较抽象</p>
<p>  interface 类型可以定义一组方法，但是这些不需要实现。并且 interface 不能包含任何变量。到某个自定义类型(比如结构体 Phone)要使用的时候,在根据具体情况把这些方法写出来(实现)</p>
</blockquote>
<h3 id="基本语法-2"><a href="#基本语法-2" class="headerlink" title="基本语法"></a>基本语法</h3><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h52uisnto3j20mz04a3yr.jpg" alt="image-20220811151327049"></p>
<h3 id="小结说明"><a href="#小结说明" class="headerlink" title="小结说明"></a>小结说明</h3><p>1) 接口里的所有方法都没有方法体，即接口的方法都是没有实现的方法。接口体现了程序设计的多态和高内聚低偶合的思想。<br>2) Golang中的接口，不需要显式的实现。只要一个变量，含有接口类型中的所有方法，那么这个变量就实现这个接口。因此，Golang 中没有 implement 这样的关键字</p>
<h3 id="注意事项和细节-2"><a href="#注意事项和细节-2" class="headerlink" title="注意事项和细节"></a>注意事项和细节</h3><ol>
<li><code>接口本身</code>不能创建实例,但是可以指向一个<code>实现了该接口</code>的自定义类型的<code>变量</code>(实例)</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Interface <span class="keyword">interface</span> &#123;</span><br><span class="line">	SayOk()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Stu <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Stu)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"Stu SayOk()"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> stu Stu</span><br><span class="line">	<span class="keyword">var</span> a Interface = stu	<span class="comment">//相当与stu实例将它的 SayOk 方法的具体实现,传递给了接口类型变量 a</span></span><br><span class="line">	a.SayOk()	<span class="comment">//然后 a 就可以自由使用 SayOk 方法了</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>接口中所有的方法都<code>没有</code>方法体,即都是<code>没有实现的方法</code>。</p>
</li>
<li><p>在 Golang 中，一个<code>自定义类型</code>需要将某个接口的<code>所有方法</code>都实现，我们说这个<code>自定义类型</code>实现了该接口。</p>
</li>
<li><p>一个<code>自定义类型</code>只有实现了某个接口，才能将该自定义类型的<code>实例</code>(变量)赋给接口类型</p>
</li>
<li><p>只要是<code>自定义数据类型</code>，就可以实现接口，<code>不仅仅</code>是结构体类型。</p>
</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Interface <span class="keyword">interface</span> &#123;</span><br><span class="line">	SayOk()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> integer <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(i integer)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"integer SayOk i ="</span>, i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> i integer = <span class="number">10</span></span><br><span class="line">	<span class="keyword">var</span> b Interface = i</span><br><span class="line">	b.SayOk()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>一个<code>自定义类型</code>可以实现多个接口</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> InterfaceA <span class="keyword">interface</span> &#123;</span><br><span class="line">	SayOk()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> InterfaceB <span class="keyword">interface</span> &#123;</span><br><span class="line">	SayHello()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Stu <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Stu)</span> <span class="title">SayOk</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"Stu SayOk()"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Stu)</span> <span class="title">SayHello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"Stu SayHello()"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> stu Stu</span><br><span class="line">	<span class="keyword">var</span> a InterfaceA = stu</span><br><span class="line">	<span class="keyword">var</span> b InterfaceB = stu</span><br><span class="line">	a.SayOk()</span><br><span class="line">	b.SayHello()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="7">
<li><p>Golang<code>接口</code>中不能有<code>任何变量</code></p>
</li>
<li><p>一个接口(比如 A 接口)可以继承多个别的接口(比如 B,C 接口)，这时如果要实现 A 接口，也必须将 B,C 接口的方法也全部实现。</p>
</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> InterfaceA <span class="keyword">interface</span> &#123;</span><br><span class="line">	SayA()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> InterfaceB <span class="keyword">interface</span> &#123;</span><br><span class="line">	SayB()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> InterfaceC <span class="keyword">interface</span> &#123;</span><br><span class="line">	InterfaceA</span><br><span class="line">	InterfaceB</span><br><span class="line">	SayC()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果需要实现InterfaceA, 就需要将 InterfaceB 与 InterfaceC 的方法都实现</span></span><br><span class="line"><span class="keyword">type</span> Stu <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Stu)</span> <span class="title">SayA</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"Stu SayA()"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Stu)</span> <span class="title">SayB</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"Stu SayB()"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Stu)</span> <span class="title">SayC</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"Stu SayC()"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> stu Stu</span><br><span class="line">	<span class="keyword">var</span> a InterfaceA = stu</span><br><span class="line">	a.SayA()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="9">
<li><p>interface类型默认是一个<code>指针</code>(引用类型)，如果没有对interface<code>初始化</code>就使用，那么会输出nil</p>
</li>
<li><p>空接口 interface{} 没有任何方法，所以所有类型都实现了空接口, 即我们可以把任何一个变量赋给空接口。</p>
</li>
</ol>
<h3 id="接口编程的最佳实践"><a href="#接口编程的最佳实践" class="headerlink" title="接口编程的最佳实践"></a>接口编程的最佳实践</h3><blockquote>
<p>  实现对 Hero 结构体切片的排序: sort.Sort(data Interface)</p>
<p>  根据官网提供的sort方法我们可以知道:</p>
<p>  1.接口类型已经在Sort包中定义好了</p>
<p>  2.调用接口中抽象方法的函数已经在Sort自己的包中定义好了(<code>sort.Sort(接口实例)</code>这个就是)</p>
<p>  3.需要我们自己实现 Len() Less() Swap() 三个方法来实现Sort接口中的抽象类</p>
<p>  4.我们只需要直接使用 sort.Sort() 传入自己结构体的实例即可</p>
<p>  官网链接: <a href="https://pkg.go.dev/sort#Interface" target="_blank" rel="noopener">https://pkg.go.dev/sort#Interface</a></p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h53zzm41o6j20wv04ngm3.jpg" alt="image-20220812150811059"></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h53yqwkcegj21220jfdjf.jpg" alt="image-20220812142509163"></p>
<blockquote>
<p>  <a href="https://cs.opensource.google/go/go/+/refs/tags/go1.19:src/sort/sort.go;l=14" target="_blank" rel="noopener">https://cs.opensource.google/go/go/+/refs/tags/go1.19:src/sort/sort.go;l=14</a></p>
<p>  下面是官网 sort.Sort() 中的一个例子,我们可以进行套用</p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h53z2actc8j20vl0o7te6.jpg" alt="image-20220812143608564"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"math/rand"</span></span><br><span class="line">	<span class="string">"sort"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Hero <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//声明一个数组结构体</span></span><br><span class="line"><span class="keyword">type</span> HeroSlice []Hero</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(x HeroSlice)</span> <span class="title">Len</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">len</span>(x)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(x HeroSlice)</span> <span class="title">Less</span><span class="params">(i, j <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	<span class="comment">//按照Age进行升序排序</span></span><br><span class="line">	<span class="keyword">return</span> x[i].Age &lt; x[j].Age	<span class="comment">//这里小于号当做是升序排列,大于号当做是降序排列</span></span><br><span class="line">	<span class="comment">//按照Name进行升序排序</span></span><br><span class="line">	<span class="comment">//return x[i].Name &lt; x[j].Name</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(x HeroSlice)</span> <span class="title">Swap</span><span class="params">(i, j <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	x[i], x[j] = x[j], x[i]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> heroes HeroSlice <span class="comment">//HeroSlice 是一个数组结构体</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//循环进行初始化赋值操作</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		hero := Hero&#123;</span><br><span class="line">			Name: fmt.Sprintf(<span class="string">"英雄|%d"</span>, rand.Intn(<span class="number">100</span>)),</span><br><span class="line">			Age:  rand.Intn(<span class="number">100</span>),</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//将初始化好的新一条数据加入到heroes数组中</span></span><br><span class="line">		heroes = <span class="built_in">append</span>(heroes, hero)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"对Age字段排序前"</span>)</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> heroes &#123;</span><br><span class="line">		fmt.Println(<span class="string">"Name="</span>, v.Name, <span class="string">"Age="</span>, v.Age)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//对数组 heroes 进行排序</span></span><br><span class="line">	sort.Sort(heroes)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"对Age字段排序后"</span>)</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> heroes &#123;</span><br><span class="line">		fmt.Println(<span class="string">"Name="</span>, v.Name, <span class="string">"Age="</span>, v.Age)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24egy1h53zwcoq9xj20hp08yjs2.jpg" alt="image-20220812150502416"></p>
<h3 id="实现接口-vs-继承"><a href="#实现接口-vs-继承" class="headerlink" title="实现接口 vs 继承"></a>实现接口 vs 继承</h3><blockquote>
<p>  现在有一只猴子,它只会爬树,但是他想学会飞翔和游泳</p>
<p>  请使用接口实现这个案例</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Skill <span class="keyword">interface</span> &#123;</span><br><span class="line">	Flying()</span><br><span class="line">	Swimming()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//基础结构体</span></span><br><span class="line"><span class="keyword">type</span> Monkey <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Monkey)</span> <span class="title">climbing</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(m.Name, <span class="string">"猴子生来会爬树..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//实现抽象方法</span></span><br><span class="line"><span class="keyword">type</span> SuperMonkey <span class="keyword">struct</span> &#123;</span><br><span class="line">	Monkey	<span class="comment">//继承</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *SuperMonkey)</span> <span class="title">Flying</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"你现在可以飞了!"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *SuperMonkey)</span> <span class="title">Swimming</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"你现在可以游泳了!"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//继承Monkey</span></span><br><span class="line"><span class="keyword">type</span> LittleMonkey <span class="keyword">struct</span> &#123;</span><br><span class="line">	Monkey <span class="comment">//继承</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用接口的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(l *LittleMonkey)</span> <span class="title">getSkill</span><span class="params">(skill Skill)</span></span> &#123;</span><br><span class="line">	skill.Flying()</span><br><span class="line">	skill.Swimming()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	monkey := LittleMonkey&#123;Monkey&#123;<span class="string">"悟空"</span>&#125;&#125;</span><br><span class="line">	superMonkey := SuperMonkey&#123;Monkey&#123;<span class="string">"卡卡罗特"</span>&#125;&#125;</span><br><span class="line">	monkey.climbing()</span><br><span class="line">	monkey.getSkill(&amp;superMonkey)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5448u8uobj20hj01lq2z.jpg" alt="image-20220812173524727"></p>
<p><strong>说明:</strong></p>
<ul>
<li>继承的价值主要在于:解决代码的复用性和可维护性。</li>
<li>接口的价值主要在于:设计，设计好各种规范(方法)，让其它自定义类型去实现这些方法。</li>
</ul>
<h2 id="面向对象编程-多态"><a href="#面向对象编程-多态" class="headerlink" title="面向对象编程-多态"></a>面向对象编程-多态</h2><blockquote>
<p>  变量(实例)具有多种形态。面向对象的第三大特征，在 Go 语言，多态特征是通过接口实现的。可以按照统一的接口来调用不同的实现。这时接口变量就呈现不同的形态。</p>
</blockquote>
<h3 id="快速入门-7"><a href="#快速入门-7" class="headerlink" title="快速入门"></a>快速入门</h3><blockquote>
<p>  在前面的 Usb 接口案例，Usb usb ，既可以接收手机变量，又可以接收相机变量，就体现了 Usb 接口多态特性</p>
</blockquote>
<p>详情参考本文:<a href="###接口快速入门">接口快速入门</a></p>
<h3 id="接口体现多态的两种形式"><a href="#接口体现多态的两种形式" class="headerlink" title="接口体现多态的两种形式"></a>接口体现多态的两种形式</h3><ul>
<li>多态参数</li>
</ul>
<blockquote>
<p>  在前面的 Usb 接口案例，Usb usb ，即可以接收手机变量，又可以接收相机变量，就体现了 Usb 接口多态。</p>
</blockquote>
<ul>
<li>多态数组</li>
</ul>
<blockquote>
<p>  演示一个案例:给 Usb 数组中，存放 Phone 结构体 和 Camera 结构体变量</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个接口</span></span><br><span class="line"><span class="keyword">type</span> Usb <span class="keyword">interface</span> &#123;</span><br><span class="line">	<span class="comment">//声明两个没有实现的方法</span></span><br><span class="line">	Start()</span><br><span class="line">	Stop()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Phone <span class="keyword">struct</span> &#123;</span><br><span class="line">	name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//让 Phone实现 Usb接口的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Phone)</span> <span class="title">Start</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"手机开始工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Phone)</span> <span class="title">Stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"手机停止工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Camera <span class="keyword">struct</span> &#123;</span><br><span class="line">	name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//让 Camera 实现 Usb接口的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Camera)</span> <span class="title">Start</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"相机开始工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Camera)</span> <span class="title">Stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"相机停止工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Computer <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Computer)</span> <span class="title">Working</span><span class="params">(usb Usb)</span></span> &#123;</span><br><span class="line">	usb.Start()</span><br><span class="line">	usb.Stop()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义一个Usb接口数组,可以存放 Phone 和 Camera 的结构体变量</span></span><br><span class="line">	<span class="comment">//这里就体现出多态数组</span></span><br><span class="line">	<span class="keyword">var</span> arrUsb [<span class="number">3</span>]Usb</span><br><span class="line">	arrUsb[<span class="number">0</span>] = Phone&#123;<span class="string">"iphone"</span>&#125;</span><br><span class="line">	arrUsb[<span class="number">1</span>] = Phone&#123;<span class="string">"vivo"</span>&#125;</span><br><span class="line">	arrUsb[<span class="number">2</span>] = Camera&#123;<span class="string">"尼康"</span>&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(arrUsb)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h2><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h54xqk79gnj20ov0bnta6.jpg" alt="image-20220813103548917"></p>
<h3 id="基本介绍-4"><a href="#基本介绍-4" class="headerlink" title="基本介绍"></a>基本介绍</h3><blockquote>
<p>  类型断言，由于接口是一般类型，不知道具体类型，如果要转成具体类型，就需要使用类型断言</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> x <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	<span class="keyword">var</span> b2 <span class="keyword">float32</span> = <span class="number">1.1</span></span><br><span class="line">	x = b2	<span class="comment">//空接口,可以接收任何类型</span></span><br><span class="line">	y := x.(<span class="keyword">float32</span>)</span><br><span class="line">	fmt.Printf(<span class="string">"y的类型是 %T, 值是 %v\n"</span>, y, y)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h54xyroz29j20h700tmx5.jpg" alt="image-20220813104344257"></p>
<p><strong>说明:</strong></p>
<ul>
<li>在进行类型断言时，如果类型不匹配，就会报 panic, 因此进行类型断言时，要确保原来的空接口指向的就是断言的类型</li>
<li>如何在进行断言时，带上检测机制，如果成功就 ok,否则也不要报 panic</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> x <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	<span class="keyword">var</span> b2 <span class="keyword">float32</span> = <span class="number">6.5</span></span><br><span class="line">	x = b2 <span class="comment">//空接口,可以接收任何类型</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//类型断言(带检测)</span></span><br><span class="line">	<span class="keyword">if</span> y, ok := x.(<span class="keyword">float32</span>); ok &#123;</span><br><span class="line">		fmt.Println(<span class="string">"convert success"</span>)</span><br><span class="line">		fmt.Printf(<span class="string">"y的类型是 %T , 值是=%v\n"</span>, y, y)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"convert fail"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"继续执行..."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h54y6pcdl2j20h601jwei.jpg" alt="image-20220813105121739"></p>
<h3 id="最佳实践一"><a href="#最佳实践一" class="headerlink" title="最佳实践一"></a>最佳实践一</h3><blockquote>
<p>  在前面的 Usb 接口案例做改进:<br>  给 Phone 结构体增加一个特有的方法 call(), 当 Usb 接口接收的是 Phone 变量时，还需要调用 call</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个接口</span></span><br><span class="line"><span class="keyword">type</span> Usb <span class="keyword">interface</span> &#123;</span><br><span class="line">	<span class="comment">//声明两个没有实现的方法</span></span><br><span class="line">	Start()</span><br><span class="line">	Stop()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Phone <span class="keyword">struct</span> &#123;</span><br><span class="line">	name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//让 Phone实现 Usb接口的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Phone)</span> <span class="title">Start</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"手机开始工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Phone)</span> <span class="title">Stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"手机停止工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//只有Phone拥有此方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p Phone)</span> <span class="title">Call</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"手机正在打电话"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Camera <span class="keyword">struct</span> &#123;</span><br><span class="line">	name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//让 Camera 实现 Usb接口的方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Camera)</span> <span class="title">Start</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"相机开始工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Camera)</span> <span class="title">Stop</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"相机停止工作..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Computer <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Computer)</span> <span class="title">Working</span><span class="params">(usb Usb)</span></span> &#123;</span><br><span class="line">	usb.Start()</span><br><span class="line">	<span class="comment">//如果 usb 是指向 Phone 结构体变量, 则还需要调用Call方法</span></span><br><span class="line">	<span class="keyword">if</span> phone, ok := usb.(Phone); ok &#123;</span><br><span class="line">		phone.Call()</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	usb.Stop()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义一个Usb接口数组,可以存放 Phone 和 Camera 的结构体变量</span></span><br><span class="line">	<span class="comment">//这里就体现出多态数组</span></span><br><span class="line">	<span class="keyword">var</span> arrUsb [<span class="number">3</span>]Usb</span><br><span class="line">	arrUsb[<span class="number">0</span>] = Phone&#123;<span class="string">"iphone"</span>&#125;</span><br><span class="line">	arrUsb[<span class="number">1</span>] = Phone&#123;<span class="string">"vivo"</span>&#125;</span><br><span class="line">	arrUsb[<span class="number">2</span>] = Camera&#123;<span class="string">"尼康"</span>&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//遍历 arrUsb 数组</span></span><br><span class="line">	<span class="keyword">var</span> computer Computer</span><br><span class="line">	<span class="keyword">for</span> _, v := <span class="keyword">range</span> arrUsb &#123;</span><br><span class="line">		computer.Working(v)</span><br><span class="line">		fmt.Println()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h552s5vrm8j20h704baa7.jpg" alt="image-20220813133022782"></p>
<h3 id="最佳实践二"><a href="#最佳实践二" class="headerlink" title="最佳实践二"></a>最佳实践二</h3><blockquote>
<p>  写一函数，循环判断传入参数的类型:</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TypeJudge</span><span class="params">(items ...<span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> index, x := <span class="keyword">range</span> items &#123;</span><br><span class="line">		<span class="keyword">switch</span> x.(<span class="keyword">type</span>) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="keyword">bool</span>:</span><br><span class="line">			fmt.Printf(<span class="string">"第%v个参数是 bool 类型, 值是%v\n"</span>, index, x)</span><br><span class="line">		<span class="keyword">case</span> <span class="keyword">float32</span>:</span><br><span class="line">			fmt.Printf(<span class="string">"第%v个参数是 float32 类型, 值是%v\n"</span>, index, x)</span><br><span class="line">		<span class="keyword">case</span> <span class="keyword">float64</span>:</span><br><span class="line">			fmt.Printf(<span class="string">"第%v个参数是 float64 类型, 值是%v\n"</span>, index, x)</span><br><span class="line">		<span class="keyword">case</span> <span class="keyword">int</span>, <span class="keyword">int32</span>, <span class="keyword">int64</span>:</span><br><span class="line">			fmt.Printf(<span class="string">"第%v个参数是 整数类型, 值是%v\n"</span>, index, x)</span><br><span class="line">		<span class="keyword">case</span> <span class="keyword">string</span>:</span><br><span class="line">			fmt.Printf(<span class="string">"第%v个参数是 string 类型, 值是%v\n"</span>, index, x)</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Printf(<span class="string">"第%v个参数是  不确定的类型, 值是%v\n"</span>, index, x)</span><br><span class="line"></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> v1 <span class="keyword">float32</span> = <span class="number">1.1</span></span><br><span class="line">	<span class="keyword">var</span> v2 <span class="keyword">float64</span> = <span class="number">1.2</span></span><br><span class="line">	<span class="keyword">var</span> v3 <span class="keyword">int32</span> = <span class="number">30</span></span><br><span class="line">	<span class="keyword">var</span> name <span class="keyword">string</span> = <span class="string">"tom"</span></span><br><span class="line">	address := <span class="string">"北京"</span></span><br><span class="line">	v4 := <span class="number">300</span></span><br><span class="line"></span><br><span class="line">	TypeJudge(v1, v2, v3, name, address, v4)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h553als143j20hb02pdg2.jpg" alt="image-20220813134806710"></p>
<h1 id="项目"><a href="#项目" class="headerlink" title="项目"></a>项目</h1><h2 id="家庭收支记账软件项目"><a href="#家庭收支记账软件项目" class="headerlink" title="家庭收支记账软件项目"></a>家庭收支记账软件项目</h2><h3 id="项目开发流程说明"><a href="#项目开发流程说明" class="headerlink" title="项目开发流程说明"></a>项目开发流程说明</h3><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h57kaux6yaj20lx0aygmk.jpg" alt="image-20220815170739823"></p>
<h3 id="项目需求说明"><a href="#项目需求说明" class="headerlink" title="项目需求说明"></a>项目需求说明</h3><p>1) 模拟实现基于文本界面的《家庭记账软件》<br>2) 该软件能够记录家庭的收入、支出，并能够打印收支明细表</p>
<h3 id="项目代码实现-面向过程"><a href="#项目代码实现-面向过程" class="headerlink" title="项目代码实现-面向过程"></a>项目代码实现-面向过程</h3><blockquote>
<p>  目前只实现其过程,等完成这个项目需求之后,我们再将其改为面向对象方式实现</p>
<p>  目前只在一个main.go中实现功能</p>
</blockquote>
<h4 id="功能一-实现主菜单"><a href="#功能一-实现主菜单" class="headerlink" title="功能一:实现主菜单"></a>功能一:实现主菜单</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//key接收用户输入的操作</span></span><br><span class="line">	key := <span class="string">""</span></span><br><span class="line">	<span class="comment">//loop控制是否退出</span></span><br><span class="line">	loop := <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//显示主菜单</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"----------------家庭收支记账软件----------------"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"1. 收支明细"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"2. 登记收入"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"3. 登记支出"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"q. 退出软件"</span>)</span><br><span class="line"></span><br><span class="line">		fmt.Println(<span class="string">"请选择1|2|3|q: "</span>)</span><br><span class="line">		fmt.Scanln(&amp;key)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">switch</span> key &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"1"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"----------------当前收支明细记录----------------"</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"2"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"登记收入"</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"3"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"登记支出"</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"q"</span>:</span><br><span class="line">			loop = <span class="literal">false</span></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Println(<span class="string">"请输入正确的选项!"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> !loop &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"您已退出[家庭记账软件]"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h57l9l24egj20j20ct753.jpg" alt="image-20220815174102141"></p>
<h4 id="功能二-显示明细和登记收入"><a href="#功能二-显示明细和登记收入" class="headerlink" title="功能二:显示明细和登记收入"></a>功能二:显示明细和登记收入</h4><ul>
<li>定义变量来记录余额(balance)、每次收支的金额(money), 每次收支的说明(note)</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//key接收用户输入的操作</span></span><br><span class="line">key := <span class="string">""</span></span><br><span class="line"><span class="comment">//loop控制是否退出</span></span><br><span class="line">loop := <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//定义账户的余额</span></span><br><span class="line">balance := <span class="number">10000.0</span></span><br><span class="line"><span class="comment">//每次每次收支的金额</span></span><br><span class="line">money := <span class="number">0.0</span></span><br><span class="line"><span class="comment">//每次收支的说明</span></span><br><span class="line">note := <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//收支的详情使用字符串来记录</span></span><br><span class="line"><span class="comment">//当有收支时,只需要对details进行拼接处理即可</span></span><br><span class="line">title := <span class="string">"收支\t账户金额\t收支金额\t说    明"</span> <span class="comment">//收支明细的标题</span></span><br><span class="line">details := <span class="string">""</span></span><br></pre></td></tr></table></figure>

<ul>
<li>收入明细实现</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> key &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"1"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"----------------当前收支明细记录----------------"</span>)</span><br><span class="line">			fmt.Println(details)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"2"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"请输入收入金额:"</span>)</span><br><span class="line">			fmt.Scanln(&amp;money)</span><br><span class="line">			balance += money</span><br><span class="line">			fmt.Println(<span class="string">"本次收入说明:"</span>)</span><br><span class="line">			fmt.Scanln(&amp;note)</span><br><span class="line">			<span class="comment">//将这个收入情况拼接到details变量</span></span><br><span class="line">			details += fmt.Sprintf(<span class="string">"\n收入\t%v\t\t%v\t\t%v"</span>, balance, money, note)</span><br></pre></td></tr></table></figure>

<h4 id="功能三-登记支出的功能"><a href="#功能三-登记支出的功能" class="headerlink" title="功能三:登记支出的功能"></a>功能三:登记支出的功能</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">"3"</span>:</span><br><span class="line">	fmt.Println(<span class="string">"请输入支出金额:"</span>)</span><br><span class="line">	fmt.Scanln(&amp;money)</span><br><span class="line">	<span class="keyword">if</span> money &gt; balance &#123;</span><br><span class="line">		fmt.Println(<span class="string">"余额不足"</span>)</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	&#125;</span><br><span class="line">	balance -= money</span><br><span class="line">	fmt.Println(<span class="string">"本次支出说明:"</span>)</span><br><span class="line">	fmt.Scanln(&amp;note)</span><br><span class="line">	<span class="comment">//将这个收入情况拼接到details变量</span></span><br><span class="line">	details += fmt.Sprintf(<span class="string">"\n支出\t%v\t\t%v\t\t%v"</span>, balance, money, note)</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h57lvf6sybj20k10ay0tg.jpg" alt="image-20220815180202077"></p>
<h4 id="代码改进"><a href="#代码改进" class="headerlink" title="代码改进"></a>代码改进</h4><ul>
<li>用户输入 <code>q</code>退出时，给出提示<code>确定要退出吗?(y/n)</code>，必须输入正确的 <code>y/n</code> ，否则循环输入指令，直到输入 y 或者 n</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="string">"q"</span>:</span><br><span class="line">	exit_key := <span class="string">""</span></span><br><span class="line">	fmt.Println(<span class="string">"确定要退出吗?(y/n)"</span>)</span><br><span class="line">	fmt.Scanln(&amp;exit_key)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> exit_key == <span class="string">"y"</span> &#123;</span><br><span class="line">			loop = <span class="literal">false</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> exit_key == <span class="string">"n"</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"你的输入有误,请重新输入!(y/n)"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>当没有任何收支明细时，提示 <code>当前没有收支明细... 来一笔吧!</code></li>
</ul>
<blockquote>
<p>  下面是完整的一段代码</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//key接收用户输入的操作</span></span><br><span class="line">	key := <span class="string">""</span></span><br><span class="line">	<span class="comment">//loop控制是否退出</span></span><br><span class="line">	loop := <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义账户的余额</span></span><br><span class="line">	balance := <span class="number">10000.0</span></span><br><span class="line">	<span class="comment">//每次每次收支的金额</span></span><br><span class="line">	money := <span class="number">0.0</span></span><br><span class="line">	<span class="comment">//每次收支的说明</span></span><br><span class="line">	note := <span class="string">""</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//收支的详情使用字符串来记录</span></span><br><span class="line">	<span class="comment">//当有收支时,只需要对details进行拼接处理即可</span></span><br><span class="line">	title := <span class="string">"收支\t账户金额\t收支金额\t说    明"</span> <span class="comment">//收支明细的标题</span></span><br><span class="line">	details := <span class="string">""</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//显示主菜单</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"----------------家庭收支记账软件----------------"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"1. 收支明细"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"2. 登记收入"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"3. 登记支出"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"q. 退出软件"</span>)</span><br><span class="line"></span><br><span class="line">		fmt.Println(<span class="string">"请选择1|2|3|q: "</span>)</span><br><span class="line">		fmt.Scanln(&amp;key)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">switch</span> key &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"1"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"----------------当前收支明细记录----------------"</span>)</span><br><span class="line">			<span class="keyword">if</span> details == <span class="string">""</span> &#123;</span><br><span class="line">				fmt.Println(<span class="string">"当前没有收支明细... 来一笔吧!"</span>)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				fmt.Println(title)</span><br><span class="line">				fmt.Println(details)</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"2"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"请输入收入金额:"</span>)</span><br><span class="line">			fmt.Scanln(&amp;money)</span><br><span class="line">			balance += money</span><br><span class="line">			fmt.Println(<span class="string">"本次收入说明:"</span>)</span><br><span class="line">			fmt.Scanln(&amp;note)</span><br><span class="line">			<span class="comment">//将这个收入情况拼接到details变量</span></span><br><span class="line">			details += fmt.Sprintf(<span class="string">"收入\t%v\t\t%v\t\t%v"</span>, balance, money, note)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">case</span> <span class="string">"3"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"请输入支出金额:"</span>)</span><br><span class="line">			fmt.Scanln(&amp;money)</span><br><span class="line">			<span class="keyword">if</span> money &gt; balance &#123;</span><br><span class="line">				fmt.Println(<span class="string">"余额不足"</span>)</span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">			balance -= money</span><br><span class="line">			fmt.Println(<span class="string">"本次支出说明:"</span>)</span><br><span class="line">			fmt.Scanln(&amp;note)</span><br><span class="line">			<span class="comment">//将这个收入情况拼接到details变量</span></span><br><span class="line">			details += fmt.Sprintf(<span class="string">"支出\t%v\t\t%v\t\t%v"</span>, balance, money, note)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"q"</span>:</span><br><span class="line">			exit_key := <span class="string">""</span></span><br><span class="line">			fmt.Println(<span class="string">"确定要退出吗?(y/n)"</span>)</span><br><span class="line">			fmt.Scanln(&amp;exit_key)</span><br><span class="line">			<span class="keyword">for</span> &#123;</span><br><span class="line">				<span class="keyword">if</span> exit_key == <span class="string">"y"</span> &#123;</span><br><span class="line">					loop = <span class="literal">false</span></span><br><span class="line">					<span class="keyword">break</span></span><br><span class="line">				&#125; <span class="keyword">else</span> <span class="keyword">if</span> exit_key == <span class="string">"n"</span> &#123;</span><br><span class="line">					<span class="keyword">break</span></span><br><span class="line">				&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">					fmt.Println(<span class="string">"你的输入有误,请重新输入!(y/n)"</span>)</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Println(<span class="string">"请输入正确的选项!"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> !loop &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"您已退出[家庭记账软件]"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="项目代码实现-面向对象"><a href="#项目代码实现-面向对象" class="headerlink" title="项目代码实现-面向对象"></a>项目代码实现-面向对象</h3><blockquote>
<p>  实现思路:</p>
<ol>
<li>更改上面面向过程的代码来实现</li>
<li>创建新的结构体,将各个功能分割为该结构体的方法</li>
<li>将各个方法存放到各自单独的文件中,由main主函数进行调用</li>
</ol>
</blockquote>
<ul>
<li>总体代码</li>
</ul>
<blockquote>
<p>  自行将不同的部分放入不同的文件中即可(需要自己引入包),也可以都放入main.go中执行</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//model模块</span></span><br><span class="line"><span class="keyword">type</span> FamilyAccount <span class="keyword">struct</span> &#123;</span><br><span class="line">	key     <span class="keyword">string</span>  <span class="comment">//key接收用户输入的操作</span></span><br><span class="line">	loop    <span class="keyword">bool</span>    <span class="comment">//loop控制是否退出</span></span><br><span class="line">	balance <span class="keyword">float64</span> <span class="comment">//定义账户的余额</span></span><br><span class="line">	money   <span class="keyword">float64</span> <span class="comment">//每次每次收支的金额</span></span><br><span class="line">	note    <span class="keyword">string</span>  <span class="comment">//每次收支的说明</span></span><br><span class="line">	<span class="comment">//收支的详情使用字符串来记录</span></span><br><span class="line">	title   <span class="keyword">string</span> <span class="comment">//收支明细的标题</span></span><br><span class="line">	details <span class="keyword">string</span> <span class="comment">//当有收支时,只需要对details进行拼接处理即可</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewFmailyAccount</span><span class="params">()</span> *<span class="title">FamilyAccount</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;FamilyAccount&#123;</span><br><span class="line">		key:     <span class="string">""</span>,</span><br><span class="line">		loop:    <span class="literal">true</span>,</span><br><span class="line">		balance: <span class="number">10000.0</span>,</span><br><span class="line">		money:   <span class="number">0.0</span>,</span><br><span class="line">		note:    <span class="string">""</span>,</span><br><span class="line">		title:   <span class="string">"收支\t账户金额\t收支金额\t说    明"</span>,</span><br><span class="line">		details: <span class="string">""</span>,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *FamilyAccount)</span> <span class="title">showDetails</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"----------------当前收支明细记录----------------"</span>)</span><br><span class="line">	<span class="keyword">if</span> f.details == <span class="string">""</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"当前没有收支明细... 来一笔吧!"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Print(f.title)</span><br><span class="line">		fmt.Println(f.details)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *FamilyAccount)</span> <span class="title">income</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"请输入收入金额:"</span>)</span><br><span class="line">	fmt.Scanln(&amp;f.money)</span><br><span class="line">	f.balance += f.money</span><br><span class="line">	fmt.Println(<span class="string">"本次收入说明:"</span>)</span><br><span class="line">	fmt.Scanln(&amp;f.note)</span><br><span class="line">	<span class="comment">//将这个收入情况拼接到details变量</span></span><br><span class="line">	f.details += fmt.Sprintf(<span class="string">"\n收入\t%v\t\t%v\t\t%v"</span>, f.balance, f.money, f.note)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *FamilyAccount)</span> <span class="title">pay</span><span class="params">()</span></span> &#123;</span><br><span class="line">	flag := <span class="literal">true</span> <span class="comment">//判断余额是否足够</span></span><br><span class="line">	fmt.Println(<span class="string">"请输入支出金额:"</span>)</span><br><span class="line">	fmt.Scanln(&amp;f.money)</span><br><span class="line">	<span class="keyword">if</span> f.money &gt; f.balance &#123;</span><br><span class="line">		fmt.Println(<span class="string">"余额不足"</span>)</span><br><span class="line">		flag = <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//如果余额不足,则跳过下面的步骤</span></span><br><span class="line">	<span class="keyword">if</span> flag == <span class="literal">true</span> &#123;</span><br><span class="line">		f.balance -= f.money</span><br><span class="line">		fmt.Println(<span class="string">"本次支出说明:"</span>)</span><br><span class="line">		fmt.Scanln(&amp;f.note)</span><br><span class="line">		<span class="comment">//将这个收入情况拼接到details变量</span></span><br><span class="line">		f.details += fmt.Sprintf(<span class="string">"\n支出\t%v\t\t%v\t\t%v"</span>, f.balance, f.money, f.note)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *FamilyAccount)</span> <span class="title">exit</span><span class="params">()</span></span> &#123;</span><br><span class="line">	exit_key := <span class="string">""</span></span><br><span class="line">	fmt.Println(<span class="string">"确定要退出吗?(y/n)"</span>)</span><br><span class="line">	fmt.Scanln(&amp;exit_key)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> exit_key == <span class="string">"y"</span> &#123;</span><br><span class="line">			f.loop = <span class="literal">false</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> exit_key == <span class="string">"n"</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"你的输入有误,请重新输入!(y/n)"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *FamilyAccount)</span> <span class="title">MainMenu</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"----------------家庭收支记账软件----------------"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"1. 收支明细"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"2. 登记收入"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"3. 登记支出"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"q. 退出软件"</span>)</span><br><span class="line"></span><br><span class="line">		fmt.Println(<span class="string">"请选择1|2|3|q: "</span>)</span><br><span class="line">		fmt.Scanln(&amp;f.key)</span><br><span class="line"></span><br><span class="line">		<span class="keyword">switch</span> f.key &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"1"</span>:</span><br><span class="line">			f.showDetails()</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"2"</span>:</span><br><span class="line">			f.income()</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"3"</span>:</span><br><span class="line">			f.pay()</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"q"</span>:</span><br><span class="line">			f.exit()</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Println(<span class="string">"请输入正确的选项!"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> !f.loop &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> p1 = NewFmailyAccount()</span><br><span class="line"></span><br><span class="line">	p1.MainMenu()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="客户信息关系系统项目"><a href="#客户信息关系系统项目" class="headerlink" title="客户信息关系系统项目"></a>客户信息关系系统项目</h2><h3 id="项目需求分析"><a href="#项目需求分析" class="headerlink" title="项目需求分析"></a>项目需求分析</h3><p>1) 模拟实现基于文本界面的《客户信息管理软件》。<br>2) 该软件能够实现对客户对象的插入、修改和删除(用切片实现)，并能够打印客户明细表</p>
<h3 id="项目界面设计"><a href="#项目界面设计" class="headerlink" title="项目界面设计"></a>项目界面设计</h3><ul>
<li>主菜单界面</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h58gkq0xsij20h407y0st.jpg" alt="image-20220816114416811"></p>
<ul>
<li>添加客户界面</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h58glfd5euj20ju06qq34.jpg" alt="image-20220816114459544"></p>
<ul>
<li>修改客户界面</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h58gm2fgjwj20ja0753yy.jpg" alt="image-20220816114535614"></p>
<ul>
<li>删除客户界面</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h58gmqie2ij20il03kaa6.jpg" alt="image-20220816114614195"></p>
<ul>
<li>客户列表界面</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h58gn9uc3ej20ii04kt92.jpg" alt="image-20220816114645413"></p>
<h3 id="客户关系管理系统的程序框架图"><a href="#客户关系管理系统的程序框架图" class="headerlink" title="客户关系管理系统的程序框架图"></a>客户关系管理系统的程序框架图</h3><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h58mp9liydj20mk0asq3w.jpg" alt="image-20220816151616530"></p>
<h3 id="功能实现"><a href="#功能实现" class="headerlink" title="功能实现"></a>功能实现</h3><h4 id="显示主菜单和退出软件功能"><a href="#显示主菜单和退出软件功能" class="headerlink" title="显示主菜单和退出软件功能"></a>显示主菜单和退出软件功能</h4><ul>
<li>model/customer.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="comment">//声明一个customer结构体,表示一个客户信息</span></span><br><span class="line"><span class="keyword">type</span> Customer <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id     <span class="keyword">int</span></span><br><span class="line">	Name   <span class="keyword">string</span></span><br><span class="line">	Gender <span class="keyword">string</span></span><br><span class="line">	Age    <span class="keyword">int</span></span><br><span class="line">	Phone  <span class="keyword">string</span></span><br><span class="line">	Email  <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用工程模式,返回一个Customer的实例</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewCustomer</span><span class="params">(id <span class="keyword">int</span>, name <span class="keyword">string</span>, gender <span class="keyword">string</span>, age <span class="keyword">int</span>, phone <span class="keyword">string</span>, email <span class="keyword">string</span>)</span> <span class="title">Customer</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> Customer&#123;</span><br><span class="line">		Id:     id,</span><br><span class="line">		Name:   name,</span><br><span class="line">		Gender: gender,</span><br><span class="line">		Age:    age,</span><br><span class="line">		Phone:  phone,</span><br><span class="line">		Email:  email,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>service/customerService.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> service</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"golang_study/object_oriented_programming/KeHuGuanXiGuanLiXiTong/model"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//该 customerService,完成对 customer 的操作,包括</span></span><br><span class="line"><span class="comment">//增删改查</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> customerService <span class="keyword">struct</span> &#123;</span><br><span class="line">	customers []model.Customer</span><br><span class="line">	<span class="comment">//声明一个字段,表示当前切片含有多少个客户</span></span><br><span class="line">	<span class="comment">//该字段后面,还可以作为新客户的 id+1</span></span><br><span class="line">	customerNum <span class="keyword">int</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>view/customerView.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> CustomerView <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//定义必要字段</span></span><br><span class="line">	key  <span class="keyword">string</span> <span class="comment">//接收用户信息</span></span><br><span class="line">	loop <span class="keyword">bool</span>   <span class="comment">//表示是否循环显示主菜单</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//显示主菜单</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *customerView)</span> <span class="title">mainMenu</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"-----------------客户信息管理软件-----------------"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"                 1 添 加 客 户"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"                 2 修 改 客 户"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"                 3 删 除 客 户"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"                 4 客 户 列 表"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"                 5 退      出"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"-----------------------------------------------"</span>)</span><br><span class="line">		fmt.Print(<span class="string">"请选择(1-5):"</span>)</span><br><span class="line">		fmt.Scanln(&amp;c.key)</span><br><span class="line">		<span class="keyword">switch</span> c.key &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"1"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"添 加 客 户"</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"2"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"修 改 客 户"</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"3"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"删 除 客 户"</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"4"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"客 户 列 表"</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"5"</span>:</span><br><span class="line">			c.loop = <span class="literal">false</span></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Println(<span class="string">"你的输入有误，请重新输入..."</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> !c.loop &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"你退出了客户关系管理系统..."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//在main中,创建一个customerView,并运行显示主菜单</span></span><br><span class="line">	customerView := customerView &#123;</span><br><span class="line">		key: <span class="string">""</span>,</span><br><span class="line">		loop: <span class="literal">true</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//显示主菜单</span></span><br><span class="line">	customerView.mainMenu()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="显示客户列表的功能"><a href="#显示客户列表的功能" class="headerlink" title="显示客户列表的功能"></a>显示客户列表的功能</h4><ul>
<li>model/customer.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//返回用户的信息,格式化的字符串</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Customer)</span> <span class="title">GetInfo</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">	info := fmt.Sprintf(<span class="string">"%v\t%v\t%v\t%v\t%v\t%v"</span>, c.id, c.name, c.age, c.gender, c.phone, c.email)</span><br><span class="line">	<span class="keyword">return</span> info</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>service/customerService.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//编写一个函数,可以返回 *CustomerService</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewCustomerService</span><span class="params">()</span> *<span class="title">CustomerService</span></span> &#123;</span><br><span class="line">	<span class="comment">//为了能够看到有客户在切片中,我们初始化一个客户</span></span><br><span class="line">	CustomerService := &amp;CustomerService&#123;&#125;</span><br><span class="line">	CustomerService.customerNum = <span class="number">1</span></span><br><span class="line">	customer := model.NewCustomer(<span class="number">1</span>, <span class="string">"张三"</span>, <span class="string">"男"</span>, <span class="number">20</span>, <span class="string">"112"</span>, <span class="string">"syz15822409222@126.com"</span>)</span><br><span class="line">	CustomerService.customers = <span class="built_in">append</span>(CustomerService.customers, customer)</span><br><span class="line">	<span class="keyword">return</span> CustomerService</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *CustomerService)</span> <span class="title">List</span><span class="params">()</span> []<span class="title">model</span>.<span class="title">Customer</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> c.customers</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>view/customerView.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//显示所有客户的信息</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *customerView)</span> <span class="title">list</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//首先获取到当前所有的客户信息(在切片中)</span></span><br><span class="line">	customers := c.customerService.List()</span><br><span class="line">	fmt.Println(<span class="string">"---------------------客户列表--------------------"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"编号\t姓名\t性别\t年龄\t电话\t邮箱"</span>)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(customers); i++ &#123;</span><br><span class="line">		fmt.Println(customers[i].GetInfo())</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"-------------------客户列表完成-------------------"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h59xde7vi4j20j70kdwg7.jpg" alt="image-20220817181101019"></p>
<h4 id="添加客户的功能"><a href="#添加客户的功能" class="headerlink" title="添加客户的功能"></a>添加客户的功能</h4><ul>
<li>实现思路</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h59x4uqtefj20of0awdhf.jpg" alt="image-20220817180245661"></p>
<ul>
<li>model/customer.go</li>
</ul>
<blockquote>
<p>  增加下面的内容(不手动指定id号,让其自动累加)</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第二种创建Customer实例方法,不带id</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewCustomer2</span><span class="params">(name <span class="keyword">string</span>, gender <span class="keyword">string</span>, age <span class="keyword">int</span>, phone <span class="keyword">string</span>, email <span class="keyword">string</span>)</span> <span class="title">Customer</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> Customer&#123;</span><br><span class="line">		Name:   name,</span><br><span class="line">		Gender: gender,</span><br><span class="line">		Age:    age,</span><br><span class="line">		Phone:  phone,</span><br><span class="line">		Email:  email,</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>service/customerService.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//添加客户端到customer切片</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *CustomerService)</span> <span class="title">Add</span><span class="params">(customer model.Customer)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	<span class="comment">//我们确定一个分配id的规则,就是添加的顺序</span></span><br><span class="line">	c.customerNum++ <span class="comment">//这样我们就不用写id了</span></span><br><span class="line">	customer.Id = c.customerNum</span><br><span class="line">	c.customers = <span class="built_in">append</span>(c.customers, customer)</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>view/customerView.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//得到用户的输入,信息构建新的客户</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *customerView)</span> <span class="title">add</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"---------------------添加客户--------------------"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"姓名:"</span>)</span><br><span class="line">	name := <span class="string">""</span></span><br><span class="line">	fmt.Scanln(&amp;name)</span><br><span class="line">	fmt.Println(<span class="string">"性别"</span>)</span><br><span class="line">	gender := <span class="string">""</span></span><br><span class="line">	fmt.Scanln(&amp;gender)</span><br><span class="line">	fmt.Println(<span class="string">"年龄"</span>)</span><br><span class="line">	age := <span class="number">0</span></span><br><span class="line">	fmt.Scanln(&amp;age)</span><br><span class="line">	fmt.Println(<span class="string">"电话"</span>)</span><br><span class="line">	phone := <span class="string">""</span></span><br><span class="line">	fmt.Scanln(&amp;phone)</span><br><span class="line">	fmt.Println(<span class="string">"邮件"</span>)</span><br><span class="line">	email := <span class="string">""</span></span><br><span class="line">	fmt.Scanln(&amp;email)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//构建一个新的Customer实例</span></span><br><span class="line">	<span class="comment">//注意id号,没有让用户输入,id是唯一的,需要系统分配</span></span><br><span class="line">	customer := model.NewCustomer2(name, gender, age, phone, email)</span><br><span class="line">	<span class="comment">//调用</span></span><br><span class="line">	<span class="keyword">if</span> c.customerService.Add(customer) &#123;</span><br><span class="line">		fmt.Println(<span class="string">"---------------------添加完成--------------------"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"---------------------添加失败--------------------"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h59xbwesfrj20k70kxdhr.jpg" alt="image-20220817180934415"></p>
<h4 id="删除客户的功能"><a href="#删除客户的功能" class="headerlink" title="删除客户的功能"></a>删除客户的功能</h4><ul>
<li>实现思路</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5aoomjz3tj20oo0ajtab.jpg" alt="image-20220818095556737"></p>
<ul>
<li>model/customer.go(没有变化)</li>
<li>service/customerService.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据客户的id删除客户的信息</span></span><br><span class="line"><span class="comment">//首先实现查找客户的id是否存在</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *CustomerService)</span> <span class="title">FindById</span><span class="params">(id <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	index := <span class="number">-1</span></span><br><span class="line">	<span class="comment">//遍历 c.customers 切片</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="built_in">len</span>(c.customers); i++ &#123;</span><br><span class="line">		<span class="keyword">if</span> c.customers[i].Id == id &#123;</span><br><span class="line">			index = i <span class="comment">//找到</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> index</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果id存在,那么删除该用户</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *CustomerService)</span> <span class="title">Delete</span><span class="params">(id <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	index := c.FindById(id)</span><br><span class="line">	<span class="comment">//如果 index = -1, 说明没有这个客户</span></span><br><span class="line">	<span class="keyword">if</span> index == <span class="number">-1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//从切片中删除一个元素</span></span><br><span class="line">	c.customers = <span class="built_in">append</span>(c.customers[:index], c.customers[index+<span class="number">1</span>:]...)	<span class="comment">//注意这里的写法</span></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>view/customerView.go</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//得到用户的id后,删除该id对应的客户</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *customerView)</span> <span class="title">delete</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"---------------------删除客户--------------------"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"请输入待删除客户的id编号(-1退出):"</span>)</span><br><span class="line">	id := <span class="number">-1</span></span><br><span class="line">	fmt.Scanln(&amp;id)</span><br><span class="line">	<span class="keyword">if</span> id == <span class="number">-1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="comment">//放弃删除操作</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"确认是否删除(Y/N):"</span>)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">//定义一个变量,接收下面的for循环是否退出</span></span><br><span class="line">		flag := <span class="literal">false</span></span><br><span class="line">		choice := <span class="string">""</span></span><br><span class="line">		fmt.Scanln(&amp;choice)</span><br><span class="line">		<span class="keyword">switch</span> choice &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"y"</span>, <span class="string">"Y"</span>:</span><br><span class="line">			<span class="keyword">if</span> c.customerService.Delete(id) &#123;</span><br><span class="line">				fmt.Println(<span class="string">"---------------------删除完成--------------------"</span>)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				fmt.Println(<span class="string">"---------------------删除失败--------------------"</span>)</span><br><span class="line">			&#125;</span><br><span class="line">			flag = <span class="literal">true</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">"n"</span>, <span class="string">"N"</span>:</span><br><span class="line">			flag = <span class="literal">true</span></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Println(<span class="string">"您的输入有误,请输入正确的选项!(Y/N)"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//如果 flag == true, 则退出for循环</span></span><br><span class="line">		<span class="keyword">if</span> flag &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5apykw7pvj20kb0jc75z.jpg" alt="image-20220818104008935"></p>
<h4 id="完善退出确认功能"><a href="#完善退出确认功能" class="headerlink" title="完善退出确认功能"></a>完善退出确认功能</h4><ul>
<li>view/customerView.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//退出软件</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *customerView)</span> <span class="title">exit</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	n := <span class="number">0</span> <span class="comment">//给主函数返回一个变量用于判断是否退出</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">//定义一个变量,接收下面的for循环是否退出</span></span><br><span class="line">		flag := <span class="literal">true</span> <span class="comment">//true代表退出循环</span></span><br><span class="line">		fmt.Println(<span class="string">"确认是否退出(Y/N):"</span>)</span><br><span class="line">		choice := <span class="string">""</span></span><br><span class="line">		fmt.Scanln(&amp;choice)</span><br><span class="line">		<span class="keyword">switch</span> choice &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"y"</span>, <span class="string">"Y"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"感谢您的使用,下次再见~"</span>)</span><br><span class="line">			n = <span class="number">1</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">"n"</span>, <span class="string">"N"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"感谢您的喜欢与支持~"</span>)</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Println(<span class="string">"您的输入有误,请输入正确的选项!(Y/N)"</span>)</span><br><span class="line">			flag = <span class="literal">false</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//如果 flag == true, 则退出for循环</span></span><br><span class="line">		<span class="keyword">if</span> flag &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> n</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5armr7kftj20ik0lutah.jpg" alt="image-20220818113759580"></p>
<h4 id="修改客户信息"><a href="#修改客户信息" class="headerlink" title="修改客户信息"></a>修改客户信息</h4><blockquote>
<p>  修改客户信息,需要在<code>customerService</code>与<code>customerView</code>中进行编写</p>
</blockquote>
<ul>
<li>service/customerService.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//根据客户提供的id,对客户的相关个人信息进行修改</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *CustomerService)</span> <span class="title">Alter</span><span class="params">(id <span class="keyword">int</span>, name <span class="keyword">string</span>, gender <span class="keyword">string</span>, age <span class="keyword">int</span>, phone <span class="keyword">string</span>, email <span class="keyword">string</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	index := c.FindById(id)</span><br><span class="line">	<span class="comment">//如果 index = -1, 说明没有这个客户</span></span><br><span class="line">	<span class="keyword">if</span> index == <span class="number">-1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//修改客户信息,按下回车表示不修改</span></span><br><span class="line">	<span class="keyword">if</span> c.customers[index].Name != <span class="string">"\n"</span> &#123;</span><br><span class="line">		c.customers[index].Name = name</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> c.customers[index].Gender != <span class="string">"\n"</span> &#123;</span><br><span class="line">		c.customers[index].Gender = gender</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> c.customers[index].Age != <span class="number">0</span> &#123; <span class="comment">//0表示没有修改</span></span><br><span class="line">		c.customers[index].Age = age</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> c.customers[index].Phone != <span class="string">"\n"</span> &#123;</span><br><span class="line">		c.customers[index].Phone = phone</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> c.customers[index].Email != <span class="string">"\n"</span> &#123;</span><br><span class="line">		c.customers[index].Email = email</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>view/customerView.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改客户信息</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *customerView)</span> <span class="title">alter</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"---------------------修改客户--------------------"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"请输入待删除客户的id编号(-1退出):"</span>)</span><br><span class="line">	id := <span class="number">-1</span></span><br><span class="line">	fmt.Scanln(&amp;id)</span><br><span class="line">	<span class="keyword">if</span> id == <span class="number">-1</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="comment">//放弃修改操作</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	index := c.customerService.FindById(id) <span class="comment">//获取对应id的数组的索引</span></span><br><span class="line">	<span class="keyword">if</span> index == <span class="number">-1</span> &#123;                        <span class="comment">//如果index == -1,说明没有这个用户</span></span><br><span class="line">		fmt.Println(<span class="string">"-----------该id不存在,请检查后重新尝试-----------"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	customers := c.customerService.List() <span class="comment">//获取数组的所有信息</span></span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"姓名(%v):"</span>, customers[index].Name)</span><br><span class="line">	name := customers[index].Name</span><br><span class="line">	fmt.Scanln(&amp;name)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"性别(%v):"</span>, customers[index].Gender)</span><br><span class="line">	gender := customers[index].Gender</span><br><span class="line">	fmt.Scanln(&amp;gender)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"年龄(%v):"</span>, customers[index].Age)</span><br><span class="line">	age := customers[index].Age</span><br><span class="line">	fmt.Scanln(&amp;age)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"电话(%v):"</span>, customers[index].Phone)</span><br><span class="line">	phone := customers[index].Phone</span><br><span class="line">	fmt.Scanln(&amp;phone)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"邮箱(%v):"</span>, customers[index].Email)</span><br><span class="line">	email := customers[index].Email</span><br><span class="line">	fmt.Scanln(&amp;email)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"确认是否修改(Y/N):"</span>)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">//定义一个变量,接收下面的for循环是否退出</span></span><br><span class="line">		flag := <span class="literal">false</span></span><br><span class="line">		choice := <span class="string">""</span></span><br><span class="line">		fmt.Scanln(&amp;choice)</span><br><span class="line">		<span class="keyword">switch</span> choice &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"y"</span>, <span class="string">"Y"</span>:</span><br><span class="line">			<span class="keyword">if</span> c.customerService.Alter(id, name, gender, age, phone, email) &#123;</span><br><span class="line">				fmt.Println(<span class="string">"---------------------修改完成--------------------"</span>)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				fmt.Println(<span class="string">"---------------------修改失败--------------------"</span>)</span><br><span class="line">			&#125;</span><br><span class="line">			flag = <span class="literal">true</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">"n"</span>, <span class="string">"N"</span>:</span><br><span class="line">			flag = <span class="literal">true</span></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Println(<span class="string">"您的输入有误,请输入正确的选项!(Y/N)"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//如果 flag == true, 则退出for循环</span></span><br><span class="line">		<span class="keyword">if</span> flag &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5ayet6s5rj20js0llgnb.jpg" alt="image-20220818153232485"></p>
<blockquote>
<p>  至此,客户信息关系系统完成~</p>
</blockquote>
<h1 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h1><h2 id="打开-关闭文件用到的方法"><a href="#打开-关闭文件用到的方法" class="headerlink" title="打开/关闭文件用到的方法"></a>打开/关闭文件用到的方法</h2><h3 id="func-Open"><a href="#func-Open" class="headerlink" title="func Open"></a>func <a href="https://cs.opensource.google/go/go/+/go1.19:src/os/file.go;l=316" target="_blank" rel="noopener">Open</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func Open(name string) (*File, error)</span><br></pre></td></tr></table></figure>

<p>打开指定文件进行读取。如果成功，则可以使用返回文件上的方法进行读取;关联的文件描述符具有O_RDONLY模式。如果有错误，它的类型将是* pathror。</p>
<h3 id="func-File-Close"><a href="#func-File-Close" class="headerlink" title="func (*File) Close"></a>func (*File) <a href="https://cs.opensource.google/go/go/+/go1.19:src/os/file_posix.go;l=21" target="_blank" rel="noopener">Close</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func (f *File) Close() error</span><br></pre></td></tr></table></figure>

<p>关闭关闭文件，使其无法用于I/O。在支持SetDeadline的文件中，任何等待的I/O操作将被取消，并立即返回ErrClosed错误。如果Close已经被调用，将返回一个错误。</p>
<h2 id="演示案例-1"><a href="#演示案例-1" class="headerlink" title="演示案例"></a>演示案例</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//打开文件</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		概念说明: file的叫法</span></span><br><span class="line"><span class="comment">		1. file 叫 file 对象</span></span><br><span class="line"><span class="comment">		2. file 叫 file 指针</span></span><br><span class="line"><span class="comment">		3. file 叫 file 文件句柄</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	file, err := os.Open(<span class="string">"/usr/local/go/src/golang_study/14-File/filedemo/demo.txt"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"Open file err="</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//通过输出结果可以得知,file就是一个指针</span></span><br><span class="line">	fmt.Printf(<span class="string">"file=%v\n"</span>, file)</span><br><span class="line">	<span class="comment">//关闭文件</span></span><br><span class="line">	err = file.Close()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"Close file err="</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file=&amp;&#123;0xc0000ae120&#125;</span><br></pre></td></tr></table></figure>

<h2 id="读文件操作应用实例"><a href="#读文件操作应用实例" class="headerlink" title="读文件操作应用实例"></a>读文件操作应用实例</h2><ul>
<li>读取文件的内容并显示在终端(带缓冲区的方式)</li>
</ul>
<blockquote>
<p>   使用 os.Open, file.Close, bufio.NewReader(), reader.ReadString 函数和方法.</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"bufio"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"io"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//打开文件</span></span><br><span class="line">	file, err := os.Open(<span class="string">"/usr/local/go/src/golang_study/14-File/filedemo/demo.txt"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"Open file err="</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//当函数退出时, 要及时关闭file</span></span><br><span class="line">	<span class="keyword">defer</span> file.Close() <span class="comment">//要及时关闭file句柄, 否则会有内存泄漏</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//创建一个 *Reader, 是带缓冲的</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		const (</span></span><br><span class="line"><span class="comment">			defaultBufSize = 4096	//默认的缓冲区为 4096</span></span><br><span class="line"><span class="comment">		)</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	reader := bufio.NewReader(file)</span><br><span class="line">	<span class="comment">//循环的读取文件的内容</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		str, err := reader.ReadString(<span class="string">'\n'</span>) <span class="comment">//读到一个换行就结束</span></span><br><span class="line">		<span class="keyword">if</span> err == io.EOF &#123;                  <span class="comment">//io.EOF 表示文件的末尾</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Print(str)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"文件读取结束..."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">123123</span><br><span class="line">456456</span><br><span class="line">789789</span><br><span class="line">文件读取结束...</span><br></pre></td></tr></table></figure>

<ul>
<li>读取文件的内容并显示在终端(使用 ioutil 一次将整个文件读入到内存中)，这种方式<code>适用于文件不大的情况</code>。</li>
</ul>
<blockquote>
<p>   相关方法和函数: ioutil.ReadFile</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"io/ioutil"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//使用ioutil.ReadFile一次性将文件读取到位</span></span><br><span class="line">	file := <span class="string">"/usr/local/go/src/golang_study/14-File/filedemo/demo.txt"</span></span><br><span class="line">	content, err := ioutil.ReadFile(file)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"read file err=%v"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//将读取到的内容显示到终端</span></span><br><span class="line">	<span class="comment">//fmt.Println("%v", content)	//[]byte</span></span><br><span class="line">	fmt.Printf(<span class="string">"%v"</span>, <span class="keyword">string</span>(content)) <span class="comment">//byte</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//我们没有显示的Open文件,因此也不需要显示的Close文件</span></span><br><span class="line">	<span class="comment">//因为, 文件的Open和Close被封装到 ReadFile 函数内部</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">123123</span><br><span class="line">456456</span><br><span class="line">789789</span><br></pre></td></tr></table></figure>

<h2 id="写文件操作应用实例"><a href="#写文件操作应用实例" class="headerlink" title="写文件操作应用实例"></a>写文件操作应用实例</h2><h3 id="func-OpenFile"><a href="#func-OpenFile" class="headerlink" title="func OpenFile"></a>func <a href="https://cs.opensource.google/go/go/+/go1.19:src/os/file.go;l=335" target="_blank" rel="noopener">OpenFile</a></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">func OpenFile(name string, flag int, perm FileMode) (*File, error)</span><br></pre></td></tr></table></figure>

<p>OpenFile是广义的open调用;大多数用户会使用Open或Create。它打开指定标志(O_RDONLY等)的命名文件。如果文件不存在，并且传递了O_CREATE标志，则使用perm模式(在umask之前)创建它。如果成功，就可以使用返回File上的方法进行I/O操作。如果有错误，它的类型将是* pathror。</p>
<ul>
<li>第一个参数: 表示文件的路径</li>
<li>第二个参数: 选项如下(可组合使用)</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> (  </span><br><span class="line">    <span class="comment">// O_RDONLY、O_WRONLY或O_RDWR必须指定一个。</span></span><br><span class="line">    O_RDONLY <span class="keyword">int</span> = sycall.O_RDONLY 	<span class="comment">//只读模式打开文件。</span></span><br><span class="line">    O_WRONLY <span class="keyword">int</span> = sycall.O_WRONLY 	<span class="comment">//只写模式打开文件</span></span><br><span class="line">    O_RDWR <span class="keyword">int</span> = sycall.O_RDWR 		<span class="comment">//读写模式打开文件</span></span><br><span class="line">    <span class="comment">//剩下的值可以输入或输入以控制行为。</span></span><br><span class="line">    O_APPEND <span class="keyword">int</span> = sycall.O_APPEND 	<span class="comment">//写入文件时追加数据。</span></span><br><span class="line">    O_CREATE <span class="keyword">int</span> = sycall.O_CREAT 	<span class="comment">//如果文件不存在，则创建一个新文件。</span></span><br><span class="line">    O_EXCL   <span class="keyword">int</span> = syscall.O_EXCL 	<span class="comment">//与 O_CREATE 一起使用，文件必须不存在。</span></span><br><span class="line">    O_SYNC <span class="keyword">int</span> = sycall.O_SYNC 		<span class="comment">//打开用于同步I/O。</span></span><br><span class="line">    O_TRUNC <span class="keyword">int</span> = sycall.O_TRUNC 	<span class="comment">//如果可能,打开时清空文件</span></span><br><span class="line">）</span><br></pre></td></tr></table></figure>

<ul>
<li>第三个参数: 权限控制(同Linux)</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r =&gt; <span class="number">4</span></span><br><span class="line">w =&gt; <span class="number">2</span></span><br><span class="line">x =&gt; <span class="number">1</span></span><br></pre></td></tr></table></figure>

<h3 id="方式一-3"><a href="#方式一-3" class="headerlink" title="方式一"></a>方式一</h3><ul>
<li>创建一个新文件，写入内容 5 句 “hello, Gardon”</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"bufio"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//创建一个新文件,写入内容 5句 "hello, Gardon"</span></span><br><span class="line">	<span class="comment">//1. 打开文件 /usr/local/go/src/golang_study/14-File/filedemo3/demo.txt</span></span><br><span class="line">	filePath := <span class="string">"/usr/local/go/src/golang_study/14-File/filedemo3/demo.txt"</span></span><br><span class="line">	file, err := os.OpenFile(filePath, os.O_WRONLY|os.O_CREATE, <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"open file err=%v\n"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//及时关闭file句柄</span></span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line">	<span class="comment">//准备写入5句 "hello, Gardon"</span></span><br><span class="line">	str := <span class="string">"hello, Gardon\n"</span></span><br><span class="line">	<span class="comment">//写入时, 使用带缓存的 *Writer</span></span><br><span class="line">	writer := bufio.NewWriter(file)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">		writer.WriteString(str)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		因为weiter是带缓存, 因此在调用WriterString方法时,</span></span><br><span class="line"><span class="comment">		其实内容是先写入到缓存的,所以需要调用Flush方法, </span></span><br><span class="line"><span class="comment">		将缓冲的数据真正写入到文件中, 否则文件中会没有数据</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	writer.Flush()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>打开一个<code>存在的文件</code>，将原来的内容覆盖成新的内容 10 句 “你好，世界!”</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"bufio"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//打开已经存在的文件</span></span><br><span class="line">	filePath := <span class="string">"/usr/local/go/src/golang_study/14-File/filedemo3/demo.txt"</span></span><br><span class="line">    <span class="comment">//O_TRUNC 	//如果可能,打开时清空文件</span></span><br><span class="line">	file, err := os.OpenFile(filePath, os.O_WRONLY|os.O_TRUNC, <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"open file err=%v\n"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//及时关闭file句柄</span></span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line">	<span class="comment">//准备写入10句 "你好,世界"</span></span><br><span class="line">	str := <span class="string">"你好,世界\r\n"</span> <span class="comment">//  \r\n 表示换行</span></span><br><span class="line">	<span class="comment">//写入时, 使用带缓存的 *Writer</span></span><br><span class="line">	writer := bufio.NewWriter(file)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		writer.WriteString(str)</span><br><span class="line">	&#125;</span><br><span class="line">	writer.Flush()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>打开一个<code>存在的文件</code>，在原来的内容追加内容 ‘ABC! ENGLISH!’</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"bufio"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//打开已经存在的文件</span></span><br><span class="line">	filePath := <span class="string">"/usr/local/go/src/golang_study/14-File/filedemo3/demo.txt"</span></span><br><span class="line">    <span class="comment">//O_APPEND 	//写入文件时追加数据</span></span><br><span class="line">	file, err := os.OpenFile(filePath, os.O_WRONLY|os.O_APPEND, <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"open file err=%v\n"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//及时关闭file句柄</span></span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line">	<span class="comment">//准备写入10句 "你好,世界"</span></span><br><span class="line">	str := <span class="string">"ABC! ENGLISH!\r\n"</span> <span class="comment">//  \r\n 表示换行</span></span><br><span class="line">	<span class="comment">//写入时, 使用带缓存的 *Writer</span></span><br><span class="line">	writer := bufio.NewWriter(file)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		writer.WriteString(str)</span><br><span class="line">	&#125;</span><br><span class="line">	writer.Flush()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>打开一个<code>存在的文件</code>，将原来的内容读出显示在终端，并且追加 5 句”hello,北京!”</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"bufio"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"io"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//打开文件</span></span><br><span class="line">	filePath := <span class="string">"/usr/local/go/src/golang_study/14-File/filedemo3/demo.txt"</span></span><br><span class="line">	file, err := os.OpenFile(filePath, os.O_WRONLY|os.O_APPEND, <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"open file err=%v\n"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//及时关闭file句柄</span></span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//读</span></span><br><span class="line">	<span class="comment">//先读取原来的文件内容,并显示在终端</span></span><br><span class="line">	reader := bufio.NewReader(file)</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		str, err := reader.ReadString(<span class="string">'\n'</span>)	<span class="comment">//	\n在这里表示 reader 读到哪里结束</span></span><br><span class="line">		<span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//显示到终端</span></span><br><span class="line">		fmt.Print(str)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//写</span></span><br><span class="line">	<span class="comment">//准备写入10句 "hello,北京!"</span></span><br><span class="line">	str := <span class="string">"hello,北京!\r\n"</span> <span class="comment">//  \r\n 表示换行</span></span><br><span class="line">	<span class="comment">//写入时, 使用带缓存的 *Writer</span></span><br><span class="line">	writer := bufio.NewWriter(file)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		writer.WriteString(str)</span><br><span class="line">	&#125;</span><br><span class="line">	writer.Flush()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="方式二-3"><a href="#方式二-3" class="headerlink" title="方式二"></a>方式二</h3><ul>
<li>编程一个程序，将一个文件的内容，写入到另外一个文件。</li>
<li>注:这两个文件已经存在了</li>
</ul>
<blockquote>
<p>   <strong>说明:</strong> 使用 ioutil.ReadFile / ioutil.WriteFile 完成写文件的任务.</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"io/ioutil"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//将a.txt文件内容导入到b.txt</span></span><br><span class="line">	<span class="comment">//1. 首先将 a.txt 内容读取到内存</span></span><br><span class="line">	<span class="comment">//2. 将读取到的内容写入 b.txt(如果b.txt文件存在, 则直接覆盖)</span></span><br><span class="line">	file1Path := <span class="string">"/usr/local/go/src/golang_study/14-File/filedemo5/main/a.txt"</span></span><br><span class="line">	file2Path := <span class="string">"/usr/local/go/src/golang_study/14-File/filedemo5/main/b.txt"</span></span><br><span class="line"></span><br><span class="line">	data, err := ioutil.ReadFile(file1Path)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="comment">//说明读取文件有错误</span></span><br><span class="line">		fmt.Printf(<span class="string">"read file err=%v\n"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	err = ioutil.WriteFile(file2Path, data, <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"write file error=%v\n"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="判断文件是否存在"><a href="#判断文件是否存在" class="headerlink" title="判断文件是否存在"></a>判断文件是否存在</h2><p>golang判断<code>文件</code>或<code>文件夹</code>是否存在的方法为 <code>os.Stat()</code> 函数返回的错误值进行判断:</p>
<ol>
<li>如果返回的错误为nil, 说明文件或文件夹存在</li>
<li>如果返回的错误类型使用 os.IsNotExist() 判断为true, 说明文件或文件夹不存在</li>
<li>如果返回的错误为其他类型,则不确定是否存在</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PathExists</span><span class="params">(path <span class="keyword">string</span>)</span> <span class="params">(<span class="keyword">bool</span>, error)</span></span> &#123;</span><br><span class="line">    _, err := os.Stat(path)</span><br><span class="line">    <span class="keyword">if</span> err == <span class="literal">nil</span> &#123;	<span class="comment">//文件或者目录存在</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>, <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> os.IsNotExist(err) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>, <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>, err</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="文件编程应用实例"><a href="#文件编程应用实例" class="headerlink" title="文件编程应用实例"></a>文件编程应用实例</h2><h3 id="拷贝文件"><a href="#拷贝文件" class="headerlink" title="拷贝文件"></a>拷贝文件</h3><p>说明: 将一个文件拷贝到另外一个文件</p>
<p>所需函数: <code>func Copy(dst Writer, src Reader) (written int64, err error)</code></p>
<p>注意: Copy 函数是 <code>io</code> 包提供的</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"bufio"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"io"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//自己编写一个函数, 接收两个文件的路径 (srcFileName, dstFileName)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CopyFile</span><span class="params">(dstFileName <span class="keyword">string</span>, srcFileName <span class="keyword">string</span>)</span> <span class="params">(written <span class="keyword">int64</span>, err error)</span></span> &#123;</span><br><span class="line">	srcFile, err := os.Open(srcFileName)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"open file err=%v\n"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> srcFile.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//通过srcfile, 获取到 Reader</span></span><br><span class="line">	reader := bufio.NewReader(srcFile)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//先创建目标文件, 打开 dstFileName</span></span><br><span class="line">	dstFile, err := os.OpenFile(dstFileName, os.O_WRONLY|os.O_CREATE, <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"open file err=%v\n"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//通过dstFile, 获取到 Writer,将原文件的内容写入到目标文件中</span></span><br><span class="line">	writer := bufio.NewWriter(dstFile)</span><br><span class="line">	<span class="keyword">defer</span> dstFile.Close()</span><br><span class="line">	<span class="keyword">return</span> io.Copy(writer, reader)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//将 a.txt 文件拷贝到 b.txt</span></span><br><span class="line">	<span class="comment">//调用CopyFile 完成文件拷贝</span></span><br><span class="line">	srcFile := <span class="string">"/usr/local/go/src/golang_study/14-File/filedemo6/main/a.txt"</span></span><br><span class="line">	dstFile := <span class="string">"/usr/local/go/src/golang_study/14-File/filedemo6/main/b.txt"</span></span><br><span class="line">	_, err := CopyFile(dstFile, srcFile)</span><br><span class="line">	<span class="keyword">if</span> err == <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"拷贝完成\n"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"拷贝错误 err=%v\n"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="统计英文、数字、空格和其他字符数量"><a href="#统计英文、数字、空格和其他字符数量" class="headerlink" title="统计英文、数字、空格和其他字符数量"></a>统计英文、数字、空格和其他字符数量</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"bufio"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"io"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个结构体, 用于保存统计结果</span></span><br><span class="line"><span class="keyword">type</span> CharCount <span class="keyword">struct</span> &#123;</span><br><span class="line">	ChCount    <span class="keyword">int</span> <span class="comment">//记录英文个数</span></span><br><span class="line">	NumCount   <span class="keyword">int</span> <span class="comment">//记录数字的个数</span></span><br><span class="line">	SpaceCount <span class="keyword">int</span> <span class="comment">//记录空格的个数</span></span><br><span class="line">	OtherCount <span class="keyword">int</span> <span class="comment">//记录其他字符的个数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//思路: 打开一个文件,创建一个 Reader</span></span><br><span class="line">	<span class="comment">//每读取一行, 就去统计该行有多少个 英文 数字 空格 和 其他字符</span></span><br><span class="line">	<span class="comment">//然后将结果保存到一个结构体</span></span><br><span class="line">	fileName := <span class="string">"/usr/local/go/src/golang_study/14-File/filedemo7/main/char.txt"</span></span><br><span class="line">	file, err := os.Open(fileName)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"open file err=%v\n"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> file.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义个 CharCount 实例</span></span><br><span class="line">	<span class="keyword">var</span> count CharCount</span><br><span class="line">	<span class="comment">//创建一个 Reader</span></span><br><span class="line">	reader := bufio.NewReader(file)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//开始循环的读取 fileName 的内容</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		str, err := reader.ReadString(<span class="string">'\n'</span>)</span><br><span class="line">		<span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//为了兼容中文字符, 可以将 str 转成 []rune</span></span><br><span class="line">		str1 := []<span class="keyword">rune</span>(str)</span><br><span class="line">		<span class="comment">//遍历 str, 进行统计</span></span><br><span class="line">		<span class="keyword">for</span> _, v := <span class="keyword">range</span> str1 &#123;</span><br><span class="line">			<span class="keyword">switch</span> &#123;</span><br><span class="line">			<span class="keyword">case</span> v &gt;= <span class="string">'a'</span> &amp;&amp; v &lt;= <span class="string">'z'</span>:</span><br><span class="line">				<span class="keyword">fallthrough</span> <span class="comment">//穿透</span></span><br><span class="line">			<span class="keyword">case</span> v &gt;= <span class="string">'A'</span> &amp;&amp; v &lt;= <span class="string">'Z'</span>:</span><br><span class="line">				count.ChCount++</span><br><span class="line">			<span class="keyword">case</span> v == <span class="string">' '</span> || v == <span class="string">'\t'</span>:</span><br><span class="line">				count.SpaceCount++</span><br><span class="line">			<span class="keyword">case</span> v &gt;= <span class="string">'0'</span> &amp;&amp; v &lt;= <span class="string">'9'</span>:</span><br><span class="line">				count.NumCount++</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				count.OtherCount++</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出统计的结果</span></span><br><span class="line">	fmt.Printf(<span class="string">"字符的个数=%v, 数字的个数=%v, 空格的个数=%v, 其他字符个数=%v\n"</span>, count.ChCount, count.NumCount, count.SpaceCount, count.OtherCount)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="命令行参数"><a href="#命令行参数" class="headerlink" title="命令行参数"></a>命令行参数</h2><blockquote>
<p>  os.Args 是一个 string 的切片，用来存储所有的命令行参数</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"命令行的参数有"</span>, <span class="built_in">len</span>(os.Args))</span><br><span class="line">	<span class="comment">//遍历os.Args切片,就可以得到所有的命令行输入参数值</span></span><br><span class="line">	<span class="keyword">for</span> i, v := <span class="keyword">range</span> os.Args &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"args[%v]=%v\n"</span>, i, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fag9q0uej20hn021q33.jpg" alt="image-20220822093121250"></p>
<h3 id="flag-包用来解析命令行参数"><a href="#flag-包用来解析命令行参数" class="headerlink" title="flag 包用来解析命令行参数"></a>flag 包用来解析命令行参数</h3><blockquote>
<p>  说明: 前面的方式是比较原生的方式，对解析参数不是特别的方便，特别是带有指定参数形式的命令行。</p>
<p>  比如: cmd&gt;main.exe -f a.txt -p 200 -u root 这样的形式命令行，go 设计者给我们提供了 flag 包，可以方便的解析命令行参数，而且参数顺序可以随意</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"flag"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//定义几个变量,用于接收命令行的参数值</span></span><br><span class="line">	<span class="keyword">var</span> user <span class="keyword">string</span></span><br><span class="line">	<span class="keyword">var</span> pwd <span class="keyword">string</span></span><br><span class="line">	<span class="keyword">var</span> host <span class="keyword">string</span></span><br><span class="line">	<span class="keyword">var</span> port <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//&amp;user 就是接收用户命令中输入的 -u 后面的参数值</span></span><br><span class="line">	<span class="comment">//"u" 就是 -u 指定参数</span></span><br><span class="line">	<span class="comment">//"" 默认值</span></span><br><span class="line">	<span class="comment">//"用户名,默认为空" 说明</span></span><br><span class="line">	flag.StringVar(&amp;user, <span class="string">"u"</span>, <span class="string">""</span>, <span class="string">"用户名,默认为空"</span>)</span><br><span class="line">	flag.StringVar(&amp;pwd, <span class="string">"pwd"</span>, <span class="string">""</span>, <span class="string">"密码,默认为空"</span>)</span><br><span class="line">	flag.StringVar(&amp;host, <span class="string">"h"</span>, <span class="string">"localhost"</span>, <span class="string">"主机名, 默认为localhost"</span>)</span><br><span class="line">	flag.IntVar(&amp;port, <span class="string">"port"</span>, <span class="number">3306</span>, <span class="string">"端口号,默认为3306"</span>)</span><br><span class="line">	<span class="comment">//这里有一个非常重要的操作, 转换, 必须调用该方法</span></span><br><span class="line">	flag.Parse()</span><br><span class="line">	<span class="comment">//输出结果</span></span><br><span class="line">	fmt.Printf(<span class="string">"user=%v pwd=%v host=%v port=%v\n"</span>, user, pwd, host, port)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fb2ixbl4j20eg00tweg.jpg" alt="image-20220822095246719"></p>
<h2 id="json"><a href="#json" class="headerlink" title="json"></a>json</h2><h3 id="基本介绍-5"><a href="#基本介绍-5" class="headerlink" title="基本介绍"></a>基本介绍</h3><blockquote>
<p>  JSON易于机器解析和生成,并有效的提升网络传输效率,通常程序在网络传输时,会先将数据(结构体/map等)序列化成json字符串,到接收方得到json字符串时,在反序列化恢复成原来的数据类型(结构体/map等)</p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fbam9tnfj218h0gljum.jpg" alt="image-20220822100033091"></p>
<h3 id="json数据格式说明"><a href="#json数据格式说明" class="headerlink" title="json数据格式说明"></a>json数据格式说明</h3><blockquote>
<p>  在json语言中,一切都是对象.因此,任何的数据类型都可以通过json来表示,例如字符串,数字,对象,数组,map,结构体等</p>
</blockquote>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;<span class="attr">"key1"</span>:val1, <span class="attr">"key2"</span>:val2&#125;,&#123;<span class="attr">"key1"</span>:val1, <span class="attr">"key2"</span>:val2, <span class="attr">"key3"</span>:[val3, val4]&#125;]</span><br></pre></td></tr></table></figure>

<h3 id="json的序列化"><a href="#json的序列化" class="headerlink" title="json的序列化"></a>json的序列化</h3><blockquote>
<p>  json 序列化是指，将有 key-value 结构的数据类型(比如结构体、map、切片)序列化成 json 字符串的操作。</p>
</blockquote>
<ul>
<li>应用案例</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个结构体</span></span><br><span class="line"><span class="keyword">type</span> Monster <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name     <span class="keyword">string</span></span><br><span class="line">	Age      <span class="keyword">int</span></span><br><span class="line">	Birthday <span class="keyword">string</span></span><br><span class="line">	Sal      <span class="keyword">float64</span></span><br><span class="line">	Skill    <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testStruct</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//演示</span></span><br><span class="line">	monster := Monster&#123;</span><br><span class="line">		Name:     <span class="string">"牛魔王"</span>,</span><br><span class="line">		Age:      <span class="number">500</span>,</span><br><span class="line">		Birthday: <span class="string">"2022-08-23"</span>,</span><br><span class="line">		Sal:      <span class="number">8000.0</span>,</span><br><span class="line">		Skill:    <span class="string">"牛魔拳"</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将 monster 序列化</span></span><br><span class="line">	data, err := json.Marshal(&amp;monster)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"序列号错误 err=%v\n"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出序列化后的结果</span></span><br><span class="line">	fmt.Printf(<span class="string">"monster 序列化后=%v\n"</span>, <span class="keyword">string</span>(data))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将 map 进行序列化</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testMap</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//定义一个map</span></span><br><span class="line">	<span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	<span class="comment">//使用 map,需要 make</span></span><br><span class="line">	a = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	a[<span class="string">"name"</span>] = <span class="string">"红孩儿"</span></span><br><span class="line">	a[<span class="string">"age"</span>] = <span class="number">30</span></span><br><span class="line">	a[<span class="string">"address"</span>] = <span class="string">"洪崖洞"</span></span><br><span class="line">	<span class="comment">//将 a 这个map进行序列化</span></span><br><span class="line">	<span class="comment">//将 monster 序列化</span></span><br><span class="line">	data, err := json.Marshal(a)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"序列化错误 err=%v\n"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//输出序列化后的结果</span></span><br><span class="line">	fmt.Printf(<span class="string">"a map 序列化后=%v\n"</span>, <span class="keyword">string</span>(data))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//演示对切片进行序列化,我们这个切片 []map[string]interface&#123;&#125;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testSlice</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> slice []<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	<span class="keyword">var</span> m1 <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	<span class="comment">//使用 map 前, 需要先 make</span></span><br><span class="line">	m1 = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	m1[<span class="string">"name"</span>] = <span class="string">"jack"</span></span><br><span class="line">	m1[<span class="string">"age"</span>] = <span class="string">"7"</span></span><br><span class="line">	m1[<span class="string">"address"</span>] = <span class="string">"北京"</span></span><br><span class="line">	slice = <span class="built_in">append</span>(slice, m1)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> m2 <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	<span class="comment">//使用 map 前, 需要先 make</span></span><br><span class="line">	m2 = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	m2[<span class="string">"name"</span>] = <span class="string">"tom"</span></span><br><span class="line">	m2[<span class="string">"age"</span>] = <span class="string">"20"</span></span><br><span class="line">	m2[<span class="string">"address"</span>] = [<span class="number">2</span>]<span class="keyword">string</span>&#123;<span class="string">"墨西哥"</span>, <span class="string">"夏威夷"</span>&#125;</span><br><span class="line">	slice = <span class="built_in">append</span>(slice, m2)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//将切片进行序列化操作</span></span><br><span class="line">	data, err := json.Marshal(slice)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"序列化错误 err=%v\n"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//输出序列化后的结果</span></span><br><span class="line">	fmt.Printf(<span class="string">"slice 序列化后=%v\n"</span>, <span class="keyword">string</span>(data))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//对基本数据类型序列化, 对基本数据类型进行序列化意义不大</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testFloat64</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> num1 <span class="keyword">float64</span> = <span class="number">2345.67</span></span><br><span class="line">	<span class="comment">//对 num1 进行序列化</span></span><br><span class="line">	data, err := json.Marshal(num1)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"序列化错误 err=%v\n"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//输出序列化后的结果</span></span><br><span class="line">	fmt.Printf(<span class="string">"num1 序列化后=%v\n"</span>, <span class="keyword">string</span>(data))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//演示将结构体,map,切片进行序列号</span></span><br><span class="line">	testStruct()</span><br><span class="line">	testMap()</span><br><span class="line">	testSlice()   <span class="comment">//演示对切片的序列化</span></span><br><span class="line">	testFloat64() <span class="comment">//演示对基本数据类型的序列化</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fdyiq40dj20mp01v3yu.jpg" alt="image-20220822113243892"></p>
<ul>
<li>注意事项</li>
</ul>
<blockquote>
<p>  对于结构体的序列化，如果我们希望序列化后的 key 的名字，又我们自己重新制定，那么可以给 struct 指定一个 tag 标签.</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义一个结构体</span></span><br><span class="line"><span class="keyword">type</span> Monster <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name     <span class="keyword">string</span> <span class="string">`json:"monster_name"`</span></span><br><span class="line">	Age      <span class="keyword">int</span>	<span class="string">`json:"monster_age"`</span></span><br><span class="line">	Birthday <span class="keyword">string</span></span><br><span class="line">	Sal      <span class="keyword">float64</span></span><br><span class="line">	Skill    <span class="keyword">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="json的反序列化"><a href="#json的反序列化" class="headerlink" title="json的反序列化"></a>json的反序列化</h3><blockquote>
<p>  json 反序列化是指，将 json 字符串反序列化成对应的数据类型(比如结构体、map、切片)的操作</p>
</blockquote>
<ul>
<li>应用案例</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个结构体</span></span><br><span class="line"><span class="keyword">type</span> Monster <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name     <span class="keyword">string</span></span><br><span class="line">	Age      <span class="keyword">int</span></span><br><span class="line">	Birthday <span class="keyword">string</span></span><br><span class="line">	Sal      <span class="keyword">float64</span></span><br><span class="line">	Skill    <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//演示将json字符串,反序列化为 struct</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">unmarshalStruct</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//说明: str 在项目开发中,是通过网络传输获取到..或者是读取到文件获取到</span></span><br><span class="line">	str := <span class="string">"&#123;\"Name\":\"牛魔王\", \"Age\":500, \"Birthday\":\"2022-08-23\", \"Sal\":8000, \"Skill\":\"牛魔拳\"&#125;"</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义一个Monster实例</span></span><br><span class="line">	<span class="keyword">var</span> monster Monster</span><br><span class="line">	err := json.Unmarshal([]<span class="keyword">byte</span>(str), &amp;monster)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"unmarshal err=%v\n"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">"反序列化后 monster=%v monster.Name=%v\n"</span>, monster, monster.Name)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//演示将json字符串,反序列化成 map</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">unmarshalMap</span><span class="params">()</span></span> &#123;</span><br><span class="line">	str := <span class="string">"&#123;\"address\":\"洪崖洞\", \"age\":30, \"name\":\"红孩儿\"&#125;"</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义一个 map</span></span><br><span class="line">	<span class="keyword">var</span> a <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//反序列化</span></span><br><span class="line">	<span class="comment">//注意: 反序列化 map, 不需要make, 因为 make 操作被封装到 Unmarshal 函数</span></span><br><span class="line">	err := json.Unmarshal([]<span class="keyword">byte</span>(str), &amp;a)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"unmarshal err=%v\n"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">"反序列化后 a=%v\n"</span>, a)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//演示将 json 字符串, 反序列化成切片</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">unmarshalSlice</span><span class="params">()</span></span> &#123;</span><br><span class="line">	str := <span class="string">"[&#123;\"address\":\"北京\", \"age\":\"7\", \"name\":\"jack\"&#125;,"</span> + <span class="string">" &#123;\"address\":[\"墨西哥\", \"夏威夷\"], \"age\":\"20\", \"name\":\"tom\"&#125;]"</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义一个slice</span></span><br><span class="line">	<span class="keyword">var</span> slice []<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	<span class="comment">//反序列化, 不需要 make, 因为 make 操作被封装到 Unmarshal 函数</span></span><br><span class="line">	err := json.Unmarshal([]<span class="keyword">byte</span>(str), &amp;slice)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"unmarshal err=%v\n"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Printf(<span class="string">"反序列化后 slice=%v\n"</span>, slice)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	unmarshalStruct()</span><br><span class="line">	unmarshalMap()</span><br><span class="line">	unmarshalSlice()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fhq4c94gj20jd01lt8y.jpg" alt="image-20220822134302705"></p>
<p>对上面代码的说明<br>1) 在反序列化一个json字符串时，要确保<code>反序列化</code>后的数据类型和<code>原来序列化</code>前的数据类型一致。<br>1) 如果 json 字符串是通过程序获取到的，则不需要再对 <code>&quot;</code> 转义处理。</p>
<h1 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h1><blockquote>
<p>  在工作中,我们经常会确认一个函数或模块的执行结果是否正确</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addUpper</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	res := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= n; i++ &#123;</span><br><span class="line">		res += i</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	res := addUpper(<span class="number">10</span>)</span><br><span class="line">	fmt.Println(<span class="string">"res="</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="传统方式"><a href="#传统方式" class="headerlink" title="传统方式"></a>传统方式</h2><blockquote>
<p>  在 main 函数中，调用 addUpper 函数，看看实际输出的结果是否和预期的结果一致，如果一致，则说明函数正确，否则函数有错误，然后修改错误</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">addUpper</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	res := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= n; i++ &#123;</span><br><span class="line">		res += i</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	res := addUpper(<span class="number">10</span>)</span><br><span class="line">	<span class="keyword">if</span> res != <span class="number">55</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"addUpper错误 返回值=%v 期望值=%v\n"</span>, res, <span class="number">55</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"addUpper正确 返回值=%v 期望值=%v\n"</span>, res, <span class="number">55</span>)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"res="</span>, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fijxkxerj20e9016t8o.jpg" alt="image-20220822141141425"></p>
<h2 id="传统方式的缺点"><a href="#传统方式的缺点" class="headerlink" title="传统方式的缺点"></a>传统方式的缺点</h2><ul>
<li>不方便, 我们需要在 main 函数中去调用，这样就需要去修改 main 函数，如果现在项目正在运行，就可能去停止项目</li>
<li>不利于管理，因为当我们测试多个函数或者多个模块时，都需要写在 main 函数，不利于我们管理和清晰我们思路</li>
<li>引出单元测试。=&gt; testing 测试框架可以很好解决问题。</li>
</ul>
<h2 id="单元测试基本介绍"><a href="#单元测试基本介绍" class="headerlink" title="单元测试基本介绍"></a>单元测试基本介绍</h2><blockquote>
<p>  Go 语言中自带有一个轻量级的测试框架 testing 和自带的 go test 命令来实现单元测试和性能测试，testing 框架和其他语言中的测试框架类似，可以基于这个框架写针对相应函数的测试用例，也可以基于该框架写相应的压力测试用例。通过单元测试，可以解决如下问题:</p>
<ul>
<li>确保每个函数是可运行，并且运行结果是正确的</li>
<li>确保写出来的代码性能是好的</li>
<li>单元测试能及时的发现程序设计或实现的逻辑错误，使问题及早暴露，便于问题的定位解决，而性能测试的重点在于发现程序设计上的一些问题，让程序能够在高并发的情况下还能保持稳定</li>
</ul>
</blockquote>
<h2 id="快速入门-8"><a href="#快速入门-8" class="headerlink" title="快速入门"></a>快速入门</h2><ul>
<li>文件目录结构</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fl869xwsj206y01qt8i.jpg" alt="image-20220822154411867"></p>
<ul>
<li>utils/cal.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AddUpper</span><span class="params">(n <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	res := <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= n; i++ &#123;</span><br><span class="line">		res += i</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> res</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>utils/cal_test.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"testing"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestAddUpper</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">	res := AddUpper(<span class="number">10</span>)</span><br><span class="line">	<span class="keyword">if</span> res != <span class="number">55</span> &#123;</span><br><span class="line">		<span class="comment">// fmt.Printf("AddUpper(10) 执行错误, 期望值=%v 实际值=%v\n", 55, res)</span></span><br><span class="line">		t.Fatalf(<span class="string">"AddUpper(10) 执行错误, 期望值=%v 实际值=%v\n"</span>, <span class="number">55</span>, res)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//如果正确,记录日志</span></span><br><span class="line">	t.Logf(<span class="string">"AddUpper(10) 执行正确"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fl9sqtp1j20fc02f74g.jpg" alt="image-20220822154545558"></p>
<ul>
<li>运行原理</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5flmc7p7fj20ru07jdgk.jpg" alt="image-20220822155748554"></p>
<h2 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h2><p>1)   测试用例文件名必须以 _test.go 结尾。 比如 <code>cal_test.go</code> , <code>cal</code> 不是固定的。<br>2)   测试用例函数必须以 Test 开头，一般来说就是 <code>Test+被测试的函数名</code>，比如 TestAddUpper<br>3)   TestAddUpper(t <em>tesing.T) 的形参类型必须是 `</em>testing.T`,可以参考: <a href="https://pkg.go.dev/testing#T" target="_blank" rel="noopener">手册(需要科学上网)</a><br>4)   一个测试用例文件中，可以有多个测试用例函数，比如 TestAddUpper、TestSub<br>5)   运行测试用例指令</p>
<ul>
<li><p>cmd&gt; <code>go test</code> [<strong>如果运行正确，无日志，错误时，会输出日志</strong>] </p>
</li>
<li><p>cmd&gt; <code>go test -v</code> [<strong>运行正确或是错误，都输出日志</strong>]</p>
</li>
</ul>
<ol start="6">
<li>当出现错误时，可以使用 <code>t.Fatalf</code> 来格式化输出错误信息，并退出程序</li>
<li><code>t.Logf</code> 方法可以输出相应的日志</li>
<li>测试用例函数，并没有放在 main 函数中，也执行了，这就是测试用例的方便之处[原理图参考上面的图片]</li>
<li><code>PASS</code> 表示测试用例运行<code>成功</code>，<code>FAIL</code> 表示测试用例运行<code>失败</code></li>
<li>测试单个文件，一定要带上被测试的原文件</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> test -v cal_test.<span class="keyword">go</span> cal.<span class="keyword">go</span></span><br></pre></td></tr></table></figure>

<p>11) 测试单个方法</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">go</span> test -v -test.run TestAddUpper</span><br></pre></td></tr></table></figure>

<h2 id="综合案例"><a href="#综合案例" class="headerlink" title="综合案例"></a>综合案例</h2><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fn5jq7syj205t01tjr7.jpg" alt="image-20220822165051757"></p>
<ul>
<li>monster/monster.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> monster</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"io/ioutil"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Monster <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span></span><br><span class="line">	Age   <span class="keyword">int</span></span><br><span class="line">	Skill <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//给 Monster 绑定方法 Store, 可以将一个 Monster 变量(对象), 序列化后保存到文件中</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Monster)</span> <span class="title">Store</span><span class="params">()</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	<span class="comment">//先序列化</span></span><br><span class="line">	data, err := json.Marshal(m)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"marshal err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//保存到文件</span></span><br><span class="line">	filePath := <span class="string">"/usr/local/go/src/golang_study/15-test/testdemo2/monster.ser"</span></span><br><span class="line">	err = ioutil.WriteFile(filePath, data, <span class="number">0666</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"write file err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//给 Monster 绑定方法 ReStore, 可以将一个序列化的 Monster, 从文件中读取</span></span><br><span class="line"><span class="comment">//并反序列化为 Monster 对象, 检查反序列化, 名字正确</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Monster)</span> <span class="title">ReStore</span><span class="params">()</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	<span class="comment">//1.先从文件中,读取序列化的字符串</span></span><br><span class="line">	filePath := <span class="string">"/usr/local/go/src/golang_study/15-test/testdemo2/monster.ser"</span></span><br><span class="line">	data, err := ioutil.ReadFile(filePath)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"ReadFile err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2.使用读取到 data []byte, 对反序列化</span></span><br><span class="line">	err = json.Unmarshal(data, m)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"Unmarshal err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>monster/monster_test.go</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> monster</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"testing"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试用例, 测试 Store 方法</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestStore</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">	<span class="comment">//先创建一个 Monster 实例</span></span><br><span class="line">	monster := &amp;Monster&#123;</span><br><span class="line">		Name:  <span class="string">"红孩儿"</span>,</span><br><span class="line">		Age:   <span class="number">10</span>,</span><br><span class="line">		Skill: <span class="string">"吐火~"</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	res := monster.Store()</span><br><span class="line">	<span class="keyword">if</span> !res &#123;</span><br><span class="line">		t.Fatalf(<span class="string">"monster.Store() 错误, 希望为=%v 实际为=%v"</span>, <span class="literal">true</span>, res)</span><br><span class="line">	&#125;</span><br><span class="line">	t.Logf(<span class="string">"monster.Store() 测试成功!"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestReStore</span><span class="params">(t *testing.T)</span></span> &#123;</span><br><span class="line">	<span class="comment">//先创建一个 Monster 实例, 不需要指定字段的值</span></span><br><span class="line">	<span class="keyword">var</span> monster = &amp;Monster&#123;&#125;</span><br><span class="line">	res := monster.ReStore()</span><br><span class="line">	<span class="keyword">if</span> !res &#123;</span><br><span class="line">		t.Fatalf(<span class="string">"monster.ReStore() 错误, 希望为=%v 实际为%v"</span>, <span class="literal">true</span>, res)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//进一步判断</span></span><br><span class="line">	<span class="keyword">if</span> monster.Name != <span class="string">"红孩儿"</span> &#123;</span><br><span class="line">		t.Fatalf(<span class="string">"monster.ReStore() 错误, 希望为=%v 实际为=%v"</span>, <span class="string">"红孩儿"</span>, monster.Name)</span><br><span class="line">	&#125;</span><br><span class="line">	t.Logf(<span class="string">"monster.ReStore() 测试成功!"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fn7z8687j20e203jt90.jpg" alt="image-20220822165312506"></p>
<p>执行后会在指定位置生成<code>monster.ser</code>文件</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fn8kr8yhj207w02hq2t.jpg" alt="image-20220822165346821"></p>
<p>文件内容如下</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5fn9foyogj20gy02i3yh.jpg" alt="image-20220822165436440"></p>
<h1 id="goroutine-和-channel"><a href="#goroutine-和-channel" class="headerlink" title="goroutine 和 channel"></a>goroutine 和 channel</h1><h2 id="goroutine-协程"><a href="#goroutine-协程" class="headerlink" title="goroutine(协程)"></a>goroutine(协程)</h2><h3 id="进程与线程"><a href="#进程与线程" class="headerlink" title="进程与线程"></a>进程与线程</h3><ul>
<li>进程就是程序在操作系统中的一次执行过程, 是系统进行资源分配和调度的基本单位</li>
<li>线程是进程的一个执行实例, 是程序执行的基本单位</li>
<li>一个进程可以任意创建和销毁多个线程,同一个进程中的多个线程可以并发执行</li>
<li>一个程序至少有一个进程,一个进程至少有一个线程</li>
</ul>
<h3 id="程序、进程和线程的关系"><a href="#程序、进程和线程的关系" class="headerlink" title="程序、进程和线程的关系"></a>程序、进程和线程的关系</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">程序 =&gt;  进程<span class="number">1</span> =&gt; &#123;线程<span class="number">1</span>, 线程<span class="number">2.</span>..&#125;</span><br><span class="line">        进程<span class="number">2</span> =&gt; &#123;线程<span class="number">1</span>, 线程<span class="number">2.</span>..&#125;</span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>

<h3 id="并发与并行"><a href="#并发与并行" class="headerlink" title="并发与并行"></a>并发与并行</h3><ul>
<li>多线程程序在单核上运行,就是<code>并发</code></li>
<li>多线程程序在多核上运行,就是<code>并行</code></li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5gitp6oxhj20pc0jwwg5.jpg" alt="image-20220823110638774"></p>
<h3 id="Go协程与Go主线程"><a href="#Go协程与Go主线程" class="headerlink" title="Go协程与Go主线程"></a>Go协程与Go主线程</h3><ul>
<li><p>Go 主线程(有程序员直接称为线程/也可以理解成进程): 一个 Go 线程上，可以起多个协程，你可以这样理解，协程是轻量级的线程[编译器做优化]。</p>
</li>
<li><p>Go协程的特点</p>
</li>
</ul>
<p>1) 有独立的栈空间<br>2) 共享程序堆空间<br>3) 调度由用户控制<br>4) 协程是轻量级的线程</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5gj9qierpj20ni060dg1.jpg" alt="image-20220823112203518"></p>
<h3 id="goroutine快速入门"><a href="#goroutine快速入门" class="headerlink" title="goroutine快速入门"></a>goroutine快速入门</h3><blockquote>
<p>  请编写一个程序，完成如下功能:<br>  1) 在主线程(可以理解成进程)中，开启一个 goroutine, 该协程每隔 1 秒输出 “hello,world”<br>  2) 在主线程中也每隔一秒输出”hello,golang”, 输出 10 次后，退出程序<br>  3) 要求主线程和 goroutine 同时执行.<br>  4) 画出主线程和协程执行流程图</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"strconv"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">		fmt.Println(<span class="string">"test() hello world "</span> + strconv.Itoa(i))</span><br><span class="line">		time.Sleep(time.Second)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">go</span> test() <span class="comment">//开启一个协程</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">10</span>; i++ &#123;</span><br><span class="line">		fmt.Println(<span class="string">"main() hello golang"</span> + strconv.Itoa(i))</span><br><span class="line">		time.Sleep(time.Second)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>main</code> 主线程和 <code>test</code> 协程同时执行</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5gmhcwhj3j20du08ijry.jpg" alt="image-20220823131311170"></p>
<p>执行流程图</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5gmxkse2pj20mb0h2ta7.jpg" alt="image-20220823132846539"></p>
<ul>
<li>小结</li>
</ul>
<p>1) 主线程是一个物理线程，直接作用在 cpu 上的。是重量级的，非常耗费 cpu 资源。<br>2) 协程从主线程开启的，是轻量级的线程，是逻辑态。对资源消耗相对小。<br>3) Golang的协程机制是重要的特点，可以轻松的<strong>开启上万个协程</strong>。其它编程语言的并发机制是一般基于线程的，开启过多的线程，资源耗费大，这里就突显 Golang 在并发上的优势了</p>
<h3 id="goroutine的调度模型"><a href="#goroutine的调度模型" class="headerlink" title="goroutine的调度模型"></a>goroutine的调度模型</h3><h4 id="MPG-模式-状态一"><a href="#MPG-模式-状态一" class="headerlink" title="MPG 模式-状态一"></a>MPG 模式-状态一</h4><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hpwgtvjjj20z60g375j.jpg" alt="image-20220824115702034"></p>
<ol>
<li>当前程序有<strong>三个M</strong>,如果<strong>三个M</strong>都在一个CPU运行,就是<code>并发</code>,如果在不同的CPU运行就是<code>并行</code></li>
<li><strong>M1,M2,M3</strong>正在执行一个<strong>G</strong>,<strong>M1</strong>的协程队列有<strong>三个</strong>,<strong>M2</strong>的协程队列有<strong>三个</strong>,<strong>M3</strong>协程队列有<strong>两个</strong></li>
<li>从上图可以看到: Go的协程是<code>轻量级的线程</code>,是逻辑态的,Go可以容易的起<code>上万</code>个协程</li>
<li>其他程序c/java的多线程,往往是内核态的,比较重量级,<code>千个</code>线程可能耗光CPU</li>
</ol>
<h4 id="MPG模式-状态二"><a href="#MPG模式-状态二" class="headerlink" title="MPG模式-状态二"></a>MPG模式-状态二</h4><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5htca9ofbj20uy0g8dgq.jpg" alt="image-20220824135604314"></p>
<ol>
<li>分成两个部分来看</li>
<li>原来的情况是 M0 主线程正在执行G0协程,另外有三个协程在队列等待</li>
<li>如果G0协程阻塞,比如读取文件或者数据库等</li>
<li>这时就会创建M1主线程(也可能是从已有的线程池中取出M1),并且将等待的3个协程挂到M1下开始执行,M0的主线程下的G0仍然执行文件io的读写</li>
<li>这样的MPG调度模式,可以既让G0执行,同时也不会让队列的其他协程一直阻塞,仍然可以并发/并行执行</li>
<li>等到G0不阻塞了,M0会被放到空闲的主线程继续执行(从已有的线程池中取),同时G0又会被唤醒</li>
</ol>
<h3 id="设置golang运行的CPU数量"><a href="#设置golang运行的CPU数量" class="headerlink" title="设置golang运行的CPU数量"></a>设置golang运行的CPU数量</h3><blockquote>
<p>  为了充分了利用多 cpu 的优势，在 Golang 程序中，设置运行的 cpu 数目</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"runtime"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//获取当前系统CPU的数量</span></span><br><span class="line">	num := runtime.NumCPU()</span><br><span class="line">	<span class="comment">//设置num-1的cpu运行go程序</span></span><br><span class="line">	runtime.GOMAXPROCS(num)</span><br><span class="line">	fmt.Println(<span class="string">"num="</span>, num)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5htny9vskj20dt01igln.jpg" alt="image-20220824140716803"></p>
<ol>
<li><strong>go1.8后:</strong> 默认让程序运行在多个核上,可以不用设置了</li>
<li><strong>go1.8前:</strong> 还是要设置一下,可以更高效的利用CPU</li>
</ol>
<h2 id="channel-管道"><a href="#channel-管道" class="headerlink" title="channel(管道)"></a>channel(管道)</h2><ul>
<li>先看一个需求</li>
</ul>
<blockquote>
<p>  需求: 现在要计算 1-200 的各个数的阶乘,并且把各个数的阶乘放入到 map 中, 最后显示出来, 要求使用 toroutine 完成</p>
<pre><code>*思路:*

*1.编写一个函数, 来计算各个数的阶乘,放入到 map 中*

*2.我们启动的协程多个,统计的将结果放入到 map 中*

*3.map 应该做出一个全局的*</code></pre></blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//需求: 现在要计算 1-200 的各个数的阶乘,并且把各个数的阶乘放入到 map 中</span></span><br><span class="line"><span class="comment">//最后显示出来, 要求使用 toroutine 完成</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	思路:</span></span><br><span class="line"><span class="comment">	1.编写一个函数, 来计算各个数的阶乘,放入到 map 中</span></span><br><span class="line"><span class="comment">	2.我们启动的协程多个,统计的将结果放入到 map 中</span></span><br><span class="line"><span class="comment">	3.map 应该做出一个全局的</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	myMap = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">int</span>, <span class="number">10</span>)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// test 函数就是计算n!, 让将这个结果放入到 myMap</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	res := <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= n; i++ &#123;</span><br><span class="line">		res *= i</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 这里将 res 放入到 myMap</span></span><br><span class="line">	myMap[n] = res</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 开启多个协程完成这个任务</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">200</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">go</span> test(i)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 休眠5秒钟(第二个问题)</span></span><br><span class="line">	time.Sleep(time.Second * <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出结果</span></span><br><span class="line">	<span class="keyword">for</span> i, v := <span class="keyword">range</span> myMap &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"map[%d]=%d\n"</span>, i, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>此时运行会报错</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hvbrkft2j20ol053dgq.jpg" alt="image-20220824150446308"></p>
<p>报错的原因是<code>资源竞争</code>,因为我的笔记本电脑只有<code>8</code>个CPU,当200个协程同时进行写操作时,就会出现这个问题</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hwgydwbuj20o709eq3g.jpg" alt="image-20220824154421473"></p>
<h3 id="不同-goroutine-之间如何通讯"><a href="#不同-goroutine-之间如何通讯" class="headerlink" title="不同 goroutine 之间如何通讯"></a>不同 goroutine 之间如何通讯</h3><ul>
<li>全局变量的互斥锁</li>
<li>使用管道 channel 来解决</li>
</ul>
<h3 id="全局变量加锁同步"><a href="#全局变量加锁同步" class="headerlink" title="全局变量加锁同步"></a>全局变量加锁同步</h3><ul>
<li><p>因为没有对全局变量 m <code>加锁</code>，因此会出现<code>资源争夺</code>问题，代码会出现错误，提示 <code>concurrent map writes</code></p>
</li>
<li><p>解决方案: 加入互斥锁</p>
</li>
<li><p>我们的数的阶乘很大，结果会越界,可以将求阶乘改成 <code>sum += uint64(i)</code></p>
</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"sync"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//需求: 现在要计算 1-200 的各个数的阶乘,并且把各个数的阶乘放入到 map 中</span></span><br><span class="line"><span class="comment">//最后显示出来, 要求使用 toroutine 完成</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	思路:</span></span><br><span class="line"><span class="comment">	1.编写一个函数, 来计算各个数的阶乘,放入到 map 中</span></span><br><span class="line"><span class="comment">	2.我们启动的协程多个,统计的将结果放入到 map 中</span></span><br><span class="line"><span class="comment">	3.map 应该做出一个全局的</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">	myMap = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">int</span>, <span class="number">10</span>)</span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">		声明一个全局的互斥锁</span></span><br><span class="line"><span class="comment">		lock 是一个全局的互斥锁</span></span><br><span class="line"><span class="comment">		sync 是包: synchornized 同步</span></span><br><span class="line"><span class="comment">		Mutex: 是互斥</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">	lock sync.Mutex</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// test 函数就是计算n!, 让将这个结果放入到 myMap</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">(n <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	res := <span class="number">1</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= n; i++ &#123;</span><br><span class="line">		res *= i</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 这里将 res 放入到 myMap</span></span><br><span class="line">	<span class="comment">//加锁</span></span><br><span class="line">	lock.Lock()</span><br><span class="line">	myMap[n] = res</span><br><span class="line">	<span class="comment">//解锁</span></span><br><span class="line">	lock.Unlock()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 开启多个协程完成这个任务</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">200</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">go</span> test(i)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 休眠5秒钟(第二个问题)</span></span><br><span class="line">	time.Sleep(time.Second * <span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//输出结果</span></span><br><span class="line">	lock.Lock()</span><br><span class="line">	<span class="keyword">for</span> i, v := <span class="keyword">range</span> myMap &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"map[%d]=%d\n"</span>, i, v)</span><br><span class="line">	&#125;</span><br><span class="line">	lock.Unlock()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>再次运行</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hx16xf6ij20e205iq38.jpg" alt="image-20220824160348389"></p>
<p>此时会发现,阶乘的结果会有<code>0</code>和<code>负数</code></p>
<p>因为我们给定的<code>200</code>太大了,会越界,改小一些即可</p>
<h3 id="channel的意义"><a href="#channel的意义" class="headerlink" title="channel的意义"></a>channel的意义</h3><ol>
<li><p>前面使用全局变量加锁同步来解决 goroutine 的通讯，但不完美</p>
</li>
<li><p>主线程在等待所有 goroutine 全部完成的时间<code>很难确定</code>，我们这里设置 10 秒，仅仅是估算。 </p>
</li>
<li><p>如果主线程休眠时间长了，会加长等待时间，如果等待时间短了，可能还有 goroutine 处于工作状态，这时也会随主线程的退出而销毁</p>
</li>
<li><p>通过全局变量加锁同步来实现通讯，也并不利用多个协程对全局变量的读写操作。 </p>
</li>
<li><p>上面种种分析都在呼唤一个新的通讯机制: <code>channel</code></p>
</li>
</ol>
<h3 id="channel的基本介绍"><a href="#channel的基本介绍" class="headerlink" title="channel的基本介绍"></a>channel的基本介绍</h3><ol>
<li><p>channle 本质就是一个数据结构-队列</p>
</li>
<li><p>数据是<code>先进先出</code>【FIFO : first in first out】</p>
</li>
<li><p>线程安全，多 goroutine 访问时，不需要加锁，就是说 channel 本身就是线程安全的</p>
</li>
<li><p>channel 有类型的，一个 string 的 channel 只能存放 string 类型数据。</p>
</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hy365oq1j20pz07et9i.jpg" alt="image-20220824164017967"></p>
<h3 id="channel的声明"><a href="#channel的声明" class="headerlink" title="channel的声明"></a>channel的声明</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> intChan <span class="keyword">chan</span> <span class="keyword">int</span> (intChan 用于存放 <span class="keyword">int</span> 数据)</span><br><span class="line"><span class="keyword">var</span> mapChan <span class="keyword">chan</span> <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span> (mapChan 用于存放 <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span> 类型) </span><br><span class="line"><span class="keyword">var</span> perChan <span class="keyword">chan</span> Person</span><br><span class="line"><span class="keyword">var</span> perChan2 <span class="keyword">chan</span> *Person</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  channel 是<code>引用类型</code></p>
<p>  channel 必须初始化才能写入数据, 即 <code>make 后才能使用</code></p>
<p>  <code>管道是有类型的</code>，intChan 只能写入 整数 int</p>
</blockquote>
<h3 id="channel应用案例"><a href="#channel应用案例" class="headerlink" title="channel应用案例"></a>channel应用案例</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//演示一下管道的使用</span></span><br><span class="line">	<span class="comment">//1. 创建一个可以存放 3 个 int 类型的管道</span></span><br><span class="line">	<span class="keyword">var</span> intChan <span class="keyword">chan</span> <span class="keyword">int</span></span><br><span class="line">	intChan = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2. 看看 intChan 是什么</span></span><br><span class="line">	fmt.Printf(<span class="string">"intChan 的值=%v intChan 本身的地址=%p\n"</span>, intChan, &amp;intChan)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//3. 向管道写入数据</span></span><br><span class="line">	intChan &lt;- <span class="number">10</span></span><br><span class="line">	num := <span class="number">211</span></span><br><span class="line">	intChan &lt;- num</span><br><span class="line">	intChan &lt;- <span class="number">50</span></span><br><span class="line">	<span class="comment">//intChan &lt;- 98	//注意点, 当我们给管道写入数据时,不能超过其容量</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//4. 看看管道的长度和cap(容量)</span></span><br><span class="line">	fmt.Printf(<span class="string">"channel len=%v cap=%v \n"</span>, <span class="built_in">len</span>(intChan), <span class="built_in">cap</span>(intChan))</span><br><span class="line"></span><br><span class="line">	<span class="comment">//5. 从管道中读取数据</span></span><br><span class="line">	<span class="keyword">var</span> num2 <span class="keyword">int</span></span><br><span class="line">	num2 = &lt;-intChan</span><br><span class="line">	fmt.Println(<span class="string">"num2="</span>, num2)	<span class="comment">//先进先出,所以是10</span></span><br><span class="line">	fmt.Printf(<span class="string">"channel len=%v cap=%v \n"</span>, <span class="built_in">len</span>(intChan), <span class="built_in">cap</span>(intChan)) <span class="comment">//2, 3</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//6. 在没有使用协程的情况下, 如果我们的管道数据已经全部取出,再取就会报告 deadlock</span></span><br><span class="line">	num3 := &lt;-intChan</span><br><span class="line">	num4 := &lt;-intChan</span><br><span class="line">	num5 := &lt;-intChan</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"num3="</span>, num3, <span class="string">"num4="</span>, num4, <span class="string">"num5="</span>, num5)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5hysft9otj20f8047glx.jpg" alt="image-20220824170435168"></p>
<p>当我们从intChan取出第一个数据时, intChan的长度就 -1</p>
<p>正如我们所料, 当程序执行到num3时,就报错了</p>
<h3 id="channel的注意事项"><a href="#channel的注意事项" class="headerlink" title="channel的注意事项"></a>channel的注意事项</h3><ol>
<li><p>channel中只能存放指定的数据类型</p>
</li>
<li><p>channle的数据放满后，就不能再放入了</p>
</li>
<li><p>如果从 channel 取出数据后，可以继续放入</p>
</li>
<li><p>在没有使用协程的情况下，如果 channel 数据取完了，再取，就会报 dead lock</p>
</li>
</ol>
<h3 id="读写channel案例演示"><a href="#读写channel案例演示" class="headerlink" title="读写channel案例演示"></a>读写channel案例演示</h3><ul>
<li>创建一个intChan, 最多可以存放3个int, 演示存3个数据到intChan, 然后再取出这三个int</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> intChan <span class="keyword">chan</span> <span class="keyword">int</span></span><br><span class="line">	intChan = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">3</span>)</span><br><span class="line">	intChan &lt;- <span class="number">10</span></span><br><span class="line">	intChan &lt;- <span class="number">20</span></span><br><span class="line">	intChan &lt;- <span class="number">10</span></span><br><span class="line">	<span class="comment">//因为 intChan 的容量为3, 再存放会报告 dead lock</span></span><br><span class="line">	<span class="comment">//intChan &lt;- 50</span></span><br><span class="line">	num1 := &lt;-intChan</span><br><span class="line">	num2 := &lt;-intChan</span><br><span class="line">	num3 := &lt;-intChan</span><br><span class="line">	<span class="comment">//因为 intChan 这时已经没有数据了, 再取就会报告 deadlock</span></span><br><span class="line">	<span class="comment">//num4 := &lt;- intChan</span></span><br><span class="line">	fmt.Printf(<span class="string">"num1=%v num2=%v num3=%v\n"</span>, num1, num2, num3)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>创建一个mapChan,最多可以存放10个map[string]string, 的 key-value,演示写入和读取</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> mapChan <span class="keyword">chan</span> <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">	mapChan = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">10</span>)</span><br><span class="line">	m1 := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">20</span>)</span><br><span class="line">	m1[<span class="string">"city1"</span>] = <span class="string">"北京"</span></span><br><span class="line">	m1[<span class="string">"city2"</span>] = <span class="string">"天津"</span></span><br><span class="line"></span><br><span class="line">	m2 := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">20</span>)</span><br><span class="line">	m2[<span class="string">"hero1"</span>] = <span class="string">"宋江"</span></span><br><span class="line">	m2[<span class="string">"hero2"</span>] = <span class="string">"武松"</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//写入channel</span></span><br><span class="line">	mapChan &lt;- m1</span><br><span class="line">	mapChan &lt;- m2</span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义一个数组接收channel数值</span></span><br><span class="line">	<span class="keyword">var</span> arr []<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span> = []<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>&#123;&#125;</span><br><span class="line">	arr = <span class="built_in">make</span>([]<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">	l := <span class="built_in">len</span>(mapChan) <span class="comment">//提前记录好channel的长度,因为每一次循环,channel的长度都会发生变化</span></span><br><span class="line">	<span class="comment">//循环输出</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; l; i++ &#123;</span><br><span class="line">		arr[i] = &lt;-mapChan</span><br><span class="line">		fmt.Printf(<span class="string">"第 %v 个值为 %v \n"</span>, i+<span class="number">1</span>, arr[i])</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5i0j54r0bj20ds017wei.jpg" alt="image-20220824180451127"></p>
<ul>
<li>创建一个catChan,最多可以存放10个Cat结构体变量,演示写入和读取的方法</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Cat <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> catChan <span class="keyword">chan</span> Cat</span><br><span class="line">	catChan = <span class="built_in">make</span>(<span class="keyword">chan</span> Cat, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">	cat1 := Cat&#123;Name: <span class="string">"tom"</span>&#125;</span><br><span class="line">	cat2 := Cat&#123;Name: <span class="string">"jerry"</span>&#125;</span><br><span class="line">	catChan &lt;- cat1</span><br><span class="line">	catChan &lt;- cat2</span><br><span class="line"></span><br><span class="line">	cat11 := &lt;-catChan</span><br><span class="line">	cat22 := &lt;-catChan</span><br><span class="line"></span><br><span class="line">	fmt.Println(cat11, cat22)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5iyr8kt79j20e700swef.jpg" alt="image-20220825134857715"></p>
<ul>
<li>创建一个catChan,最多可以存放10个 *Cat 结构体变量,演示写入和读取的方法</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Cat <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> catChan <span class="keyword">chan</span> *Cat</span><br><span class="line">	catChan = <span class="built_in">make</span>(<span class="keyword">chan</span> *Cat, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">	cat1 := Cat&#123;Name: <span class="string">"tom"</span>&#125;</span><br><span class="line">	cat2 := Cat&#123;Name: <span class="string">"jerry"</span>&#125;</span><br><span class="line">	catChan &lt;- &amp;cat1</span><br><span class="line">	catChan &lt;- &amp;cat2</span><br><span class="line"></span><br><span class="line">	cat11 := &lt;-catChan</span><br><span class="line">	cat22 := &lt;-catChan</span><br><span class="line"></span><br><span class="line">	fmt.Println(cat11, cat22)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5iyueduboj20dx00u3yg.jpg" alt="image-20220825135202335"></p>
<ul>
<li>创建一个allChan,最多可以存放10个任意数据类型变量,演示写入和读取的方法</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Cat <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> allChan <span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	allChan = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">	cat1 := Cat&#123;Name: <span class="string">"tom"</span>&#125;</span><br><span class="line">	cat2 := Cat&#123;Name: <span class="string">"jerry"</span>&#125;</span><br><span class="line">	allChan &lt;- cat1</span><br><span class="line">	allChan &lt;- cat2</span><br><span class="line">	allChan &lt;- <span class="number">10</span></span><br><span class="line">	allChan &lt;- <span class="string">"fuck"</span></span><br><span class="line"></span><br><span class="line">	cat11 := &lt;-allChan</span><br><span class="line">	cat22 := &lt;-allChan</span><br><span class="line">	v1 := &lt;-allChan</span><br><span class="line">	v2 := &lt;-allChan</span><br><span class="line"></span><br><span class="line">	fmt.Println(cat11, cat22, v1, v2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5izdtyzidj20dw00t748.jpg" alt="image-20220825141042792"></p>
<ul>
<li>观察以下代码,会出现什么问题?</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Cat <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> allChan <span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	allChan = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">	cat1 := Cat&#123;Name: <span class="string">"tom"</span>&#125;</span><br><span class="line">	cat2 := Cat&#123;Name: <span class="string">"jerry"</span>&#125;</span><br><span class="line">	allChan &lt;- cat1</span><br><span class="line">	allChan &lt;- cat2</span><br><span class="line">	allChan &lt;- <span class="number">10</span></span><br><span class="line">	allChan &lt;- <span class="string">"fuck"</span></span><br><span class="line"></span><br><span class="line">	cat11 := &lt;-allChan</span><br><span class="line"></span><br><span class="line">	fmt.Println(cat11.Name)	<span class="comment">//直接调用会出现问题</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>代码改进</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Cat <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> allChan <span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">	allChan = <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">interface</span>&#123;&#125;, <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">	cat1 := Cat&#123;Name: <span class="string">"tom"</span>&#125;</span><br><span class="line">	cat2 := Cat&#123;Name: <span class="string">"jerry"</span>&#125;</span><br><span class="line">	allChan &lt;- cat1</span><br><span class="line">	allChan &lt;- cat2</span><br><span class="line">	allChan &lt;- <span class="number">10</span></span><br><span class="line">	allChan &lt;- <span class="string">"fuck"</span></span><br><span class="line"></span><br><span class="line">	cat11 := &lt;-allChan</span><br><span class="line">	name := cat11.(Cat)</span><br><span class="line"></span><br><span class="line">	fmt.Println(name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5j0npbdgyj20dp00rgli.jpg" alt="image-20220825145447755"></p>
<h3 id="channel的遍历和关闭"><a href="#channel的遍历和关闭" class="headerlink" title="channel的遍历和关闭"></a>channel的遍历和关闭</h3><h4 id="channel的关闭"><a href="#channel的关闭" class="headerlink" title="channel的关闭"></a>channel的关闭</h4><blockquote>
<p>  使用内置函数 close 可以关闭 channel, 当 channel 关闭后，就不能再向 channel 写数据了，但是仍然可以从该 channel 读取数据</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	intChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">3</span>)</span><br><span class="line">	intChan &lt;- <span class="number">100</span></span><br><span class="line">	intChan &lt;- <span class="number">200</span></span><br><span class="line">	<span class="built_in">close</span>(intChan)</span><br><span class="line">	<span class="comment">//这时不能够再写入数到 channel</span></span><br><span class="line">	<span class="comment">//intChan &lt;- 300</span></span><br><span class="line">	fmt.Println(<span class="string">"ok~"</span>)</span><br><span class="line">	<span class="comment">//当管道关闭后,可以读取数据</span></span><br><span class="line">	n1 := &lt;-intChan</span><br><span class="line">	fmt.Println(<span class="string">"n1="</span>, n1)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="channel的遍历"><a href="#channel的遍历" class="headerlink" title="channel的遍历"></a>channel的遍历</h4><p>channel 支持 for–range 的方式进行遍历，请注意两个细节:</p>
<ol>
<li><p>在遍历时，如果 channel 没有关闭，则回出现 deadlock 的错误</p>
</li>
<li><p>在遍历时，如果 channel 已经关闭，则会正常遍历数据，遍历完后，就会退出遍历。</p>
</li>
</ol>
<ul>
<li>演示案例</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	intChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">100</span>)</span><br><span class="line">	<span class="comment">//for i := 0; i &lt; len(intChan); i++ &#123;&#125;	//遍历管道不能使用普通的 for 循环</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">100</span>; i++ &#123;</span><br><span class="line">		intChan &lt;- i * <span class="number">2</span> <span class="comment">//放入100个数据到管道</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//在遍历时,如果channel没有关闭, 则会出现deadlock的错误</span></span><br><span class="line">	<span class="comment">//在遍历时,如果channel已经关闭, 则会正常遍历数据, 遍历完后, 就会退出遍历</span></span><br><span class="line">	<span class="built_in">close</span>(intChan)</span><br><span class="line">	<span class="keyword">for</span> v := <span class="keyword">range</span> intChan &#123;</span><br><span class="line">		fmt.Println(<span class="string">"v="</span>, v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>应用实例1</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5j2o9jzqpj20j003wq3e.jpg" alt="image-20220825160432841"></p>
<blockquote>
<p>  请完成goroutine和channel协同工作的案例,具体要求:</p>
<p>  1)   开启一个writeData协程,向管道intChan中读取writeData写入的数据<br>  2)   开启一个readData协程,从管道intChan中读取writeData写入的数据<br>  3)   注意: writeData和readData操作的是同一个管道<br>  4)   主线程需要等待writeData和readData协程都完成工作才能退出管道</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//写数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">writeData</span><span class="params">(intChan <span class="keyword">chan</span> <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">50</span>; i++ &#123;</span><br><span class="line">		<span class="comment">//放入数据</span></span><br><span class="line">		intChan &lt;- i</span><br><span class="line">		fmt.Println(<span class="string">"writeData "</span>, i)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">close</span>(intChan) <span class="comment">//关闭</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//读数据</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">readData</span><span class="params">(intChan <span class="keyword">chan</span> <span class="keyword">int</span>, exitChan <span class="keyword">chan</span> <span class="keyword">bool</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		v, ok := &lt;-intChan</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Printf(<span class="string">"readData 读到数据=%v\n"</span>, v)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//readData 读取完数据后, 即任务完成</span></span><br><span class="line">	exitChan &lt;- <span class="literal">true</span></span><br><span class="line">	<span class="built_in">close</span>(exitChan)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//创建两个管道</span></span><br><span class="line">	intChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">50</span>)</span><br><span class="line">	exitChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> writeData(intChan)</span><br><span class="line">	<span class="keyword">go</span> readData(intChan, exitChan)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		_, ok := &lt;-exitChan</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5j48gncymj20p109jmy2.jpg" alt="image-20220825165832881"></p>
<ul>
<li>应用实例2-阻塞</li>
</ul>
<blockquote>
<p>  如果将上面代码中的<code>readData</code>协程注释掉,不进行读操作,会怎么样?</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//创建两个管道</span></span><br><span class="line">	intChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">50</span>)</span><br><span class="line">	exitChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">go</span> writeData(intChan)</span><br><span class="line">	<span class="comment">//go readData(intChan, exitChan)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		_, ok := &lt;-exitChan</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样做的话,程序只是向管道内写入数据,而没有进行读取,就会出现阻塞deadlock, 原因是intChan容量是10,而代码writeData会写入50个数据,因此会阻塞在 writeData 的 channel &lt;- i</p>
<ul>
<li>应用实例3</li>
</ul>
<blockquote>
<p>  要求统计 1-200000 的数字中，哪些是素数?这个问题在本章开篇就提出了，现在我们有 goroutine 和 channel 的知识后，就可以完成了 [测试数据: 80000]</p>
</blockquote>
<p>传统的方法，就是使用一个循环，循环的判断各个数是不是素数【ok】。</p>
<p> 使用并发/并行的方式，将统计素数的任务分配给多个(4 个)goroutine 去完成，完成任务时间短。</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5j4xtn7yaj20ph0aa3zo.jpg" alt="image-20220825172254870"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//向 intChan 放入 1-8000个数</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">putNum</span><span class="params">(intChan <span class="keyword">chan</span> <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">1</span>; i &lt;= <span class="number">8000</span>; i++ &#123;</span><br><span class="line">		intChan &lt;- i</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//关闭 intChan</span></span><br><span class="line">	<span class="built_in">close</span>(intChan)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//从 intChan 取出数据, 并判断是否为素数,如果是, 就放入到 primeChan</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">primeNum</span><span class="params">(intChan <span class="keyword">chan</span> <span class="keyword">int</span>, primeChan <span class="keyword">chan</span> <span class="keyword">int</span>, exitChan <span class="keyword">chan</span> <span class="keyword">bool</span>)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> flag <span class="keyword">bool</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//循环读取数据,进行素数的判断</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		time.Sleep(time.Millisecond * <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">		num, ok := &lt;-intChan <span class="comment">//读取数据</span></span><br><span class="line">		<span class="keyword">if</span> !ok &#123;             <span class="comment">//intChan取不到</span></span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		flag = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//判断 num 是不是素数</span></span><br><span class="line">		<span class="comment">//取余数,除了1和其本身以外,结果都不能为0的话,那么这个数就为素数</span></span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">2</span>; i &lt; num; i++ &#123;</span><br><span class="line">			<span class="keyword">if</span> num%i == <span class="number">0</span> &#123;</span><br><span class="line">				flag = <span class="literal">false</span></span><br><span class="line">				<span class="keyword">break</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> flag &#123;</span><br><span class="line">			<span class="comment">//将这个数放入到 primeChan</span></span><br><span class="line">			primeChan &lt;- num</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"有一个 primeNum 协程因为取不到数据, 退出"</span>)</span><br><span class="line">	<span class="comment">//这里我们还不能关闭 primeChan</span></span><br><span class="line">	<span class="comment">//向 exitChan 写入 true</span></span><br><span class="line">	exitChan &lt;- <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//声明管道</span></span><br><span class="line">	intChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">1000</span>)</span><br><span class="line">	primeChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">2000</span>) <span class="comment">//放入结果</span></span><br><span class="line">	exitChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">bool</span>, <span class="number">4</span>)    <span class="comment">//因为有4个协程</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//开启一个协程, 向 intChan 放入 1-8000 个数</span></span><br><span class="line">	<span class="keyword">go</span> putNum(intChan)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//开启 4 个协程, 从 intChan 取出数据, 并判断是否为素数, 如果是,则放入到 primeChan</span></span><br><span class="line">	<span class="comment">//4 个协程都是使用的同一个管道</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">		<span class="keyword">go</span> primeNum(intChan, primeChan, exitChan)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//这里我们主线程, 进行处理</span></span><br><span class="line">	<span class="comment">//这里利用协程go去跑(相当于在后台跑),我们就可以马上在下面输出素数的结果</span></span><br><span class="line">	<span class="keyword">go</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">4</span>; i++ &#123;</span><br><span class="line">			&lt;-exitChan <span class="comment">//当管道 exitChan 没有数据时,这个循环就会一直处于等待状态</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//当我们从 exitChan 取出了 4 个结果, 就可以放心的关闭 primeChan</span></span><br><span class="line">		<span class="built_in">close</span>(primeChan)</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"开始输出素数..."</span>)</span><br><span class="line">	<span class="comment">//遍历我们的 primeChan, 把结果取出</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		res, ok := &lt;-primeChan</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//将结果输出</span></span><br><span class="line">		fmt.Printf(<span class="string">"素数=%d\n"</span>, res)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"main 线程退出"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果:</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k3jm7w6kj209y03lq30.jpg" alt="image-20220826132011866"></p>
<h4 id="channel注意事项"><a href="#channel注意事项" class="headerlink" title="channel注意事项"></a>channel注意事项</h4><ul>
<li>channel可以声明为只读，或者只写性质</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//1.在默认情况下, 管道时双向的</span></span><br><span class="line">	<span class="comment">//var chan1 chan int	//可读可写</span></span><br><span class="line">	<span class="comment">//2.声明为只写</span></span><br><span class="line">	chan2 := <span class="built_in">make</span>(<span class="keyword">chan</span>&lt;- <span class="keyword">int</span>, <span class="number">3</span>)</span><br><span class="line">	chan2 &lt;- <span class="number">20</span></span><br><span class="line">	<span class="comment">//num := &lt;-chan2	//error</span></span><br><span class="line">	fmt.Println(<span class="string">"chan2="</span>, chan2)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//3.声明为只读</span></span><br><span class="line">	<span class="keyword">var</span> chan3 &lt;-<span class="keyword">chan</span> <span class="keyword">int</span></span><br><span class="line">	num2 := &lt;-chan3</span><br><span class="line">	<span class="comment">//chan3&lt;- 30	//error</span></span><br><span class="line">	fmt.Println(<span class="string">"num2="</span>, num2)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>channel只读和只写的最佳实践案例</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//只写</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">send</span><span class="params">(ch <span class="keyword">chan</span>&lt;- <span class="keyword">int</span>, exitChan <span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		ch &lt;- i</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">close</span>(ch)</span><br><span class="line">	<span class="keyword">var</span> a <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line">	exitChan &lt;- a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//只读</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">recv</span><span class="params">(ch &lt;-<span class="keyword">chan</span> <span class="keyword">int</span>, exitChan <span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		v, ok := &lt;-ch</span><br><span class="line">		<span class="keyword">if</span> !ok &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(v)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">var</span> a <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line">	exitChan &lt;- a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	ch := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">10</span>)</span><br><span class="line">	exitChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">struct</span>&#123;&#125;, <span class="number">2</span>)</span><br><span class="line">	<span class="keyword">go</span> send(ch, exitChan)</span><br><span class="line">	<span class="keyword">go</span> recv(ch, exitChan)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> total = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> <span class="keyword">range</span> exitChan &#123;</span><br><span class="line">		total++</span><br><span class="line">		<span class="keyword">if</span> total == <span class="number">2</span> &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"结束..."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k53eg7zvj20e304p749.jpg" alt="image-20220826141350828"></p>
<ul>
<li>使用 select 可以解决从管道取数据的阻塞问题</li>
</ul>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//使用 select 可以解决从管道取数据的阻塞问题</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//1.定义一个管道; 10个数据 int</span></span><br><span class="line">	intChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">int</span>, <span class="number">10</span>)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		intChan &lt;- i</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2.定义一个管道; 5个数据 string</span></span><br><span class="line">	stringChan := <span class="built_in">make</span>(<span class="keyword">chan</span> <span class="keyword">string</span>, <span class="number">5</span>)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">5</span>; i++ &#123;</span><br><span class="line">		stringChan &lt;- <span class="string">"hello"</span> + fmt.Sprintf(<span class="string">"%d"</span>, i)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//传统的方法在遍历管道时, 如果不关闭会阻塞而导致 deadlock</span></span><br><span class="line">	<span class="comment">//问题: 在实际开发中, 可能我们不好确定什么时候关闭该管道</span></span><br><span class="line">	<span class="comment">//可以使用 select 方式来解决</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="keyword">select</span> &#123;</span><br><span class="line">		<span class="comment">//注意, 如果 intChan 一直没有关闭, 不会一直阻塞而 deadlock</span></span><br><span class="line">		<span class="comment">//会自动到下一个 case 匹配</span></span><br><span class="line">		<span class="keyword">case</span> v := &lt;-intChan:</span><br><span class="line">			fmt.Printf(<span class="string">"从 intChan 读取的数据%d\n"</span>, v)</span><br><span class="line">			time.Sleep(time.Second)</span><br><span class="line">		<span class="keyword">case</span> v := &lt;-stringChan:</span><br><span class="line">			fmt.Printf(<span class="string">"从 stringChan 读取的数据%s\n"</span>, v)</span><br><span class="line">			time.Sleep(time.Second)</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Printf(<span class="string">"都取不到了, 不玩儿了, 程序员可以加入逻辑\n"</span>)</span><br><span class="line">			time.Sleep(time.Second)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k5s7as6sj20dz06l3z3.jpg" alt="image-20220826143741097"></p>
<ul>
<li>goroutine中使用recover，解决协程中出现panic，导致程序崩溃问题</li>
</ul>
<blockquote>
<p>  如果我们启动了一个协程, 但是这个协程出现了panic, 如果我们没有捕获到这和panic,就会造成整个程序崩溃,这时我们可以在 goroutine 中使用 recover 来捕获 panic, 进行处理,这样即使这个协程发生了问题,但是主线程仍然不受影响,可以继续执行</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">sayHello</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		time.Sleep(time.Second)</span><br><span class="line">		fmt.Println(<span class="string">"hello world"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//这里我们可以使用 defer + recover</span></span><br><span class="line">	<span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">		<span class="comment">//捕获 test 抛出的 panic</span></span><br><span class="line">		<span class="keyword">if</span> err := <span class="built_in">recover</span>(); err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"test() 发生错误"</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//定义一个 map</span></span><br><span class="line">	<span class="keyword">var</span> myMap <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">string</span></span><br><span class="line">	<span class="comment">// myMap = make(map[int]string, 0)</span></span><br><span class="line">	myMap[<span class="number">0</span>] = <span class="string">"golang"</span> <span class="comment">//error</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">go</span> sayHello()</span><br><span class="line">	<span class="keyword">go</span> test()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">		fmt.Println(<span class="string">"main() ok="</span>, i)</span><br><span class="line">		time.Sleep(time.Second)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k6ip1kt0j20e608lq3b.jpg" alt="image-20220826150308756"></p>
<h1 id="反射"><a href="#反射" class="headerlink" title="反射"></a>反射</h1><h2 id="反射的基本介绍"><a href="#反射的基本介绍" class="headerlink" title="反射的基本介绍"></a>反射的基本介绍</h2><p>1) 反射可以在运行时<strong>动态获取变量的各种信息</strong>, 比如变量的类型(type)，类别(kind)<br>2) 如果是结构体变量，还可以获取到结构体本身的信息(包括结构体的<strong>字段、方法</strong>)<br>3) 通过反射，可以修改变量的值，可以调用关联的方法。<br>4) 使用反射，需要 <strong>import (“reflect”)</strong></p>
<blockquote>
<p>包反射实现运行时反射，允许程序操作具有任意类型的对象。典型的用法是使用静态类型接口{}获取一个值，并通过调用TypeOf提取其动态类型信息，它返回一个type。</p>
<p>对ValueOf的调用将返回一个表示运行时数据的Value。Zero接受一个Type并返回一个Value，表示该类型的0值。</p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k7xzsuxwj20kl0dp0tl.jpg" alt="image-20220826155226051"></p>
<h2 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h2><p>常见的反射应用场景有以下两种</p>
<ol>
<li>不知道接口调用哪个<code>函数</code>,根据传入参数在运行时确定调用的具体接口,这种需要对<strong>函数</strong>或<strong>方法</strong><code>反射</code>,例如以下这种桥接模式,比如我前面提出问题</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">bridge</span><span class="params">(funcPtr <span class="keyword">interface</span>&#123;&#125;, args ...<span class="keyword">interface</span>&#123;&#125;)</span></span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>  第一个参数 funcPtr 以接口的形式传入函数指针,函数参数 args 以可变参数的形式传入,bridge 函数中可以用反射来动态执行 funcPtr 函数</p>
</blockquote>
<ol start="2">
<li>对结构体序列化时, 如果结构体有指定Tag,也会使用到反射生成对应的字符串</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Monster <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span> <span class="string">`json:"name"`</span>	<span class="comment">//打标签,注意冒号后面不要加空格</span></span><br><span class="line">	Age   <span class="keyword">int</span>    <span class="string">`json:"age"`</span></span><br><span class="line">	Skill <span class="keyword">string</span> <span class="string">`json:"skill"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	monster := Monster&#123;<span class="string">"牛魔王"</span>, <span class="number">500</span>, <span class="string">"芭蕉扇"</span>&#125;</span><br><span class="line">	<span class="comment">//将monster变量序列化为 json 格式字符串</span></span><br><span class="line">	<span class="comment">//json.Marshal 函数中使用反射,这个讲解反射时,再详细介绍</span></span><br><span class="line">	jsonStr, err := json.Marshal(monster)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json 处理错误"</span>, err)</span><br><span class="line">	&#125;</span><br><span class="line"> 	fmt.Println(<span class="string">"jsonStr"</span>, jsonStr)	<span class="comment">//输出byte</span></span><br><span class="line">	fmt.Println(<span class="string">"jsonStr"</span>, <span class="keyword">string</span>(jsonStr))	<span class="comment">//byte转字符串</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="反射重要的函数和概念"><a href="#反射重要的函数和概念" class="headerlink" title="反射重要的函数和概念"></a>反射重要的函数和概念</h2><ol>
<li>reflect.TypeOf(变量名), 获取变量名的类型,返回reflect.Type类型</li>
<li>reflect.ValueOf(变量名), 获取变量的值,返回reflect.Value类型;reflect.Value 是一个结构体类型,通过 reflect.Value, 可以获取到关于该变量的很多信息</li>
<li>变量、interface{} 和 reflect.Value 是可以相互转换的,这点在实际开发中,会经常使用到</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k9akglc2j20pz09yab5.jpg" alt="image-20220826163907646"></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5k9k5j4u3j20nd067q3h.jpg" alt="image-20220826164820453"></p>
<h2 id="反射的快速入门"><a href="#反射的快速入门" class="headerlink" title="反射的快速入门"></a>反射的快速入门</h2><blockquote>
<p>  请编写一个案例，演示对(结构体类型、interface{}、reflect.Value)进行反射的基本操作</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//演示反射</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reflectTest01</span><span class="params">(b <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	<span class="comment">//通过反射获取的传入的变量的 type, kind 值</span></span><br><span class="line">	<span class="comment">//1. 先获取到 reflect.Type</span></span><br><span class="line">	rType := reflect.TypeOf(b)</span><br><span class="line">	fmt.Println(<span class="string">"rType="</span>, rType)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2. 获取到 reflect.Value</span></span><br><span class="line">	rVal := reflect.ValueOf(b)</span><br><span class="line"></span><br><span class="line">	n2 := <span class="number">2</span> + rVal.Int()</span><br><span class="line">	fmt.Println(<span class="string">"n2="</span>, n2)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"rVal=%v rVal type=%T\n"</span>, rVal, rVal)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//下面我们将 rVal 转成 interface&#123;&#125;</span></span><br><span class="line">	iV := rVal.Interface()</span><br><span class="line">	<span class="comment">//将 interface&#123;&#125; 通过断言转成需要的类型</span></span><br><span class="line">	num2 := iV.(<span class="keyword">int</span>)</span><br><span class="line">	fmt.Println(<span class="string">"num2="</span>, num2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//演示反射(对结构体的反射)</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">reflectTest02</span><span class="params">(b <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	<span class="comment">//通过反射获取的传入的变量 type kind 值</span></span><br><span class="line">	<span class="comment">//1. 先获取到 reflect.Type</span></span><br><span class="line">	rType := reflect.TypeOf(b)</span><br><span class="line">	fmt.Println(<span class="string">"rType="</span>, rType)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2. 获取到 reflect.Value</span></span><br><span class="line">	rVal := reflect.ValueOf(b)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//下面我们将 rVal 转成 interface&#123;&#125;</span></span><br><span class="line">	iV := rVal.Interface()</span><br><span class="line">	fmt.Printf(<span class="string">"iv=%v iv type=%T\n"</span>, iV, iV)</span><br><span class="line">	<span class="comment">//将 interface&#123;&#125; 通过断言转成 需要的类型</span></span><br><span class="line">	<span class="comment">//这里,我们就简单使用了一带检测的类型断言</span></span><br><span class="line">	<span class="comment">//可以使用 switch 的断言形式来做的更加的灵活</span></span><br><span class="line">	stu, ok := iV.(Student)</span><br><span class="line">	<span class="keyword">if</span> ok &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"stu.Name=%v\n"</span>, stu.Name)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Student <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Monster <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name <span class="keyword">string</span></span><br><span class="line">	Age  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//编写一个案例</span></span><br><span class="line">	<span class="comment">//演示对(基本数据类型/interface&#123;&#125;/reflect.Value)进行反射的基本操作</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//1.先定义一个 int</span></span><br><span class="line">	<span class="comment">//var num int = 0</span></span><br><span class="line">	<span class="comment">//reflectTest01(num)</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//2.定义一个 Student 的实例</span></span><br><span class="line">	stu := Student&#123;</span><br><span class="line">		Name: <span class="string">"tom"</span>,</span><br><span class="line">		Age:  <span class="number">20</span>,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	reflectTest02(stu)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5kaoow6psj20dc01jgll.jpg" alt="image-20220826172718494"></p>
<p>可以参考文章<a href="https://blog.csdn.net/u011957758/article/details/81193806?spm=1001.2101.3001.6661.1&utm_medium=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-1-81193806-blog-124157357.pc_relevant_vip_default&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-1-81193806-blog-124157357.pc_relevant_vip_default&utm_relevant_index=1" target="_blank" rel="noopener">golang反射案例</a></p>
<h2 id="反射的注意事项"><a href="#反射的注意事项" class="headerlink" title="反射的注意事项"></a>反射的注意事项</h2><ol>
<li>reflect.Value.Kind，获取变量的类别，返回的是一个常量</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5l50ln74xj20kk0n3gmi.jpg" alt="image-20220827105639952"></p>
<ol start="2">
<li>Type 和 Kind 的区别</li>
</ol>
<p>Type 是<code>类型</code>, Kind 是<code>类别</code>， Type 和 Kind 可能是相同的，也可能是不同的.<br><strong>比如(相同):</strong> <code>var num int = 10</code>, num的Type是int , Kind也是int<br><strong>比如(不同):</strong> <code>var stu Student</code>, stu 的 Type 是 pkg1.Student , Kind 是 struct</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> n <span class="keyword">int64</span> = <span class="number">10</span></span><br><span class="line">	nType := reflect.TypeOf(n)</span><br><span class="line">	nKind := reflect.Kind(n)</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"n的Type=%v n的Kind=%v\n"</span>, nType, nKind)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">n的Type=<span class="keyword">int64</span> n的Kind=<span class="keyword">uint32</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><p>通过反射可以在让变量在 <code>interface{}</code> 和 <code>reflect.Value</code> 之间相互转换</p>
</li>
<li><p>使用反射的方式来获取变量的值(并返回对应的类型),要求数据类型匹配,比如 x 是 int类型,那么就应该使用 <code>reflect.Value(x).Int()</code>, 而不能使用其他的,否则报<code>panic</code></p>
</li>
<li><p>通过反射的来修改变量, 注意当使用 <code>SetXxx</code> 方法来设置需要通过对应的指针类型来完成, 这样才能改变传入的变量的值, 同时需要使用到 <code>reflect.Value.Elem()</code></p>
</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">testInt</span><span class="params">(b <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	val := reflect.ValueOf(b)</span><br><span class="line">	fmt.Printf(<span class="string">"val type=%T\n"</span>, val)</span><br><span class="line">	val.Elem().SetInt(<span class="number">110</span>) <span class="comment">//修改传入的值</span></span><br><span class="line">	fmt.Printf(<span class="string">"val=%v\n"</span>, val)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> num <span class="keyword">int</span> = <span class="number">20</span></span><br><span class="line">	testInt(&amp;num) <span class="comment">//指向地址</span></span><br><span class="line">	fmt.Println(<span class="string">"num="</span>, num)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">val <span class="keyword">type</span>=reflect.Value</span><br><span class="line">val=<span class="number">0xc0000140a0</span></span><br><span class="line">num= <span class="number">110</span></span><br></pre></td></tr></table></figure>

<ol start="6">
<li>reflect.Value.Elem() 应该如何理解?</li>
</ol>
<ul>
<li>Elem() 用于获取指针指向变量</li>
</ul>
<h2 id="反射最佳实践"><a href="#反射最佳实践" class="headerlink" title="反射最佳实践"></a>反射最佳实践</h2><blockquote>
<p>  使用反射来遍历结构体的字段，调用结构体的方法，并获取结构体标签的值</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义一个 Monster 结构体</span></span><br><span class="line"><span class="keyword">type</span> Monster <span class="keyword">struct</span> &#123;</span><br><span class="line">	Name  <span class="keyword">string</span>  <span class="string">`json:"name"`</span></span><br><span class="line">	Age   <span class="keyword">int</span>     <span class="string">`json:"monster_age"`</span></span><br><span class="line">	Score <span class="keyword">float32</span> <span class="string">`json:"成绩"`</span></span><br><span class="line">	Sex   <span class="keyword">string</span>  <span class="string">`json:"性别"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法: 返回两个数的和</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Monster)</span> <span class="title">GetSum</span><span class="params">(n1, n2 <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> n1 + n2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法: 接收四个值,给 s 赋值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Monster)</span> <span class="title">Set</span><span class="params">(name <span class="keyword">string</span>, age <span class="keyword">int</span>, score <span class="keyword">float32</span>, sex <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">	s.Name = name</span><br><span class="line">	s.Age = age</span><br><span class="line">	s.Score = score</span><br><span class="line">	s.Sex = sex</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法: 显示 s 的值</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Monster)</span> <span class="title">Print</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"----start----"</span>)</span><br><span class="line">	fmt.Println(s)</span><br><span class="line">	fmt.Println(<span class="string">"-----end-----"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestStruct</span><span class="params">(a <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	<span class="comment">//获取 reflect.Type 的类型</span></span><br><span class="line">	typ := reflect.TypeOf(a)</span><br><span class="line">	<span class="comment">//获取 reflect.Value 的类型</span></span><br><span class="line">	val := reflect.ValueOf(a)</span><br><span class="line">	<span class="comment">//获取到 a 对应的类别</span></span><br><span class="line">	kd := val.Kind()</span><br><span class="line">	<span class="comment">//如果传入的不是struct,就退出</span></span><br><span class="line">	<span class="keyword">if</span> kd != reflect.Struct &#123;</span><br><span class="line">		fmt.Println(<span class="string">"expect struct"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取到该结构体有几个字段</span></span><br><span class="line">	num := val.NumField()</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"struct has %d fields\n"</span>, num) <span class="comment">//4</span></span><br><span class="line">	<span class="comment">//变量结构体的所有字段</span></span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; num; i++ &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"Field %d: 值为=%v\n"</span>, i, val.Field(i))</span><br><span class="line">		<span class="comment">//获取到 struct 标签, 注意需要通过 reflect.Type 来获取 tag 标签的值</span></span><br><span class="line">		tagVal := typ.Field(i).Tag.Get(<span class="string">"json"</span>)</span><br><span class="line">		<span class="comment">//如果该字段于 tag 标签就显示, 否则就不显示</span></span><br><span class="line">		<span class="keyword">if</span> tagVal != <span class="string">""</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">"Field %d: tag为=%v\n"</span>, i, tagVal)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取到该结构体有多少个方法</span></span><br><span class="line">	numOfMethod := val.NumMethod()</span><br><span class="line">	fmt.Printf(<span class="string">"struct has %d method\n"</span>, numOfMethod)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//var params []reflect.Value</span></span><br><span class="line">	<span class="comment">//方法的排序默认是按照 函数名 的排序(ASCII码)</span></span><br><span class="line">	val.Method(<span class="number">1</span>).Call(<span class="literal">nil</span>) <span class="comment">//获取到第二个方法,调用它</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//调用结构体的第一个方法 Method(0)</span></span><br><span class="line">	<span class="keyword">var</span> params []reflect.Value <span class="comment">//声明了 []reflect.Value</span></span><br><span class="line">	params = <span class="built_in">append</span>(params, reflect.ValueOf(<span class="number">10</span>))</span><br><span class="line">	params = <span class="built_in">append</span>(params, reflect.ValueOf(<span class="number">40</span>))</span><br><span class="line">	res := val.Method(<span class="number">0</span>).Call(params) <span class="comment">//传入的参数是 []reflect.Value, 返回 []reflect.Value</span></span><br><span class="line">	fmt.Println(<span class="string">"res="</span>, res[<span class="number">0</span>].Int()) <span class="comment">//返回结果, 返回的结果是 []reflect.Value*</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//创建一个 Monster 实例</span></span><br><span class="line">	<span class="keyword">var</span> a Monster = Monster&#123;</span><br><span class="line">		Name:  <span class="string">"黄皮子"</span>,</span><br><span class="line">		Age:   <span class="number">400</span>,</span><br><span class="line">		Score: <span class="number">30.8</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//将 Monster 实例传递给 TestStruct 函数</span></span><br><span class="line">	TestStruct(a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5ldm2sdjkj20de05waaa.jpg" alt="image-20220827155409764"></p>
<h2 id="个人练习"><a href="#个人练习" class="headerlink" title="个人练习"></a>个人练习</h2><blockquote>
<p>  要求:</p>
<ol>
<li>编写一个 Cal 结构体,有两个字段 Num1和Num2</li>
<li>Cal的方法 GetSub(name string)</li>
<li>使用反射遍历 Cal 结构体所有的字段信息</li>
<li>使用反射机制完成对 GetSub 的调用, 输出形式为 “tom完成了减法运行, 8 - 3 = 5”</li>
</ol>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"reflect"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Cal <span class="keyword">struct</span> &#123;</span><br><span class="line">	Num1 <span class="keyword">int</span> <span class="string">`json:"num1"`</span></span><br><span class="line">	Num2 <span class="keyword">int</span> <span class="string">`json:"num2"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法: 两数相减</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c Cal)</span> <span class="title">GetSub</span><span class="params">(name <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">	res := c.Num1 - c.Num2</span><br><span class="line">	fmt.Printf(<span class="string">"%v完成了减法运行, %d - %d = %d\n"</span>,name, c.Num1, c.Num2, res)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">TestReflect</span><span class="params">(inter <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">	interType := reflect.TypeOf(inter)</span><br><span class="line">	interValue := reflect.ValueOf(inter)</span><br><span class="line">	interKind := interValue.Kind()</span><br><span class="line">	<span class="keyword">if</span> interKind != reflect.Struct &#123;</span><br><span class="line">		fmt.Println(<span class="string">"不是结构体!"</span>)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	num := interValue.NumField()</span><br><span class="line">	fmt.Printf(<span class="string">"struct has %d fields\n"</span>, num)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; num; i++ &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"Field %d: 值为=%v\n"</span>, i, interValue.Field(i))</span><br><span class="line">		<span class="comment">//获取到 struct 标签, 注意需要通过 reflect.Type 来获取 tag 标签的值</span></span><br><span class="line">		tagVal := interType.Field(i).Tag.Get(<span class="string">"json"</span>)</span><br><span class="line">		<span class="comment">//如果该字段于 tag 标签就显示, 否则就不显示</span></span><br><span class="line">		<span class="keyword">if</span> tagVal != <span class="string">""</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">"Field %d: tag为=%v\n"</span>, i, tagVal)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//获取到该结构体有多少个方法</span></span><br><span class="line">	numOfMethod := interValue.NumMethod()</span><br><span class="line">	fmt.Printf(<span class="string">"struct has %d method\n"</span>, numOfMethod)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> na []reflect.Value</span><br><span class="line">	na = <span class="built_in">append</span>(na, reflect.ValueOf(<span class="string">"tom"</span>))</span><br><span class="line">	interValue.Method(<span class="number">0</span>).Call(na)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">var</span> a Cal = Cal&#123;</span><br><span class="line">		Num1: <span class="number">20</span>,</span><br><span class="line">		Num2: <span class="number">10</span>,</span><br><span class="line">	&#125;</span><br><span class="line">	TestReflect(a)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5lf67yuw0j20dd035glo.jpg" alt="image-20220827164807228"></p>
<h1 id="TCP编程"><a href="#TCP编程" class="headerlink" title="TCP编程"></a>TCP编程</h1><blockquote>
<p>  Golang 的主要设计目标之一就是面向大规模后端服务程序，网络通信这块是服务端程序必不可少也是至关重要的一部分。</p>
</blockquote>
<p><strong>网络编程有两种:</strong></p>
<p>1) <code>TCPsocket编程</code>，是网络编程的主流。之所以叫Tcpsocket编程，是因为底层是基于Tcp/ip协<br>议的. 比如: QQ 聊天<br>2) b/s结构的<code>http编程</code>，我们使用浏览器去访问服务器时，使用的就是http协议，而http底层依<br>旧是用 tcp socket 实现的。 比如: 京东商城 【这属于 go web 开发范畴 】</p>
<h2 id="TCP-IP协议"><a href="#TCP-IP协议" class="headerlink" title="TCP/IP协议"></a>TCP/IP协议</h2><blockquote>
<p>  TCP/IP(Transmission Control Protocol/Internet Protocol)的简写,中文译名为传输控制协议/因特网互联协议，又叫网络通讯协议，这个协议是 Internet 最基本的协议、Internet 国际互联网络的基础，简单地说，就是由网络层的 IP 协议和传输层的 TCP 协议组成的。</p>
</blockquote>
<h2 id="OSI与TCP-IP参考模型"><a href="#OSI与TCP-IP参考模型" class="headerlink" title="OSI与TCP/IP参考模型"></a>OSI与TCP/IP参考模型</h2><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5ok53g3xnj20l00ddt9j.jpg" alt="image-20220830095641831"></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5okpgqycfj20yp0i3ta5.jpg" alt="image-20220830101617864"></p>
<h2 id="端口"><a href="#端口" class="headerlink" title="端口"></a>端口</h2><ul>
<li>0号端口是保留端口</li>
<li>1-1024是固定端口(程序员不要使用)<ul>
<li>22 =&gt; SSH远程登录协议</li>
<li>23 =&gt; telnet</li>
<li>21 =&gt; ftp</li>
<li>25 =&gt; smtp</li>
<li>80 =&gt; iis</li>
<li>7   =&gt; echo</li>
</ul>
</li>
<li>1025-65535是动态端口(程序员可以使用)</li>
</ul>
<h2 id="TCP-SOCKET编程快速入门"><a href="#TCP-SOCKET编程快速入门" class="headerlink" title="TCP-SOCKET编程快速入门"></a>TCP-SOCKET编程快速入门</h2><h3 id="服务端的处理流程"><a href="#服务端的处理流程" class="headerlink" title="服务端的处理流程"></a>服务端的处理流程</h3><ol>
<li>监听端口 8888</li>
<li>接收客户端的 TCP 连接, 建立客户端和服务器端的链接</li>
<li>创建 goroutine, 处理该链接的请求(通常客户端会通过链接发送请求包)</li>
</ol>
<h3 id="客户端的处理流程"><a href="#客户端的处理流程" class="headerlink" title="客户端的处理流程"></a>客户端的处理流程</h3><ol>
<li>建立与服务端的链接</li>
<li>发送请求数据(终端), 接收服务器端返回的结果数据</li>
<li>关闭链接</li>
</ol>
<h3 id="流程示意图"><a href="#流程示意图" class="headerlink" title="流程示意图"></a>流程示意图</h3><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5olbf6aknj20g70e7751.jpg" alt="image-20220830103724207"></p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><h4 id="服务端代码"><a href="#服务端代码" class="headerlink" title="服务端代码"></a>服务端代码</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">process</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//创建一个新的切片</span></span><br><span class="line">		buf := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">1024</span>)</span><br><span class="line">		<span class="comment">//1.等待客户端通过 conn 发送信息</span></span><br><span class="line">		<span class="comment">//2.如果客户端没有 write[发送],那么协程就阻塞在这里</span></span><br><span class="line">		fmt.Printf(<span class="string">"服务器在等待客户端 %s 发送信息\n"</span>, conn.RemoteAddr().String())</span><br><span class="line">		n, err := conn.Read(buf) <span class="comment">//从 conn 读取</span></span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">"客户端退出 err=%v\n"</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//3.显示客户端发送的内容到服务器的终端</span></span><br><span class="line">		fmt.Print(<span class="keyword">string</span>(buf[:n]))</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"服务器开始监听..."</span>)</span><br><span class="line">	listen, err := net.Listen(<span class="string">"tcp"</span>, <span class="string">"0.0.0.0:8888"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"listen err=%v\n"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> listen.Close() <span class="comment">//延时关闭listen</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//循环等待客户端来链接我</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">//等待客户端链接</span></span><br><span class="line">		fmt.Println(<span class="string">"等待客户端来连接..."</span>)</span><br><span class="line">		conn, err := listen.Accept()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"Accept() err="</span>, err)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			fmt.Printf(<span class="string">"Accept() suc con=%v 客户端ip=%v\n"</span>, conn, conn.RemoteAddr().String())</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//这里准备一个协程, 为客户端服务</span></span><br><span class="line">		<span class="keyword">go</span> process(conn)</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//fmt.Printf("listen suc=%v\n", listen)</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="客户端代码"><a href="#客户端代码" class="headerlink" title="客户端代码"></a>客户端代码</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"bufio"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">	<span class="string">"strings"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	conn, err := net.Dial(<span class="string">"tcp"</span>, <span class="string">"127.0.0.1:8888"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"client dial err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//功能一: 客户端可以发送单行数据, 然后就退出</span></span><br><span class="line">	reader := bufio.NewReader(os.Stdin) <span class="comment">//os.Stdin 代表标准输入[终端]</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">//从终端读取一行用户数据, 并准备发送给服务器</span></span><br><span class="line">		line, err := reader.ReadString(<span class="string">'\n'</span>)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"readString err="</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//如果用户输入的是 exit 就退出</span></span><br><span class="line">		line = strings.Trim(line, <span class="string">"\r\n"</span>)</span><br><span class="line">		<span class="keyword">if</span> line == <span class="string">"exit"</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"客户端退出..."</span>)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//再将 line 发送给服务器</span></span><br><span class="line">		_, err = conn.Write([]<span class="keyword">byte</span>(line + <span class="string">"\n"</span>))</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"conn write err="</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="海量用户即时通讯系统"><a href="#海量用户即时通讯系统" class="headerlink" title="海量用户即时通讯系统"></a>海量用户即时通讯系统</h2><h3 id="开发流程"><a href="#开发流程" class="headerlink" title="开发流程"></a>开发流程</h3><ol>
<li>需求分析</li>
<li>设计阶段</li>
<li>编码实现</li>
<li>测试阶段</li>
<li>实施</li>
</ol>
<h3 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h3><ul>
<li><p>用户注册</p>
</li>
<li><p>用户登录</p>
</li>
<li><p>显示在线用户列表 4) 群聊(广播)</p>
</li>
<li><p>点对点聊天</p>
</li>
<li><p>离线留言</p>
<h3 id="界面设计"><a href="#界面设计" class="headerlink" title="界面设计"></a>界面设计</h3></li>
</ul>
<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5pq59ew8aj20im09tmxj.jpg" alt="image-20220831101000696" style="zoom:80%;">

<h3 id="数据库选择"><a href="#数据库选择" class="headerlink" title="数据库选择"></a>数据库选择</h3><blockquote>
<p>  项目要保存用户信息和消息数据,因此需要使用到数据库,这里我们选择使用 Redis 数据库</p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5pqbt08g4j20nz0eqgmp.jpg" alt="image-20220831101620024"></p>
<h3 id="实现功能"><a href="#实现功能" class="headerlink" title="实现功能"></a>实现功能</h3><h4 id="客户端登录菜单"><a href="#客户端登录菜单" class="headerlink" title="客户端登录菜单"></a>客户端登录菜单</h4><ul>
<li>功能: 显示客户端菜单</li>
<li>界面</li>
</ul>
<img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5pqea24gbj20m40bk0tb.jpg" alt="image-20220831101842927" style="zoom:67%;">

<ul>
<li><p>二级菜单</p>
<ul>
<li>显示在线用户列表</li>
<li>发送信息</li>
<li>信息列表</li>
<li>退出系统</li>
</ul>
</li>
<li><p>代码实现</p>
</li>
</ul>
<blockquote>
<p>  client/main.go</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//用户ID</span></span><br><span class="line"><span class="keyword">var</span> userId <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//用户密码</span></span><br><span class="line"><span class="keyword">var</span> userPwd <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//接收用户的选择</span></span><br><span class="line">	<span class="keyword">var</span> key <span class="keyword">string</span></span><br><span class="line">	<span class="comment">//判断是否继续显示菜单</span></span><br><span class="line">	<span class="keyword">var</span> loop = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"--------------------欢迎登录多人聊天系统--------------------"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"\t\t\t1 登录聊天室"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"\t\t\t2 注册用户"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"\t\t\tq 退出系统"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"请选择进行的操作[1|2|q]:"</span>)</span><br><span class="line">		fmt.Scanf(<span class="string">"%v\n"</span>, &amp;key)</span><br><span class="line">		<span class="keyword">switch</span> key &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"1"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"登录聊天室"</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"2"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"注册用户"</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"q"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"退出系统"</span>)</span><br><span class="line">			loop = <span class="literal">false</span></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Println(<span class="string">"输入有误, 请重新输入!"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> !loop &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> key == <span class="string">"1"</span> &#123; <span class="comment">//用户登录</span></span><br><span class="line">			fmt.Println(<span class="string">"请输入用户的Id:"</span>)</span><br><span class="line">			fmt.Scanf(<span class="string">"%v\n"</span>, &amp;userId)</span><br><span class="line">			fmt.Println(<span class="string">"请输入用户的密码:"</span>)</span><br><span class="line">			fmt.Scanf(<span class="string">"%v\n"</span>, &amp;userPwd)</span><br><span class="line"></span><br><span class="line">			err := login(userId, userPwd)</span><br><span class="line">			<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">				<span class="built_in">panic</span>(err)</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				fmt.Println(<span class="string">"登录成功"</span>)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  client/login.go</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">login</span><span class="params">(userId <span class="keyword">string</span>, userPwd <span class="keyword">string</span>)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line">	fmt.Printf(<span class="string">"userId=%v, userPwd=%v\n"</span>, userId, userPwd)</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5s6yta79tj20fk0bd3zd.jpg" alt="image-20220902132309821"></p>
<h4 id="客户端用户登录"><a href="#客户端用户登录" class="headerlink" title="客户端用户登录"></a>客户端用户登录</h4><h5 id="步骤一"><a href="#步骤一" class="headerlink" title="步骤一"></a>步骤一</h5><p><strong>思路分析:</strong></p>
<ol>
<li><p>先确定消息 Message 的格式和结构 </p>
</li>
<li><p>然后根据上图的分析完成代码</p>
</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5sb67tns2j20tu0dodir.jpg" alt="image-20220902154840174"></p>
<blockquote>
<p>  server/main.go</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/binary"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"redis/src/golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理客户端的通讯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">proc</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">	<span class="comment">//延时关闭conn</span></span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	buf := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">4096</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//循环接收客户端发送的信息</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"读取客户端发送的数据..."</span>)</span><br><span class="line">		n, err := conn.Read(buf[:<span class="number">4</span>])</span><br><span class="line">		<span class="keyword">if</span> n != <span class="number">4</span> || err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"conn.Read err="</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		fmt.Println(<span class="string">"读取到的buf="</span>, buf[:<span class="number">4</span>])</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"服务器在 8889 端口监听中..."</span>)</span><br><span class="line">	listen, err := net.Listen(<span class="string">"tcp"</span>, <span class="string">"0.0.0.0:8889"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"net.Listen err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> listen.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//一旦监听成功, 就等待客户端来链接服务器</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"等待客户端来链接服务器..."</span>)</span><br><span class="line">		conn, err := listen.Accept()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"net.Accept err="</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//一旦链接成功, 就启动一个协程和客户端保持通讯</span></span><br><span class="line">		<span class="keyword">go</span> proc(conn)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  common/message/message.go</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> message</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	LoginMesType    = <span class="string">"LoginMes"</span></span><br><span class="line">	LoginResMesType = <span class="string">"LoginResMes"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Message <span class="keyword">struct</span> &#123;</span><br><span class="line">	Type <span class="keyword">string</span> <span class="string">`json:"type"`</span> <span class="comment">//消息类型</span></span><br><span class="line">	Data <span class="keyword">string</span> <span class="string">`json:"data"`</span> <span class="comment">//消息的类型</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> LoginMes <span class="keyword">struct</span> &#123;</span><br><span class="line">	UserId   <span class="keyword">int</span>    <span class="string">`json:"userId"`</span></span><br><span class="line">	UserPwd  <span class="keyword">string</span> <span class="string">`json:"userPwd"`</span></span><br><span class="line">	UserName <span class="keyword">string</span> <span class="string">`json:"userName"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> LoginResMes <span class="keyword">struct</span> &#123;</span><br><span class="line">	Code  <span class="keyword">int</span>    <span class="string">`json:"code"`</span>  <span class="comment">// 返回状态码 500 表示该用户未注册, 200 表示登录成功</span></span><br><span class="line">	Error <span class="keyword">string</span> <span class="string">`json:"error"`</span> <span class="comment">//返回错误信息</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  client/main.go<br>  和前面的代码一样，没有修改</p>
<p>  client/login.go</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/binary"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"redis/src/golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">login</span><span class="params">(userId <span class="keyword">int</span>, userPwd <span class="keyword">string</span>)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line">	<span class="comment">// fmt.Printf("userId=%v, userPwd=%v\n", userId, userPwd)</span></span><br><span class="line">	<span class="comment">// return nil</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1. 链接到服务器</span></span><br><span class="line">	conn, err := net.Dial(<span class="string">"tcp"</span>, <span class="string">"localhost:8889"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"net.Dial err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//延时关闭</span></span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 2. 准备通过 conn 发送消息给服务</span></span><br><span class="line">	<span class="keyword">var</span> mes message.Message</span><br><span class="line">	mes.Type = message.LoginMesType</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 3. 创建一个 LoginMes 结构体</span></span><br><span class="line">	<span class="keyword">var</span> loginMes message.LoginMes</span><br><span class="line">	loginMes.UserId = userId</span><br><span class="line">	loginMes.UserPwd = userPwd</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 4. 将 loginMes 序列化</span></span><br><span class="line">	data, err := json.Marshal(loginMes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 5. 把data 赋值给 mes.Data 字段</span></span><br><span class="line">	mes.Data = <span class="keyword">string</span>(data)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 6. 将 mes 进行序列化操作</span></span><br><span class="line">	data, err = json.Marshal(mes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 7. 到这个时候, data 就是我们要发送的信息</span></span><br><span class="line">	<span class="comment">// 先把 data 的长度发送给服务器</span></span><br><span class="line">	<span class="comment">// 先获取到 data 的长度 =&gt; 转成一个表示长度的 byte 切片</span></span><br><span class="line">	pkgLen := <span class="keyword">uint32</span>(<span class="built_in">len</span>(data))</span><br><span class="line">	<span class="keyword">var</span> buf [<span class="number">4</span>]<span class="keyword">byte</span></span><br><span class="line">	binary.BigEndian.PutUint32(buf[:<span class="number">4</span>], pkgLen)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 发送长度</span></span><br><span class="line">	n, err := conn.Write(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> n != <span class="number">4</span> || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	fmt.Printf(<span class="string">"客户端, 发送消息的长度=%d 内容=%s"</span>, <span class="built_in">len</span>(data), <span class="keyword">string</span>(data))</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="步骤二"><a href="#步骤二" class="headerlink" title="步骤二"></a>步骤二</h5><p>接下来需要完成客户端可以发送消息本身，服务器端可以正常接收到消息,并根据客户端发送的消息(LoginMes), 判断用户的合法性，并返回相应的 LoginResMes<br><strong>思路分析:</strong></p>
<ol>
<li>让客户端发送消息本身</li>
<li>服务器端接受到消息， 然后反序列化成对应的消息结构体.</li>
<li>服务器端根据反序列化成对应的消息， 判断是否登录用户是合法, 返回 LoginResMes</li>
<li>客户端解析返回的 LoginResMes,显示对应界面</li>
<li>这里我们需要做函数的封装</li>
</ol>
<ul>
<li>代码实现:</li>
</ul>
<blockquote>
<p>  修改client/login.go</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/binary"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"redis/src/golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">login</span><span class="params">(userId <span class="keyword">int</span>, userPwd <span class="keyword">string</span>)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line">	<span class="comment">// fmt.Printf("userId=%v, userPwd=%v\n", userId, userPwd)</span></span><br><span class="line">	<span class="comment">// return nil</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1. 链接到服务器</span></span><br><span class="line">	conn, err := net.Dial(<span class="string">"tcp"</span>, <span class="string">"localhost:8889"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"net.Dial err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//延时关闭</span></span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 2. 准备通过 conn 发送消息给服务</span></span><br><span class="line">	<span class="keyword">var</span> mes message.Message</span><br><span class="line">	mes.Type = message.LoginMesType</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 3. 创建一个 LoginMes 结构体</span></span><br><span class="line">	<span class="keyword">var</span> loginMes message.LoginMes</span><br><span class="line">	loginMes.UserId = userId</span><br><span class="line">	loginMes.UserPwd = userPwd</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 4. 将 loginMes 序列化</span></span><br><span class="line">	data, err := json.Marshal(loginMes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 5. 把data 赋值给 mes.Data 字段</span></span><br><span class="line">	mes.Data = <span class="keyword">string</span>(data)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 6. 将 mes 进行序列化操作</span></span><br><span class="line">	data, err = json.Marshal(mes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 7. 到这个时候, data 就是我们要发送的信息</span></span><br><span class="line">	<span class="comment">// 先把 data 的长度发送给服务器</span></span><br><span class="line">	<span class="comment">// 先获取到 data 的长度 =&gt; 转成一个表示长度的 byte 切片</span></span><br><span class="line">	pkgLen := <span class="keyword">uint32</span>(<span class="built_in">len</span>(data))</span><br><span class="line">	<span class="keyword">var</span> buf [<span class="number">4</span>]<span class="keyword">byte</span></span><br><span class="line">	binary.BigEndian.PutUint32(buf[:<span class="number">4</span>], pkgLen)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 发送长度</span></span><br><span class="line">	n, err := conn.Write(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> n != <span class="number">4</span> || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//发送消息本身</span></span><br><span class="line">	_, err = conn.Write(data)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 休眠 20 秒</span></span><br><span class="line">	time.Sleep(<span class="number">20</span> * time.Second)</span><br><span class="line">	fmt.Println(<span class="string">"休眠了 20 秒"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// fmt.Printf("客户端, 发送消息的长度=%d 内容=%s", len(data), string(data))</span></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>代码解释:</strong></p>
<p>下图为 <code>login.go</code> 中修改/添加的部分</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5tf62w1ckj20jp070mxi.jpg" alt="image-20220903145227916"></p>
<blockquote>
<p>  修改 server/main.go</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/binary"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"io"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"redis/src/golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">readPkg</span><span class="params">(conn net.Conn)</span> <span class="params">(mes message.Message, err error)</span></span> &#123;</span><br><span class="line">	buf := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">4096</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"读取客户端发送的数据..."</span>)</span><br><span class="line">	_, err = conn.Read(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Read err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 根据 buf[:4] 转成一个 uint32 类型</span></span><br><span class="line">	<span class="comment">// var pkgLen uint32</span></span><br><span class="line">	pkgLen := binary.BigEndian.Uint32(buf[:<span class="number">4</span>])</span><br><span class="line">	fmt.Println(<span class="string">"读取到的buf="</span>, buf[:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 根据 pkgLen 读取消息内容</span></span><br><span class="line">	n, err := conn.Read(buf[:pkgLen])</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">uint32</span>(n) != pkgLen || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Read fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将 pkgLen 反序列化为 message.Message</span></span><br><span class="line">	<span class="comment">// 官方解释:</span></span><br><span class="line">	<span class="comment">// func Unmarshal(data []byte, v interface&#123;&#125;) error</span></span><br><span class="line">	<span class="comment">// Unmarshal函数解析json编码的数据并将结果存入v指向的值。</span></span><br><span class="line">	err = json.Unmarshal(buf[:pkgLen], &amp;mes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.unmarshal fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> mes, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理客户端的通讯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">proc</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">	<span class="comment">//延时关闭conn</span></span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//循环接收客户端发送的信息</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">// 这里我们将读取数据包封装成一个函数 readPkg, 返回 Message, err</span></span><br><span class="line">		msg, err := readPkg(conn)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">				fmt.Println(<span class="string">"客户端已经退出, 服务端自动退出..."</span>)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				fmt.Println(<span class="string">"readPkg err="</span>, err)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//输出客户端发送的信息</span></span><br><span class="line">		fmt.Println(<span class="string">"msg="</span>, msg)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"服务器在 8889 端口监听中..."</span>)</span><br><span class="line">	listen, err := net.Listen(<span class="string">"tcp"</span>, <span class="string">"0.0.0.0:8889"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"net.Listen err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> listen.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//一旦监听成功, 就等待客户端来链接服务器</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"等待客户端来链接服务器..."</span>)</span><br><span class="line">		conn, err := listen.Accept()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"net.Accept err="</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//一旦链接成功, 就启动一个协程和客户端保持通讯</span></span><br><span class="line">		<span class="keyword">go</span> proc(conn)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>代码解释:</strong></p>
<p>下图为 <code>server/ming.go</code> 中新增的函数</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5tf945155j20jg0mqwgn.jpg" alt="image-20220903145524274"></p>
<p>新增的 <code>readPkg</code> 函数封装了以前函数 <code>proc</code> 中for循环中的内容,目前的内容如下图</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5tfa8bkssj20ir0gi75f.jpg" alt="image-20220903145629681"></p>
<p>代码测试执行结果如下图</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5tfg2mc8bj20xp08idgx.jpg" alt="image-20220903150206050"></p>
<h5 id="步骤三"><a href="#步骤三" class="headerlink" title="步骤三"></a>步骤三</h5><ul>
<li>能够完成登录，并提示相应信息</li>
</ul>
<blockquote>
<p>  修改 common/message/message.go</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> message</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> (</span><br><span class="line">	LoginMesType    = <span class="string">"LoginMes"</span></span><br><span class="line">	LoginResMesType = <span class="string">"LoginResMes"</span></span><br><span class="line">	RegisterMesType = <span class="string">"RegisterMes"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Message <span class="keyword">struct</span> &#123;</span><br><span class="line">	Type <span class="keyword">string</span> <span class="string">`json:"type"`</span> <span class="comment">//消息类型</span></span><br><span class="line">	Data <span class="keyword">string</span> <span class="string">`json:"data"`</span> <span class="comment">//消息的类型</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> LoginMes <span class="keyword">struct</span> &#123;</span><br><span class="line">	UserId   <span class="keyword">int</span>    <span class="string">`json:"userId"`</span></span><br><span class="line">	UserPwd  <span class="keyword">string</span> <span class="string">`json:"userPwd"`</span></span><br><span class="line">	UserName <span class="keyword">string</span> <span class="string">`json:"userName"`</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> LoginResMes <span class="keyword">struct</span> &#123;</span><br><span class="line">	Code  <span class="keyword">int</span>    <span class="string">`json:"code"`</span>  <span class="comment">// 返回状态码 500 表示该用户未注册, 200 表示登录成功</span></span><br><span class="line">	Error <span class="keyword">string</span> <span class="string">`json:"error"`</span> <span class="comment">//返回错误信息</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//注册逻辑</span></span><br><span class="line"><span class="keyword">type</span> RegisterMes <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  修改server/main.go</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/binary"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"io"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"redis/src/golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">readPkg</span><span class="params">(conn net.Conn)</span> <span class="params">(mes message.Message, err error)</span></span> &#123;</span><br><span class="line">	buf := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">4096</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"读取客户端发送的数据..."</span>)</span><br><span class="line">	_, err = conn.Read(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Read err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 根据 buf[:4] 转成一个 uint32 类型</span></span><br><span class="line">	<span class="comment">// var pkgLen uint32</span></span><br><span class="line">	pkgLen := binary.BigEndian.Uint32(buf[:<span class="number">4</span>])</span><br><span class="line">	fmt.Println(<span class="string">"读取到的buf="</span>, buf[:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 根据 pkgLen 读取消息内容</span></span><br><span class="line">	n, err := conn.Read(buf[:pkgLen])</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">uint32</span>(n) != pkgLen || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Read fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将 pkgLen 反序列化为 message.Message</span></span><br><span class="line">	<span class="comment">// 官方解释:</span></span><br><span class="line">	<span class="comment">// func Unmarshal(data []byte, v interface&#123;&#125;) error</span></span><br><span class="line">	<span class="comment">// Unmarshal函数解析json编码的数据并将结果存入v指向的值。</span></span><br><span class="line">	err = json.Unmarshal(buf[:pkgLen], &amp;mes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.unmarshal fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> mes, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">writePkg</span><span class="params">(conn net.Conn, data []<span class="keyword">byte</span>)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//先发送一个长度给对方</span></span><br><span class="line">	pkgLen := <span class="keyword">uint32</span>(<span class="built_in">len</span>(data))</span><br><span class="line">	<span class="keyword">var</span> buf [<span class="number">4</span>]<span class="keyword">byte</span></span><br><span class="line">	binary.BigEndian.PutUint32(buf[:<span class="number">4</span>], pkgLen)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 发送长度</span></span><br><span class="line">	n, err := conn.Write(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> n != <span class="number">4</span> || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//发送消息本身</span></span><br><span class="line">	n, err = conn.Write(data)</span><br><span class="line">	<span class="keyword">if</span> n != <span class="keyword">int</span>(pkgLen) || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理客户端的通讯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">proc</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">	<span class="comment">//延时关闭conn</span></span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//循环接收客户端发送的信息</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">// 这里我们将读取数据包封装成一个函数 readPkg, 返回 Message, err</span></span><br><span class="line">		mes, err := readPkg(conn)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">				fmt.Println(<span class="string">"客户端已经退出, 服务端自动退出..."</span>)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				fmt.Println(<span class="string">"readPkg err="</span>, err)</span><br><span class="line">				<span class="keyword">return</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//输出客户端发送的信息</span></span><br><span class="line">		<span class="comment">// fmt.Println("msg=", msg)</span></span><br><span class="line">		err = ServerProcessMes(conn, &amp;mes)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//编写一个 ServerProcessLogin 函数, 专门处理登录请求</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ServerProcessLogin</span><span class="params">(conn net.Conn, mes *message.Message)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//核心代码</span></span><br><span class="line">	<span class="comment">//1. 先从mes中取出mes.Data, 并直接反序列化成LoginMes</span></span><br><span class="line">	<span class="keyword">var</span> loginMes message.LoginMes</span><br><span class="line">	err = json.Unmarshal([]<span class="keyword">byte</span>(mes.Data), &amp;loginMes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Unmarshal fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//2.声明一个 resMes</span></span><br><span class="line">	<span class="keyword">var</span> resMes message.Message</span><br><span class="line">	resMes.Type = message.LoginResMesType</span><br><span class="line">	<span class="comment">//3. 声明一个 LoginResMes, 并完成赋值</span></span><br><span class="line">	<span class="keyword">var</span> loginResMes message.LoginResMes</span><br><span class="line">	<span class="comment">//4. 如果用户 id=100, 密码=123456, 认为合法, 否则不合法</span></span><br><span class="line">	<span class="keyword">if</span> loginMes.UserId == <span class="number">100</span> &amp;&amp; loginMes.UserPwd == <span class="string">"123456"</span> &#123;</span><br><span class="line">		<span class="comment">//合法</span></span><br><span class="line">		loginResMes.Code = <span class="number">200</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">//不合法</span></span><br><span class="line">		loginResMes.Code = <span class="number">500</span>	<span class="comment">// 500状态码, 表示该用户不存在</span></span><br><span class="line">		loginResMes.Error = <span class="string">"该用户不存在, 请注册再使用"</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//5. 将 loginResMes 序列化</span></span><br><span class="line">	data, err := json.Marshal(loginResMes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//6. 将 data 赋值给 resMes</span></span><br><span class="line">	resMes.Data = <span class="keyword">string</span>(data)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//7. 对 resMes 进行序列化,准备发送</span></span><br><span class="line">	data, err = json.Marshal(resMes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//8. 发送data, 我们将其封装到writePkg函数</span></span><br><span class="line">	err = writePkg(conn, data)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//编写一个 ServerProcessMes 函数</span></span><br><span class="line"><span class="comment">//功能: 根据客户端发送消息种类不同, 来决定调用哪个函数来处理</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ServerProcessMes</span><span class="params">(conn net.Conn, mes *message.Message)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> mes.Type &#123;</span><br><span class="line">	<span class="keyword">case</span> message.LoginMesType:</span><br><span class="line">		<span class="comment">//处理登录</span></span><br><span class="line">		err = ServerProcessLogin(conn, mes)</span><br><span class="line">	<span class="keyword">case</span> message.RegisterMesType:</span><br><span class="line">		<span class="comment">//处理注册</span></span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">"消息类型不存在, 无法处理..."</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"服务器在 8889 端口监听中..."</span>)</span><br><span class="line">	listen, err := net.Listen(<span class="string">"tcp"</span>, <span class="string">"0.0.0.0:8889"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"net.Listen err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> listen.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//一旦监听成功, 就等待客户端来链接服务器</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"等待客户端来链接服务器..."</span>)</span><br><span class="line">		conn, err := listen.Accept()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"net.Accept err="</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="comment">//一旦链接成功, 就启动一个协程和客户端保持通讯</span></span><br><span class="line">		<span class="keyword">go</span> proc(conn)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下图为<code>server/main.go</code>代码中在之前基础上增加的内容</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vl7kqci7j20ly0atjsc.jpg" alt="image-20220905115238000"></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vl8p3jcoj20og0sygox.jpg" alt="image-20220905115344619"></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vl9jxt48j20hp0fft9y.jpg" alt="image-20220905115433930"></p>
<blockquote>
<p>  在client下新建 <code>utils.go</code> 文件</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/binary"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"redis/src/golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">readPkg</span><span class="params">(conn net.Conn)</span> <span class="params">(mes message.Message, err error)</span></span> &#123;</span><br><span class="line">	buf := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">4096</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"读取客户端发送的数据..."</span>)</span><br><span class="line">	_, err = conn.Read(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Read err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 根据 buf[:4] 转成一个 uint32 类型</span></span><br><span class="line">	<span class="comment">// var pkgLen uint32</span></span><br><span class="line">	pkgLen := binary.BigEndian.Uint32(buf[:<span class="number">4</span>])</span><br><span class="line">	fmt.Println(<span class="string">"读取到的buf="</span>, buf[:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 根据 pkgLen 读取消息内容</span></span><br><span class="line">	n, err := conn.Read(buf[:pkgLen])</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">uint32</span>(n) != pkgLen || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Read fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将 pkgLen 反序列化为 message.Message</span></span><br><span class="line">	<span class="comment">// 官方解释:</span></span><br><span class="line">	<span class="comment">// func Unmarshal(data []byte, v interface&#123;&#125;) error</span></span><br><span class="line">	<span class="comment">// Unmarshal函数解析json编码的数据并将结果存入v指向的值。</span></span><br><span class="line">	err = json.Unmarshal(buf[:pkgLen], &amp;mes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.unmarshal fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> mes, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">writePkg</span><span class="params">(conn net.Conn, data []<span class="keyword">byte</span>)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//先发送一个长度给对方</span></span><br><span class="line">	pkgLen := <span class="keyword">uint32</span>(<span class="built_in">len</span>(data))</span><br><span class="line">	<span class="keyword">var</span> buf [<span class="number">4</span>]<span class="keyword">byte</span></span><br><span class="line">	binary.BigEndian.PutUint32(buf[:<span class="number">4</span>], pkgLen)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 发送长度</span></span><br><span class="line">	n, err := conn.Write(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> n != <span class="number">4</span> || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//发送消息本身</span></span><br><span class="line">	n, err = conn.Write(data)</span><br><span class="line">	<span class="keyword">if</span> n != <span class="keyword">int</span>(pkgLen) || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>  修改 <code>client/login.go</code> 文件</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/binary"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"redis/src/golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">login</span><span class="params">(userId <span class="keyword">int</span>, userPwd <span class="keyword">string</span>)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line">	<span class="comment">// fmt.Printf("userId=%v, userPwd=%v\n", userId, userPwd)</span></span><br><span class="line">	<span class="comment">// return nil</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1. 链接到服务器</span></span><br><span class="line">	conn, err := net.Dial(<span class="string">"tcp"</span>, <span class="string">"localhost:8889"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"net.Dial err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//延时关闭</span></span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 2. 准备通过 conn 发送消息给服务</span></span><br><span class="line">	<span class="keyword">var</span> mes message.Message</span><br><span class="line">	mes.Type = message.LoginMesType</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 3. 创建一个 LoginMes 结构体</span></span><br><span class="line">	<span class="keyword">var</span> loginMes message.LoginMes</span><br><span class="line">	loginMes.UserId = userId</span><br><span class="line">	loginMes.UserPwd = userPwd</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 4. 将 loginMes 序列化</span></span><br><span class="line">	data, err := json.Marshal(loginMes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 5. 把data 赋值给 mes.Data 字段</span></span><br><span class="line">	mes.Data = <span class="keyword">string</span>(data)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 6. 将 mes 进行序列化操作</span></span><br><span class="line">	data, err = json.Marshal(mes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 7. 到这个时候, data 就是我们要发送的信息</span></span><br><span class="line">	<span class="comment">// 先把 data 的长度发送给服务器</span></span><br><span class="line">	<span class="comment">// 先获取到 data 的长度 =&gt; 转成一个表示长度的 byte 切片</span></span><br><span class="line">	pkgLen := <span class="keyword">uint32</span>(<span class="built_in">len</span>(data))</span><br><span class="line">	<span class="keyword">var</span> buf [<span class="number">4</span>]<span class="keyword">byte</span></span><br><span class="line">	binary.BigEndian.PutUint32(buf[:<span class="number">4</span>], pkgLen)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 发送长度</span></span><br><span class="line">	n, err := conn.Write(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> n != <span class="number">4</span> || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//发送消息本身</span></span><br><span class="line">	_, err = conn.Write(data)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 休眠 20 秒</span></span><br><span class="line">	<span class="comment">// time.Sleep(20 * time.Second)</span></span><br><span class="line">	<span class="comment">// fmt.Println("休眠了 20 秒")</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// fmt.Printf("客户端, 发送消息的长度=%d 内容=%s", len(data), string(data))</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// 处理服务器端返回的信息</span></span><br><span class="line">	mes, err = readPkg(conn)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"readPkg(conn) err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 将 mes 的Data部分反序列化成 LoginResMes</span></span><br><span class="line">	<span class="keyword">var</span> loginResMes message.LoginResMes</span><br><span class="line">	err = json.Unmarshal([]<span class="keyword">byte</span>(mes.Data), &amp;loginResMes)</span><br><span class="line">	<span class="keyword">if</span> loginResMes.Code == <span class="number">200</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"登录成功"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> loginResMes.Code == <span class="number">500</span> &#123;</span><br><span class="line">		fmt.Println(loginResMes.Error)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>下图为 <code>client/login.go</code> 中在原来的基础上所增加的内容</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vldbccrej20gh0aot9l.jpg" alt="image-20220905115811096"></p>
<p><strong>执行测试结果:</strong></p>
<blockquote>
<p>   client端</p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vlf15ihqj20bc0ciq3n.jpg" alt="image-20220905115949656"></p>
<blockquote>
<p>  server端</p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5vlfbeil7j20b406kq3e.jpg" alt="image-20220905120005234"></p>
<h5 id="步骤四"><a href="#步骤四" class="headerlink" title="步骤四"></a>步骤四</h5><ul>
<li>程序代码改进</li>
</ul>
<blockquote>
<p>  前面的程序虽然完成了功能，但是没有结构，系统的可读性、扩展性和维护性都不好，因此需要对程序的结构进行改进。</p>
<p>  先改进服务端, 先画出程序的框架图[思路]，再写代码</p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5wnuqpqahj20z70ec40x.jpg" alt="image-20220906100938734"></p>
<ul>
<li>步骤</li>
</ul>
<ol>
<li>先把分析出来的文件，创建好，然后放到相应的文件夹[包]</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5wqd1dniwj206i062jrg.jpg" alt="image-20220906113628634"></p>
<ol start="2">
<li><p>现在根据各个文件，完成的任务不同，将 main.go 的代码剥离到对应的文件中即可</p>
</li>
<li><p>修改<code>server/utils/utils.go</code></p>
</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> utils</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/binary"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将这些方法关联到结构体中</span></span><br><span class="line"><span class="keyword">type</span> Transfer <span class="keyword">struct</span> &#123;</span><br><span class="line">	Conn net.Conn</span><br><span class="line">	Buf  [<span class="number">4096</span>]<span class="keyword">byte</span> <span class="comment">//这时传输时,使用缓存</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Transfer)</span> <span class="title">ReadPkg</span><span class="params">()</span> <span class="params">(mes message.Message, err error)</span></span> &#123;</span><br><span class="line">	buf := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="number">4096</span>)</span><br><span class="line"></span><br><span class="line">	fmt.Println(<span class="string">"读取客户端发送的数据..."</span>)</span><br><span class="line">	_, err = t.Conn.Read(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Read err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 根据 buf[:4] 转成一个 uint32 类型</span></span><br><span class="line">	<span class="comment">// var pkgLen uint32</span></span><br><span class="line">	pkgLen := binary.BigEndian.Uint32(buf[:<span class="number">4</span>])</span><br><span class="line">	fmt.Println(<span class="string">"读取到的buf="</span>, buf[:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 根据 pkgLen 读取消息内容</span></span><br><span class="line">	n, err :=t.Conn.Read(buf[:pkgLen])</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">uint32</span>(n) != pkgLen || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Read fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将 pkgLen 反序列化为 message.Message</span></span><br><span class="line">	<span class="comment">// 官方解释:</span></span><br><span class="line">	<span class="comment">// func Unmarshal(data []byte, v interface&#123;&#125;) error</span></span><br><span class="line">	<span class="comment">// Unmarshal函数解析json编码的数据并将结果存入v指向的值。</span></span><br><span class="line">	err = json.Unmarshal(buf[:pkgLen], &amp;mes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.unmarshal fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(t *Transfer)</span> <span class="title">WritePkg</span><span class="params">(data []<span class="keyword">byte</span>)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//先发送一个长度给对方</span></span><br><span class="line">	pkgLen := <span class="keyword">uint32</span>(<span class="built_in">len</span>(data))</span><br><span class="line">	<span class="keyword">var</span> buf [<span class="number">4</span>]<span class="keyword">byte</span></span><br><span class="line">	binary.BigEndian.PutUint32(buf[:<span class="number">4</span>], pkgLen)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 发送长度</span></span><br><span class="line">	n, err := t.Conn.Write(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> n != <span class="number">4</span> || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//发送消息本身</span></span><br><span class="line">	n, err = t.Conn.Write(data)</span><br><span class="line">	<span class="keyword">if</span> n != <span class="keyword">int</span>(pkgLen) || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>修改<code>server/process/userProcess.go</code></li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> process</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">	<span class="string">"golang_study/18-tcp/tcpdemo/server/utils"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> UserProcess <span class="keyword">struct</span> &#123;</span><br><span class="line">	Conn net.Conn</span><br><span class="line">	Buf  [<span class="number">4096</span>]<span class="keyword">byte</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//编写一个 ServerProcessLogin 函数, 专门处理登录请求</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *UserProcess)</span> <span class="title">ServerProcessLogin</span><span class="params">(mes *message.Message)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//核心代码</span></span><br><span class="line">	<span class="comment">//1. 先从mes中取出mes.Data, 并直接反序列化成LoginMes</span></span><br><span class="line">	<span class="keyword">var</span> loginMes message.LoginMes</span><br><span class="line">	err = json.Unmarshal([]<span class="keyword">byte</span>(mes.Data), &amp;loginMes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Unmarshal fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//2.声明一个 resMes</span></span><br><span class="line">	<span class="keyword">var</span> resMes message.Message</span><br><span class="line">	resMes.Type = message.LoginResMesType</span><br><span class="line">	<span class="comment">//3. 声明一个 LoginResMes, 并完成赋值</span></span><br><span class="line">	<span class="keyword">var</span> loginResMes message.LoginResMes</span><br><span class="line">	<span class="comment">//4. 如果用户 id=100, 密码=123456, 认为合法, 否则不合法</span></span><br><span class="line">	<span class="keyword">if</span> loginMes.UserId == <span class="number">100</span> &amp;&amp; loginMes.UserPwd == <span class="string">"123456"</span> &#123;</span><br><span class="line">		<span class="comment">//合法</span></span><br><span class="line">		loginResMes.Code = <span class="number">200</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="comment">//不合法</span></span><br><span class="line">		loginResMes.Code = <span class="number">500</span> <span class="comment">// 500状态码, 表示该用户不存在</span></span><br><span class="line">		loginResMes.Error = <span class="string">"该用户不存在, 请注册再使用"</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//5. 将 loginResMes 序列化</span></span><br><span class="line">	data, err := json.Marshal(loginResMes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//6. 将 data 赋值给 resMes</span></span><br><span class="line">	resMes.Data = <span class="keyword">string</span>(data)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//7. 对 resMes 进行序列化,准备发送</span></span><br><span class="line">	data, err = json.Marshal(resMes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal fail err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//8. 发送data, 我们将其封装到writePkg函数</span></span><br><span class="line">	<span class="comment">//因为使用分层模式(mvc), 我们先创建一个 Transfer 实例, 然后读取</span></span><br><span class="line">	tf := &amp;utils.Transfer&#123;</span><br><span class="line">		Conn: u.Conn,</span><br><span class="line">	&#125;</span><br><span class="line">	err = tf.WritePkg(data)</span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>修改<code>server/main/processor.go</code></li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">	<span class="string">"golang_study/18-tcp/tcpdemo/server/process"</span></span><br><span class="line">	<span class="string">"golang_study/18-tcp/tcpdemo/server/utils"</span></span><br><span class="line">	<span class="string">"io"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Processor <span class="keyword">struct</span> &#123;</span><br><span class="line">	Conn net.Conn</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//编写一个 ServerProcessMes 函数</span></span><br><span class="line"><span class="comment">//功能: 根据客户端发送消息种类不同, 来决定调用哪个函数来处理</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Processor)</span> <span class="title">ServerProcessMes</span><span class="params">(mes *message.Message)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> mes.Type &#123;</span><br><span class="line">	<span class="keyword">case</span> message.LoginMesType:</span><br><span class="line">		<span class="comment">//处理登录</span></span><br><span class="line">		<span class="comment">//创建一个 UserProcess 实例</span></span><br><span class="line">		up := &amp;process.UserProcess&#123;</span><br><span class="line">			Conn: p.Conn,</span><br><span class="line">		&#125;</span><br><span class="line">		err = up.ServerProcessLogin(mes)</span><br><span class="line">	<span class="keyword">case</span> message.RegisterMesType:</span><br><span class="line">		<span class="comment">//处理注册</span></span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">"消息类型不存在, 无法处理..."</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *Processor)</span> <span class="title">Process_main</span><span class="params">()</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line">	<span class="comment">//循环的客户端发送的信息</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		<span class="comment">//这里我们将读取数据包, 直接封装成一个函数 readPkg(), 返回 Message, Err</span></span><br><span class="line">		<span class="comment">//创建一个 Transfer 实例完成读包任务</span></span><br><span class="line">		tf := &amp;utils.Transfer&#123;</span><br><span class="line">			Conn: p.Conn,</span><br><span class="line">		&#125;</span><br><span class="line">		mes, err := tf.ReadPkg()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">if</span> err == io.EOF &#123;</span><br><span class="line">				fmt.Println(<span class="string">"客户端退出, 服务器端也退出..."</span>)</span><br><span class="line">				<span class="keyword">return</span> err</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				fmt.Println(<span class="string">"readPkg err="</span>, err)</span><br><span class="line">				<span class="keyword">return</span> err</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		err = p.ServerProcessMes(&amp;mes)</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="keyword">return</span> err</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>修改<code>server/main/main.go</code></li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理客户端的通讯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">proc</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">	<span class="comment">//延时关闭conn</span></span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//这里调用总控,创建一个</span></span><br><span class="line">	processor := &amp;Processor&#123;</span><br><span class="line">		Conn: conn,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	err := processor.Process_main()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"客户端和服务器通讯协程错误=err"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"服务器在 8889 端口监听中..."</span>)</span><br><span class="line">	listen, err := net.Listen(<span class="string">"tcp"</span>, <span class="string">"0.0.0.0:8889"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"net.Listen err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">defer</span> listen.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">//一旦监听成功, 就等待客户端来链接服务器</span></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"等待客户端来链接服务器..."</span>)</span><br><span class="line">		conn, err := listen.Accept()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"net.Accept err="</span>, err)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//一旦链接成功, 就启动一个协程和客户端保持通讯</span></span><br><span class="line">		<span class="keyword">go</span> proc(conn)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="步骤五"><a href="#步骤五" class="headerlink" title="步骤五"></a>步骤五</h5><blockquote>
<p>  修改客户端代码</p>
</blockquote>
<ol>
<li>示意图如下:</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5xzttl6zaj20pr0htq4v.jpg" alt="image-20220907134930899"></p>
<ol start="2">
<li>先把各个文件放到对应的文件夹[包]</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5y04nr5qaj205p05f3yj.jpg" alt="image-20220907135958775"></p>
<ol start="3">
<li><p>将 server/utils.go 拷贝到 client/utils/utils.go</p>
</li>
<li><p>创建了server/process/userProcess.go</p>
</li>
</ol>
<blockquote>
<p>  说明: 该文件就是在原来的 login.go 做了一个改进，即封装到 UserProcess 结构体</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> process</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"encoding/binary"</span></span><br><span class="line">	<span class="string">"encoding/json"</span></span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/18-tcp/tcpdemo/client/utils"</span></span><br><span class="line">	<span class="string">"golang_study/18-tcp/tcpdemo/common/message"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> UserProcess <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//暂时不需要字段</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//给关联一个用户登录的方法</span></span><br><span class="line"><span class="comment">//写一个函数, 完成登录</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *UserProcess)</span> <span class="title">Login</span><span class="params">(userId <span class="keyword">int</span>, userPwd <span class="keyword">string</span>)</span> <span class="params">(err error)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 1. 链接到服务器</span></span><br><span class="line">	conn, err := net.Dial(<span class="string">"tcp"</span>, <span class="string">"localhost:8889"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"net.Dial err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//延时关闭</span></span><br><span class="line">	<span class="keyword">defer</span> conn.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 2. 准备通过 conn 发送消息给服务</span></span><br><span class="line">	<span class="keyword">var</span> mes message.Message</span><br><span class="line">	mes.Type = message.LoginMesType</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 3. 创建一个 LoginMes 结构体</span></span><br><span class="line">	<span class="keyword">var</span> loginMes message.LoginMes</span><br><span class="line">	loginMes.UserId = userId</span><br><span class="line">	loginMes.UserPwd = userPwd</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 4. 将 loginMes 序列化</span></span><br><span class="line">	data, err := json.Marshal(loginMes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 5. 把data 赋值给 mes.Data 字段</span></span><br><span class="line">	mes.Data = <span class="keyword">string</span>(data)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 6. 将 mes 进行序列化操作</span></span><br><span class="line">	data, err = json.Marshal(mes)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"json.Marshal err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 7. 到这个时候, data 就是我们要发送的信息</span></span><br><span class="line">	<span class="comment">// 先把 data 的长度发送给服务器</span></span><br><span class="line">	<span class="comment">// 先获取到 data 的长度 =&gt; 转成一个表示长度的 byte 切片</span></span><br><span class="line">	pkgLen := <span class="keyword">uint32</span>(<span class="built_in">len</span>(data))</span><br><span class="line">	<span class="keyword">var</span> buf [<span class="number">4</span>]<span class="keyword">byte</span></span><br><span class="line">	binary.BigEndian.PutUint32(buf[:<span class="number">4</span>], pkgLen)</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 发送长度</span></span><br><span class="line">	n, err := conn.Write(buf[:<span class="number">4</span>])</span><br><span class="line">	<span class="keyword">if</span> n != <span class="number">4</span> || err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//发送消息本身</span></span><br><span class="line">	_, err = conn.Write(data)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"conn.Write(bytes) fail"</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 休眠 20 秒</span></span><br><span class="line">	<span class="comment">// time.Sleep(20 * time.Second)</span></span><br><span class="line">	<span class="comment">// fmt.Println("休眠了 20 秒")</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// fmt.Printf("客户端, 发送消息的长度=%d 内容=%s", len(data), string(data))</span></span><br><span class="line"></span><br><span class="line">	ft := utils.Transfer&#123;</span><br><span class="line">		Conn: conn,</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 处理服务器端返回的信息</span></span><br><span class="line">	mes, err = ft.ReadPkg()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"readPkg(conn) err="</span>, err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将 mes 的Data部分反序列化成 LoginResMes</span></span><br><span class="line">	<span class="keyword">var</span> loginResMes message.LoginResMes</span><br><span class="line">	err = json.Unmarshal([]<span class="keyword">byte</span>(mes.Data), &amp;loginResMes)</span><br><span class="line">	<span class="keyword">if</span> loginResMes.Code == <span class="number">200</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"登录成功"</span>)</span><br><span class="line">		<span class="comment">//循环显示登陆成功后的菜单</span></span><br><span class="line">		<span class="keyword">for</span> &#123;</span><br><span class="line">			ShowMenu()</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> loginResMes.Code == <span class="number">500</span> &#123;</span><br><span class="line">		fmt.Println(loginResMes.Error)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面代码中变化的内容如下图</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5z7q7ue96j20kf0bi3zh.jpg" alt="image-20220908150825455"></p>
<ol start="5">
<li>创建了server/process/server.go</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> process</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/18-tcp/tcpdemo/server/utils"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//显示登录成功后的界面</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ShowMenu</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"----------恭喜xxx登录成功----------"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"----------1. 显示在线用户列表----------"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"----------2. 发送消息----------"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"----------3. 信息列表----------"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"----------4. 退出系统----------"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"请选择(1-4):"</span>)</span><br><span class="line">	<span class="keyword">var</span> key <span class="keyword">int</span></span><br><span class="line">	fmt.Scanf(<span class="string">"%d\n"</span>, &amp;key)</span><br><span class="line">	<span class="keyword">switch</span> key &#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">		fmt.Println(<span class="string">"显示在线用户列表"</span>)</span><br><span class="line">	<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">		fmt.Println(<span class="string">"发送消息"</span>)</span><br><span class="line">	<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">		fmt.Println(<span class="string">"信息列表"</span>)</span><br><span class="line">	<span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">		fmt.Println(<span class="string">"退出系统"</span>)</span><br><span class="line">		os.Exit(<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		fmt.Println(<span class="string">"你输入的选项不正确!"</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//和服务器保持通讯</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ServerProcessMes</span><span class="params">(conn net.Conn)</span></span> &#123;</span><br><span class="line">	<span class="comment">//创建一个 transfer 实例, 不停的读取服务器发送的消息</span></span><br><span class="line">	tf := &amp;utils.Transfer&#123;</span><br><span class="line">		Conn: conn,</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"客户端正在等待读取服务器发送的消息"</span>)</span><br><span class="line">		mes, err := tf.ReadPkg()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			fmt.Println(<span class="string">"tf.ReadPkg err="</span>, err)</span><br><span class="line">			<span class="keyword">return</span></span><br><span class="line">		&#125;</span><br><span class="line">		<span class="comment">//如果读取到消息, 又事下一步处理逻辑</span></span><br><span class="line">		fmt.Printf(<span class="string">"mes=%v\n"</span>, mes)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面代码中增加的内容如下图</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5z7w40abhj20fy0bat9k.jpg" alt="image-20220908151407158"></p>
<ol start="6">
<li>修改 client/main/main.go</li>
</ol>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"golang_study/18-tcp/tcpdemo/client/process"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">//用户ID</span></span><br><span class="line"><span class="keyword">var</span> userId <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//用户密码</span></span><br><span class="line"><span class="keyword">var</span> userPwd <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">//接收用户的选择</span></span><br><span class="line">	<span class="keyword">var</span> key <span class="keyword">string</span></span><br><span class="line">	<span class="comment">//判断是否继续显示菜单</span></span><br><span class="line">	<span class="keyword">var</span> loop = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"--------------------欢迎登录多人聊天系统--------------------"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"\t\t\t1 登录聊天室"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"\t\t\t2 注册用户"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"\t\t\tq 退出系统"</span>)</span><br><span class="line">		fmt.Println(<span class="string">"请选择进行的操作[1|2|q]:"</span>)</span><br><span class="line">		fmt.Scanf(<span class="string">"%v\n"</span>, &amp;key)</span><br><span class="line">		<span class="keyword">switch</span> key &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"1"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"登录聊天室"</span>)</span><br><span class="line">			fmt.Println(<span class="string">"请输入用户的Id:"</span>)</span><br><span class="line">			fmt.Scanf(<span class="string">"%v\n"</span>, &amp;userId)</span><br><span class="line">			fmt.Println(<span class="string">"请输入用户的密码:"</span>)</span><br><span class="line">			fmt.Scanf(<span class="string">"%v\n"</span>, &amp;userPwd)</span><br><span class="line">			<span class="comment">//完成登录</span></span><br><span class="line">			<span class="comment">//1. 创建一个 UserProcess 的实例</span></span><br><span class="line">			up := &amp;process.UserProcess&#123;&#125;</span><br><span class="line">			up.Login(userId, userPwd)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"2"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"注册用户"</span>)</span><br><span class="line">		<span class="keyword">case</span> <span class="string">"q"</span>:</span><br><span class="line">			fmt.Println(<span class="string">"退出系统"</span>)</span><br><span class="line">			loop = <span class="literal">false</span></span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			fmt.Println(<span class="string">"输入有误, 请重新输入!"</span>)</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> !loop &#123;</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面代码中变化的内容如下图</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5z7rtyrbpj20ml0mbace.jpg" alt="image-20220908151000190"></p>
<h4 id="Redis操作"><a href="#Redis操作" class="headerlink" title="Redis操作"></a>Redis操作</h4><h5 id="Redis手动添加用户"><a href="#Redis手动添加用户" class="headerlink" title="Redis手动添加用户"></a>Redis手动添加用户</h5><p>示意图如下</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h605ulllxkj213w0fi418.jpg" alt="image-20220909104859524"></p>
<p>json数据格式如下</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="attr">"type"</span>:<span class="string">"LoginMes"</span>,<span class="attr">"data"</span>:<span class="string">"&#123;\"userId\":100,\"userPwd\":\"123456\",\"userName\":\"poker\"&#125;"</span>&#125;</span><br></pre></td></tr></table></figure>

<p>具体redis操作如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hset users 100 <span class="string">"&#123;\"userId\":100,\"userPwd\":\"123456\",\"userName\":\"poker\"&#125;"</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; hget users 100</span><br><span class="line"><span class="string">"&#123;\"userId\":100,\"userPwd\":\"123456\",\"userName\":\"poker\"&#125;"</span></span><br></pre></td></tr></table></figure>

<h5 id="代码实现Redis添加用户"><a href="#代码实现Redis添加用户" class="headerlink" title="代码实现Redis添加用户"></a>代码实现Redis添加用户</h5><ul>
<li>如输入的用户名密码在 Redis 中存在则登录，否则退出系统，并给出相应的提示信息:</li>
</ul>
<ol>
<li>用户不存在,你也可以重新注册，再登录 </li>
<li>输入的密码不正确</li>
</ol>
<ul>
<li>首先创建对应的文件</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h606rb47oaj206c04tglk.jpg" alt="image-20220909112028149"></p>
<h1 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h1><blockquote>
<p>  Redis 是一个NoSql数据库,不是传统的关系型数据库</p>
<p>  Redis 全程为 REmote Dictionary Server</p>
<p>  Redis性能非常高,单机能够达到 15w qps, 通常用来做缓存,也可以持久化.</p>
<p>  Redis是完全开源免费的, 高性能的分布式内存数据库,基于内存运行并支持持久化的NoSql数据库</p>
</blockquote>
<p>官网: </p>
<ul>
<li><a href="https://redis.io" target="_blank" rel="noopener">https://redis.io</a></li>
<li><a href="https://www.redis.cn" target="_blank" rel="noopener">https://www.redis.cn</a></li>
</ul>
<h2 id="操作原理图"><a href="#操作原理图" class="headerlink" title="操作原理图"></a>操作原理图</h2><p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5ps7nq4brj20tj09q756.jpg" alt="image-20220831112133267"></p>
<h2 id="Redis的安装"><a href="#Redis的安装" class="headerlink" title="Redis的安装"></a>Redis的安装</h2><blockquote>
<p>  我的笔记本为 MAC OS, 这里只演示 Mac 上安装 Redis 的过程</p>
</blockquote>
<p>参考链接: <a href="https://blog.csdn.net/qq_45220508/article/details/122980040" target="_blank" rel="noopener">MAC安装redis的简单方法</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install redis@6.2</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5psknvovvj20ng0f376x.jpg" alt="image-20220831113403174"></p>
<p>启动redis</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew services start redis</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5pslvv6fcj20dz0163yg.jpg" alt="image-20220831113513479"></p>
<p>检查端口号<code>6379</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netstat -AaLlnW | grep 6379</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5psmhh15gj20cj01ojrd.jpg" alt="image-20220831113547556"></p>
<p>客户端访问</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-cli</span><br><span class="line">127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Redis的基本使用"><a href="#Redis的基本使用" class="headerlink" title="Redis的基本使用"></a>Redis的基本使用</h2><p>使用手册参考:<a href="http://redisdoc.com/" target="_blank" rel="noopener">Redis命令参考</a></p>
<blockquote>
<p>   说明: Redis 安装好后，默认有 16 个数据库，初始默认使用 0 号库, 编号(index)是 0…15</p>
</blockquote>
<ul>
<li>添加 key-val <strong>[set]</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set key1 hello</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<ul>
<li>查看当前 redis 的 所有 key <strong>[keys *]</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) &quot;key2&quot;</span><br><span class="line">2) &quot;key1&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>获取key对应的值 <strong>[getkey]</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; get key1</span><br><span class="line">&quot;hello&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>切换 redis 数据库 <strong>[select index]</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; select 1</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379[1]&gt; get key1</span><br><span class="line">(nil)</span><br><span class="line">127.0.0.1:6379[1]&gt; select 0</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get key1</span><br><span class="line">&quot;hello&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>如何查看当前数据库的key-val数量 <strong>[dbsize]</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set key2 imau</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; dbsize</span><br><span class="line">(integer) 2</span><br></pre></td></tr></table></figure>

<ul>
<li>清空当前数据库的key-val和清空所有数据库的 key-val <strong>[flushdb flushall]</strong><ul>
<li>flushdb =&gt; 清空当前index的数据库</li>
<li>flushall =&gt; 清空左右index的数据库</li>
</ul>
</li>
</ul>
<h2 id="Redis-的-Crud-操作"><a href="#Redis-的-Crud-操作" class="headerlink" title="Redis 的 Crud 操作"></a>Redis 的 Crud 操作</h2><h3 id="Redis-的五大数据类型"><a href="#Redis-的五大数据类型" class="headerlink" title="Redis 的五大数据类型"></a>Redis 的五大数据类型</h3><p>Redis 的五大数据类型是: <code>String</code>(字符串) 、<code>Hash</code> (哈希)、<code>List</code>(列表)、<code>Set</code>(集合) 和 <code>zset</code>(sorted set:有序集合)</p>
<h4 id="String-字符串"><a href="#String-字符串" class="headerlink" title="String(字符串)"></a>String(字符串)</h4><blockquote>
<p>  string 是 redis 最基本的类型，一个 key 对应一个 value。</p>
<p>  string 类型是<code>二进制</code>安全的。除普通的字符串外，也可以存放图片等数据。</p>
<p>  redis 中字符串 value 最大是 <code>512M</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># 定义一个key和value</span><br><span class="line">127.0.0.1:6379&gt; set address beijing</span><br><span class="line">OK</span><br><span class="line"># 查询指定的key</span><br><span class="line">127.0.0.1:6379&gt; get address</span><br><span class="line">&quot;beijing&quot;</span><br><span class="line"># 删除指定的key</span><br><span class="line">127.0.0.1:6379&gt; del address</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; get address</span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>setex</strong>(set with expire)键秒值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># setex [key] [n秒] [value]</span><br><span class="line"># 超过 n 秒之后,删除这个key</span><br><span class="line">127.0.0.1:6379&gt; setex mess01 10 helloworld</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get mess01</span><br><span class="line">&quot;helloworld&quot;</span><br><span class="line">127.0.0.1:6379&gt; get mess01</span><br><span class="line">&quot;helloworld&quot;</span><br><span class="line">127.0.0.1:6379&gt; get mess01</span><br><span class="line">(nil)</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>mset</strong>[同时设置一个或多个 key-value 对]</p>
</li>
<li><p><strong>mget</strong>[同时获取多个 key-value]</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; mset m1 hello m2 world</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get m1</span><br><span class="line">&quot;hello&quot;</span><br><span class="line">127.0.0.1:6379&gt; get m2</span><br><span class="line">&quot;world&quot;</span><br><span class="line">127.0.0.1:6379&gt; mget m1 m2</span><br><span class="line">1) &quot;hello&quot;</span><br><span class="line">2) &quot;world&quot;</span><br></pre></td></tr></table></figure>

<h4 id="Hash-哈希"><a href="#Hash-哈希" class="headerlink" title="Hash (哈希)"></a>Hash (哈希)</h4><blockquote>
<p>  类似 golang 里的 Map</p>
<p>  Redis hash 是一个键值对集合。var user1 map[string]string</p>
<p>  Redis hash 是一个 string 类型的 field 和 value 的映射表，hash 特别适合用于存储对象。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hset user1 name poker</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hset user1 age 25</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; hset user1 job coder</span><br><span class="line">(integer) 1</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; hget user1 name</span><br><span class="line">&quot;poker&quot;</span><br><span class="line">127.0.0.1:6379&gt; hget user1 age</span><br><span class="line">&quot;25&quot;</span><br><span class="line">127.0.0.1:6379&gt; hget user1 job</span><br><span class="line">&quot;coder&quot;</span><br><span class="line"></span><br><span class="line"># 查看key中的field个数</span><br><span class="line">127.0.0.1:6379&gt; hlen user2</span><br><span class="line">(integer) 3</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; hgetall user1</span><br><span class="line">1) &quot;name&quot;</span><br><span class="line">2) &quot;poker&quot;</span><br><span class="line">3) &quot;age&quot;</span><br><span class="line">4) &quot;25&quot;</span><br><span class="line">5) &quot;job&quot;</span><br><span class="line">6) &quot;coder&quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>hmset(同时设定多个)</li>
<li>hmget(同时查看多个)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hmset user2 name jenny age 25 job &quot;good coder &quot;</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; hmget user2 name age job</span><br><span class="line">1) &quot;jenny&quot;</span><br><span class="line">2) &quot;25&quot;</span><br><span class="line">3) &quot;good coder &quot;</span><br></pre></td></tr></table></figure>

<ul>
<li>hexists(判定哈希表中key的field是否存在)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; hexists user2 name</span><br><span class="line">(integer) 1</span><br><span class="line"># 0就表示该 field 不存在</span><br><span class="line">127.0.0.1:6379&gt; hexists user2 name1</span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure>

<h4 id="List-列表"><a href="#List-列表" class="headerlink" title="List(列表)"></a>List(列表)</h4><blockquote>
<p>  列表是简单的字符串列表,按照插入顺序排序,你可以添加一个元素到列表的头部或者尾部</p>
<p>  List 本质是个链表, List 的元素是有序的，元素的值可以重复</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"># 从左到右依次传入数据</span><br><span class="line">127.0.0.1:6379&gt; lpush city tinjian beijing shanghai</span><br><span class="line">(integer) 3</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; lrange city 0 0</span><br><span class="line">1) &quot;shanghai&quot;</span><br><span class="line">127.0.0.1:6379&gt; lrange city 0 1</span><br><span class="line">1) &quot;shanghai&quot;</span><br><span class="line">2) &quot;beijing&quot;</span><br><span class="line"></span><br><span class="line"># 查看所有field元素</span><br><span class="line">127.0.0.1:6379&gt; lrange city 0 -1</span><br><span class="line">1) &quot;shanghai&quot;</span><br><span class="line">2) &quot;beijing&quot;</span><br><span class="line">3) &quot;tinjian&quot;</span><br><span class="line"># 从右到左依次传入数据</span><br><span class="line">127.0.0.1:6379&gt; rpush city shenzhen nanjing</span><br><span class="line">(integer) 5</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; lrange city 0 -1</span><br><span class="line">1) &quot;shanghai&quot;</span><br><span class="line">2) &quot;beijing&quot;</span><br><span class="line">3) &quot;tinjian&quot;</span><br><span class="line">4) &quot;shenzhen&quot;</span><br><span class="line">5) &quot;nanjing&quot;</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; lpop city</span><br><span class="line">&quot;shanghai&quot;</span><br><span class="line">127.0.0.1:6379&gt; lrange city 0 -1</span><br><span class="line">1) &quot;beijing&quot;</span><br><span class="line">2) &quot;tinjian&quot;</span><br><span class="line">3) &quot;shenzhen&quot;</span><br><span class="line">4) &quot;nanjing&quot;</span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; rpop city</span><br><span class="line">&quot;nanjing&quot;</span><br><span class="line">127.0.0.1:6379&gt; lrange city 0 -1</span><br><span class="line">1) &quot;beijing&quot;</span><br><span class="line">2) &quot;tinjian&quot;</span><br><span class="line">3) &quot;shenzhen&quot;</span><br><span class="line"></span><br><span class="line"># 查看key的元素个数</span><br><span class="line">127.0.0.1:6379&gt; llen city</span><br><span class="line">(integer) 3</span><br></pre></td></tr></table></figure>

<p>特别说明</p>
<ul>
<li>List 数据可以从左或右添加数据</li>
<li>如果 List 的数据全部移除,那么对应的键也会删除</li>
</ul>
<h4 id="Set-集合"><a href="#Set-集合" class="headerlink" title="Set(集合)"></a>Set(集合)</h4><ul>
<li><p>sadd [添加值]</p>
</li>
<li><p>smembers [取出所有值]</p>
</li>
<li><p>sismember [判断值是否是成员]</p>
</li>
<li><p>srem [删除指定值]</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; sadd emails tom@sohu.com</span><br><span class="line">(integer) 1</span><br><span class="line"></span><br><span class="line"># 判断指定的值是否存在</span><br><span class="line">127.0.0.1:6379&gt; sismember emails tom@sohu.com</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sismember emails tom1@sohu.com</span><br><span class="line">(integer) 0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">127.0.0.1:6379&gt; sadd emails shang@sohu.com</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; sadd emails jack@sohu.com</span><br><span class="line">(integer) 1</span><br><span class="line"></span><br><span class="line"># 输出所有值</span><br><span class="line">127.0.0.1:6379&gt; smembers emails</span><br><span class="line">1) &quot;shang@sohu.com&quot;</span><br><span class="line">2) &quot;jack@sohu.com&quot;</span><br><span class="line">3) &quot;tom@sohu.com&quot;</span><br><span class="line"></span><br><span class="line"># 删除指定值</span><br><span class="line">127.0.0.1:6379&gt; srem emails tom@sohu.com</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; smembers emails</span><br><span class="line">1) &quot;shang@sohu.com&quot;</span><br><span class="line">2) &quot;jack@sohu.com&quot;</span><br></pre></td></tr></table></figure>

<h2 id="Golang-操作-Redis"><a href="#Golang-操作-Redis" class="headerlink" title="Golang 操作 Redis"></a>Golang 操作 Redis</h2><h3 id="安装第三方开源-Redis-库"><a href="#安装第三方开源-Redis-库" class="headerlink" title="安装第三方开源 Redis 库"></a>安装第三方开源 Redis 库</h3><p>使用第三方开源的 Redis 库: <a href="https://github.com/go-redis/redis" target="_blank" rel="noopener">go-redis</a></p>
<p>安装方式:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 1.切换到当前go文件目录中</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2.初始化一个 mod 文件</span></span><br><span class="line">go mod init demo01</span><br><span class="line"><span class="meta">#</span><span class="bash"> 3.安装 github.com/go-redis/redis</span></span><br><span class="line">go get -u github.com/go-redis/redis</span><br></pre></td></tr></table></figure>

<p>安装过程碰到了很多莫名其妙的问题,没有来得及记录,有问题及时百度~</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5qvumbdovj205e02mwec.jpg" alt="image-20220901101256283"></p>
<p><strong>注意:</strong> 官方源码文档中给出的快速使用示例,代码跟引入的包有些出入,因为<code>go-redis</code>版本原因, 有些地方使用方式不同</p>
<p><strong>注: 以下内容通过<a href="https://pkg.go.dev/github.com/go-redis/redis@v6.15.9+incompatible#Client.HMGet" target="_blank" rel="noopener">官方文档</a>的定义进行的编写</strong></p>
<h3 id="Set-Get-String字符串操作"><a href="#Set-Get-String字符串操作" class="headerlink" title="Set/Get-String字符串操作"></a>Set/Get-String字符串操作</h3><blockquote>
<p>  通过 Golang 添加和获取 key-value</p>
</blockquote>
<p>在redis中添加两个键值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">redis-cli</span><br><span class="line">127.0.0.1:6379&gt; set car1 baoma</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; set car2 aodi</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

<p>快速入门</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/go-redis/redis"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleClient</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">//连接本地 redis 数据库</span></span><br><span class="line">	rdb := redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"localhost:6379"</span>,</span><br><span class="line">		Password: <span class="string">""</span>, <span class="comment">// no password set</span></span><br><span class="line">		DB:       <span class="number">0</span>,  <span class="comment">// use default DB</span></span><br><span class="line">	&#125;)</span><br><span class="line">	</span><br><span class="line"> 	<span class="keyword">defer</span> rdb.Close()</span><br><span class="line">    </span><br><span class="line">	<span class="comment">// 添加一对redis的键值</span></span><br><span class="line">	<span class="comment">// 最后一个参数是过期。0表示密钥没有过期时间</span></span><br><span class="line">	err := rdb.Set(<span class="string">"test"</span>, <span class="string">"aaa"</span>, <span class="number">0</span>).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// 输出刚刚上面添加的键值</span></span><br><span class="line">	val, err := rdb.Get(<span class="string">"test"</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"key"</span>, val)</span><br><span class="line">	</span><br><span class="line">    <span class="comment">// 输出 car1</span></span><br><span class="line">	val2, err := rdb.Get(<span class="string">"car1"</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"car1 does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"car1"</span>, val2)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//输出 car2</span></span><br><span class="line">	val3, err := rdb.Get(<span class="string">"car2"</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"car2 does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"car2"</span>, val3)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// car3没有添加,所以不存在</span></span><br><span class="line">	val4, err := rdb.Get(<span class="string">"car3"</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"car3 does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"car3"</span>, val4)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ExampleClient()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5qx5q9q7wj20db01zq2x.jpg" alt="image-20220901105815244"></p>
<h3 id="MSet-MGet操作-String字符串操作"><a href="#MSet-MGet操作-String字符串操作" class="headerlink" title="MSet/MGet操作-String字符串操作"></a>MSet/MGet操作-String字符串操作</h3><blockquote>
<p>  MSet/MGet 数据操作数据</p>
<p>  通过 Golang 对 Redis 操作，一次操作可以 Set / Get 多个 key-val 数据</p>
</blockquote>
<p><code>MSet</code>的官方定义如下图, 参数为一个<code>接口类型的切片</code>,我们可以传入一个 <code>string 类型的切片</code>或者使用for循环依次遍历map切片,传入一对键值字符串(我感觉后者更方便管理,代码也更加简洁,一会儿看下面的代码就可以了)</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r1y5vtwpj20dr02p0sq.jpg" alt="image-20220901134358082"></p>
<p><code>MGet</code>的官方定义如下图, 参数为一个<code>string类型的切片</code>,我们可以传入一个 <code>string 类型的切片</code></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r2xb1wz3j20e402iwej.jpg" alt="image-20220901141745461"></p>
<p><code>MGet</code>方法的返回值 <code>*SliceCmd</code>是一个空的结构体(众所周知,空的结构体更加灵活,可以随意调用定义的各种函数),里面已经定义了多个函数,其中<code>Result</code>返回值, 返回的是一个<code>接口切片</code>和<code>error信息</code></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r1pb1dddj20p00nttb3.jpg" alt="image-20220901133527851"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/go-redis/redis"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleClient</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb := redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"localhost:6379"</span>,</span><br><span class="line">		Password: <span class="string">""</span>, <span class="comment">// no password set</span></span><br><span class="line">		DB:       <span class="number">0</span>,  <span class="comment">// use default DB</span></span><br><span class="line">	&#125;)</span><br><span class="line">	<span class="keyword">defer</span> rdb.Close()</span><br><span class="line">	<span class="comment">//方式一: 可以使用map切片</span></span><br><span class="line">	strArr := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">string</span>)</span><br><span class="line">	strArr[<span class="string">"animal1"</span>] = <span class="string">"Monkey"</span></span><br><span class="line">	strArr[<span class="string">"animal2"</span>] = <span class="string">"Elephant"</span></span><br><span class="line">	strArr[<span class="string">"animal3"</span>] = <span class="string">"Tiger"</span></span><br><span class="line">	<span class="comment">// 添加redis的键值</span></span><br><span class="line">	<span class="keyword">for</span> i, v := <span class="keyword">range</span> strArr &#123;</span><br><span class="line">		err := rdb.MSet(i, v).Err()</span><br><span class="line">		<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="built_in">panic</span>(err)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//方式二: 也可以使用string类型的切片</span></span><br><span class="line">	<span class="comment">//strArr := []string&#123;"animal1", "Monkey", "animal2", "elephant", "animal3", "tiger"&#125;</span></span><br><span class="line">	<span class="comment">// 添加redis的键值</span></span><br><span class="line">	<span class="comment">// err := rdb.MSet(strArr).Err()</span></span><br><span class="line">	<span class="comment">// if err != nil &#123;</span></span><br><span class="line">	<span class="comment">// 	panic(err)</span></span><br><span class="line">	<span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">// strArr_key := []string&#123;"animal1", "animal2", "animal3"&#125;</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> key := <span class="keyword">range</span> strArr &#123;</span><br><span class="line">		<span class="comment">// 输出刚刚上面添加的键值</span></span><br><span class="line">		result, err := rdb.MGet(key).Result()</span><br><span class="line">		<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">			fmt.Println(<span class="string">"this key does not exist"</span>)</span><br><span class="line">		&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">			<span class="built_in">panic</span>(err)</span><br><span class="line">		&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">for</span> _, v := <span class="keyword">range</span> result &#123;</span><br><span class="line">				fmt.Printf(<span class="string">"%v=%v\n"</span>, key, v)</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ExampleClient()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r2ummw16j20k903emxb.jpg" alt="image-20220901141510533"></p>
<h3 id="HSet-HGet-Hash操作"><a href="#HSet-HGet-Hash操作" class="headerlink" title="HSet/HGet-Hash操作"></a>HSet/HGet-Hash操作</h3><blockquote>
<p>  通过 Golang 对 Redis 操作 Hash 数据类型</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/go-redis/redis"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleClient</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb := redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"localhost:6379"</span>,</span><br><span class="line">		Password: <span class="string">""</span>, <span class="comment">// no password set</span></span><br><span class="line">		DB:       <span class="number">0</span>,  <span class="comment">// use default DB</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">   	<span class="keyword">defer</span> rdb.Close()</span><br><span class="line">    </span><br><span class="line">	<span class="comment">//1 HSet 添加hash键值</span></span><br><span class="line">	err := rdb.HSet(<span class="string">"userinfo"</span>, <span class="string">"name"</span>, <span class="string">"tom"</span>).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	err = rdb.HSet(<span class="string">"userinfo"</span>, <span class="string">"age"</span>, <span class="string">"6"</span>).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2 HGet 输出hash键值</span></span><br><span class="line">	res := <span class="string">""</span></span><br><span class="line">	res, err = rdb.HGet(<span class="string">"userinfo"</span>, <span class="string">"name"</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"userinfo name does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"userinfo-name"</span>, res)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	res, err = rdb.HGet(<span class="string">"userinfo"</span>, <span class="string">"age"</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"userinfo age does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"userinfo-age"</span>, res)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ExampleClient()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5qy8xf2mlj20ka02dq30.jpg" alt="image-20220901113555207"></p>
<h3 id="HMSet-HMGet-Hash操作"><a href="#HMSet-HMGet-Hash操作" class="headerlink" title="HMSet/HMGet-Hash操作"></a>HMSet/HMGet-Hash操作</h3><blockquote>
<p>  对 hash 数据结构，field-val 是批量放入和读取</p>
</blockquote>
<p>根据官方文档, <code>HMSet</code>传入的是一个<code>map切片</code>,我们需要自己定义然后传参即可</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5qylx5w19j20j902jq34.jpg" alt="image-20220901114824427"></p>
<p><code>MHGet</code>方法传参时,传入的是一个 <code>[]string数组</code></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5qzsyx3zxj20fg02hdfw.jpg" alt="image-20220901122947344"></p>
<p><code>HMGet</code>方法的返回值 <code>*SliceCmd</code>是一个空的结构体,里面已经定义了多个函数,其中<code>Result</code>返回值, 返回的是一个<code>接口切片</code>和<code>error信息</code></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r1pb1dddj20p00nttb3.jpg" alt="image-20220901133527851"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/go-redis/redis"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleClient</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb := redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"localhost:6379"</span>,</span><br><span class="line">		Password: <span class="string">""</span>, <span class="comment">// no password set</span></span><br><span class="line">		DB:       <span class="number">0</span>,  <span class="comment">// use default DB</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">defer</span> rdb.Close()</span><br><span class="line">    </span><br><span class="line">	m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	m[<span class="string">"name"</span>] = <span class="string">"jack"</span></span><br><span class="line">	m[<span class="string">"age"</span>] = <span class="string">"7"</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//1 HMSet</span></span><br><span class="line">	err := rdb.HMSet(<span class="string">"userinfo1"</span>, m).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//2 HMGet</span></span><br><span class="line">	<span class="comment">// 定义一个string类型切片,指定field值</span></span><br><span class="line">	str := []<span class="keyword">string</span>&#123;<span class="string">"name"</span>, <span class="string">"age"</span>&#125;</span><br><span class="line">	<span class="comment">// Result返回的是一个 string 类型的 interface 接口</span></span><br><span class="line">	result, err := rdb.HMGet(<span class="string">"userinfo1"</span>, str...).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"userinfo1 does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"userinfo1="</span>, result)</span><br><span class="line">		fmt.Printf(<span class="string">"result的类型=%T\n"</span>, result)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 循环遍历 result ,借助上面定义的 str 输出 userinfo1 的索引与值</span></span><br><span class="line">	fmt.Println(<span class="string">"userinfo1的键值内容如下:"</span>)</span><br><span class="line">	<span class="keyword">for</span> i, v := <span class="keyword">range</span> result &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%v=%v\n"</span>, str[i], v)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ExampleClient()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r1s2cd51j20kf045glt.jpg" alt="image-20220901133806602"></p>
<h3 id="列表操作"><a href="#列表操作" class="headerlink" title="列表操作"></a>列表操作</h3><blockquote>
<p>  列表中比较常用的指令有: LPush/RPush/LInsert/RInsert/LRange遍历 等</p>
</blockquote>
<ul>
<li>LPush/RPush</li>
</ul>
<p>从下图可以得知,<code>values</code>传入的值是一个 <code>接口切片</code>,可以传入任意类型数据,这里我们直接传入任意数量的字符串</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r4auzubbj20hv02h0su.jpg" alt="image-20220901150522051"></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r4ch0lilj20hs02naa2.jpg" alt="image-20220901150655299"></p>
<p>可以使用<code>LRange</code>遍历列表的数据</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r4iz8fa8j20hi02idfx.jpg" alt="image-20220901151310746"></p>
<ul>
<li>LInsert/RInsert</li>
</ul>
<p>下面图中的定义可能会有人看不懂</p>
<ul>
<li>key =&gt; 键值</li>
<li>op =&gt; after/before</li>
<li>pivot =&gt; 指定的数据位置</li>
<li>value =&gt; 需要添加的数组</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r4vw3ma3j20ij02g74d.jpg" alt="image-20220901152535204"></p>
<p>举个例子</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rdb.LPush(<span class="string">"hobby"</span>,<span class="string">"篮球"</span>)</span><br><span class="line">rdb.LInsert(<span class="string">"hobby"</span>,<span class="string">"before"</span>,<span class="string">"篮球"</span>,<span class="string">"乒乓球"</span>)</span><br></pre></td></tr></table></figure>

<p>上代码</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/go-redis/redis"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleClient</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb := redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"localhost:6379"</span>,</span><br><span class="line">		Password: <span class="string">""</span>, <span class="comment">// no password set</span></span><br><span class="line">		DB:       <span class="number">0</span>,  <span class="comment">// use default DB</span></span><br><span class="line">	&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">defer</span> rdb.Close()</span><br><span class="line">    </span><br><span class="line">	<span class="comment">// Lpush向列表中添加数据</span></span><br><span class="line">	strArr1 := []<span class="keyword">string</span>&#123;<span class="string">"1.唱"</span>, <span class="string">"2.跳"</span>&#125;</span><br><span class="line">	err := rdb.LPush(<span class="string">"蔡徐坤的hobby"</span>, strArr1).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Rpush向列表中添加数据</span></span><br><span class="line">	strArr2 := []<span class="keyword">string</span>&#123;<span class="string">"3.rap"</span>, <span class="string">"4.篮球"</span>&#125;</span><br><span class="line">	err = rdb.RPush(<span class="string">"蔡徐坤的hobby"</span>, strArr2).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// LRange 读取数据</span></span><br><span class="line">	result, err := rdb.LRange(<span class="string">"蔡徐坤的hobby"</span>, <span class="number">0</span>, <span class="number">-1</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"this key does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"result="</span>, result)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// LInsert 在列表中的指定位置添加数据</span></span><br><span class="line">	err = rdb.LInsert(<span class="string">"蔡徐坤的hobby"</span>, <span class="string">"before"</span>, <span class="string">"3.rap"</span>, <span class="string">"鸡你太美"</span>).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//RInsert 这里不做演示了,原理同上</span></span><br><span class="line">    </span><br><span class="line">	<span class="comment">// LRange 读取数据</span></span><br><span class="line">	result, err = rdb.LRange(<span class="string">"蔡徐坤的hobby"</span>, <span class="number">0</span>, <span class="number">-1</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"this key does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"result="</span>, result)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 删除该键值,方便重复进行调试</span></span><br><span class="line">	rdb.Del(<span class="string">"蔡徐坤的hobby"</span>)</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ExampleClient()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r55in7eoj20kb02dglq.jpg" alt="image-20220901153450512"></p>
<h3 id="Set-集合操作"><a href="#Set-集合操作" class="headerlink" title="Set-集合操作"></a>Set-集合操作</h3><p><code>SAdd</code>用来向集合中添加键值</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r64q0n6tj20fz02j74c.jpg" alt="image-20220901160841226"></p>
<p><code>SMembers</code>用来输出集合中的数据</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r65sgz58j20eb02jdfv.jpg" alt="image-20220901160942192"></p>
<p><code>SIsMember</code> 用于判断一个值在集合中是否存在,从下图可以看出,该方法返回一个<code>*BoolCmd</code></p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r60xctkdj20h502oaa4.jpg" alt="image-20220901160501422"></p>
<p><code>*BoolCmd</code>的<code>Result</code>方法会返回一个<code>bool</code>类型的值</p>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r63fps4rj20me0o3di0.jpg" alt="image-20220901160726249"></p>
<p>上代码</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/go-redis/redis"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出集合中的内容</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Smembers</span><span class="params">(rdb *redis.Client, urls <span class="keyword">string</span>)</span> []<span class="title">string</span></span> &#123;</span><br><span class="line">	result, err := rdb.SMembers(urls).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"this key does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断集合中某个值是否存在</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">SisMember</span><span class="params">(rdb *redis.Client, urls <span class="keyword">string</span>, url <span class="keyword">string</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">	result, err := rdb.SIsMember(urls, url).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"this key does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//计算集合的大小</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Scard</span><span class="params">(rdb *redis.Client, urls <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">	result, err := rdb.SCard(<span class="string">"urls"</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">"this key does not exist"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Printf(<span class="string">"%v 的集合大小=%d\n"</span>, urls, result)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleClient</span><span class="params">()</span></span> &#123;</span><br><span class="line">	rdb := redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">"localhost:6379"</span>,</span><br><span class="line">		Password: <span class="string">""</span>, <span class="comment">// no password set</span></span><br><span class="line">		DB:       <span class="number">0</span>,  <span class="comment">// use default DB</span></span><br><span class="line">	&#125;)</span><br><span class="line">	fmt.Printf(<span class="string">"rdb的类型为%T\n"</span>, rdb)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">defer</span> rdb.Close()</span><br><span class="line"></span><br><span class="line">	<span class="comment">// SAdd 向无序集合中添加数据</span></span><br><span class="line">	err := rdb.SAdd(<span class="string">"urls"</span>, <span class="string">"www.baidu.com"</span>, <span class="string">"www.google.com"</span>).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 输出集合中的内容</span></span><br><span class="line">	res_urls := Smembers(rdb, <span class="string">"urls"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"urls="</span>, res_urls)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//计算集合大小</span></span><br><span class="line">	Scard(rdb, <span class="string">"urls"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">//判断集合中某个值是否存在</span></span><br><span class="line">	res_bool := SisMember(rdb, <span class="string">"urls"</span>, <span class="string">"www.baidu.com"</span>)</span><br><span class="line">	<span class="keyword">if</span> res_bool &#123; <span class="comment">// 当 res_bool 为 true 时</span></span><br><span class="line">		fmt.Println(<span class="string">"www.baidu.com 存在"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"www.baidu.com 不存在"</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//删除指定值</span></span><br><span class="line">	err = rdb.SRem(<span class="string">"urls"</span>, <span class="string">"www.baidu.com"</span>).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"www.baidu.com 已被删除"</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//判断集合中某个值是否存在</span></span><br><span class="line">	res_bool = SisMember(rdb, <span class="string">"urls"</span>, <span class="string">"www.baidu.com"</span>)</span><br><span class="line">	<span class="keyword">if</span> res_bool &#123; <span class="comment">// 当 res_bool 为 true 时</span></span><br><span class="line">		fmt.Println(<span class="string">"www.baidu.com 存在"</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"www.baidu.com 不存在"</span>)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 输出集合中的内容</span></span><br><span class="line">	res_urls = Smembers(rdb, <span class="string">"urls"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"urls="</span>, res_urls)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	ExampleClient()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5r7bvmn6sj20kc05hmxj.jpg" alt="image-20220901165008732"></p>
<h2 id="Redis链接池"><a href="#Redis链接池" class="headerlink" title="Redis链接池"></a>Redis链接池</h2><blockquote>
<p>  说明: 通过 Golang 对 Redis 操作， 还可以通过 Redis 链接池, 流程如下: </p>
<p>  1)   事先初始化一定数量的链接，放入到链接池<br>  2)   当 Go 需要操作 Redis 时，直接从 Redis 链接池取出链接即可。</p>
<p>  2) 这样可以节省临时获取 Redis 链接的时间，从而提高效率</p>
</blockquote>
<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5s01n74m9j21350bdq49.jpg" alt="image-20220902092338955"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"net"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line"></span><br><span class="line">	<span class="string">"github.com/go-redis/redis"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明一个全局变量</span></span><br><span class="line"><span class="keyword">var</span> pool *redis.Client</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">	pool = redis.NewClient(</span><br><span class="line">		&amp;redis.Options&#123;</span><br><span class="line">			<span class="comment">//连接池容量及闲置连接数量</span></span><br><span class="line">			PoolSize:     <span class="number">15</span>, <span class="comment">// 连接池最大socket连接数，默认为4倍CPU数， 4 * runtime.NumCPU</span></span><br><span class="line">			MinIdleConns: <span class="number">10</span>, <span class="comment">//在启动阶段创建指定数量的Idle连接，并长期维持idle状态的连接数不少于指定数量</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//超时</span></span><br><span class="line">			DialTimeout:  <span class="number">5</span> * time.Second, <span class="comment">//连接建立超时时间，默认5秒。</span></span><br><span class="line">			ReadTimeout:  <span class="number">3</span> * time.Second, <span class="comment">//读超时，默认3秒， -1表示取消读超时</span></span><br><span class="line">			WriteTimeout: <span class="number">3</span> * time.Second, <span class="comment">//写超时，默认等于读超时</span></span><br><span class="line">			PoolTimeout:  <span class="number">4</span> * time.Second, <span class="comment">//当所有连接都处在繁忙状态时，客户端等待可用连接的最大等待时长，默认为读超时+1秒。</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//闲置连接检查包括IdleTimeout，MaxConnAge</span></span><br><span class="line">			IdleCheckFrequency: <span class="number">60</span> * time.Second, <span class="comment">//闲置连接检查的周期，默认为1分钟，-1表示不做周期性检查，只在客户端获取连接时对闲置连接进行处理。</span></span><br><span class="line">			IdleTimeout:        <span class="number">5</span> * time.Minute,  <span class="comment">//闲置超时，默认5分钟，-1表示取消闲置超时检查</span></span><br><span class="line">			MaxConnAge:         <span class="number">0</span> * time.Second,  <span class="comment">//连接存活时长，从创建开始计时，超过指定时长则关闭连接，默认为0，即不关闭存活时长较长的连接</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//命令执行失败时的重试策略</span></span><br><span class="line">			MaxRetries:      <span class="number">0</span>,                      <span class="comment">// 命令执行失败时，最多重试多少次，默认为0即不重试</span></span><br><span class="line">			MinRetryBackoff: <span class="number">8</span> * time.Millisecond,   <span class="comment">//每次计算重试间隔时间的下限，默认8毫秒，-1表示取消间隔</span></span><br><span class="line">			MaxRetryBackoff: <span class="number">512</span> * time.Millisecond, <span class="comment">//每次计算重试间隔时间的上限，默认512毫秒，-1表示取消间隔</span></span><br><span class="line"></span><br><span class="line">			<span class="comment">//可自定义连接函数</span></span><br><span class="line">			Dialer: <span class="function"><span class="keyword">func</span><span class="params">()</span> <span class="params">(net.Conn, error)</span></span> &#123;</span><br><span class="line">				netDialer := &amp;net.Dialer&#123;</span><br><span class="line">					Timeout:   <span class="number">5</span> * time.Second,</span><br><span class="line">					KeepAlive: <span class="number">5</span> * time.Minute,</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">return</span> netDialer.Dial(<span class="string">"tcp"</span>, <span class="string">"127.0.0.1:6379"</span>)</span><br><span class="line">			&#125;,</span><br><span class="line"></span><br><span class="line">			<span class="comment">//钩子函数</span></span><br><span class="line">			<span class="comment">//仅当客户端执行命令时需要从连接池获取连接时，如果连接池需要新建连接时则会调用此钩子函数</span></span><br><span class="line">			OnConnect: <span class="function"><span class="keyword">func</span><span class="params">(conn *redis.Conn)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">				fmt.Printf(<span class="string">"conn=%v\n"</span>, conn)</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">			&#125;,</span><br><span class="line">		&#125;,</span><br><span class="line">	)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="comment">// 先从 pool 取出一个链接</span></span><br><span class="line">	err := pool.Set(<span class="string">"user1"</span>, <span class="string">"poker"</span>, <span class="number">0</span>).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	result, err := pool.Get(<span class="string">"user1"</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"result="</span>, result)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/e6c9d24ely1h5s37bwsboj20nr022aa6.jpg" alt="image-20220902111256486"></p>

      
    </div>
    
    
    

    <div>
    
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  
  <!-- JS库 sweetalert 可修改路径 -->
  <script type="text/javascript" src="http://jslibs.wuxubj.cn/sweetalert_mini/jquery-1.7.1.min.js"></script>
  <script src="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.min.js"></script>
  <link rel="stylesheet" type="text/css" href="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.mini.css">

  <p><span>本文标题:</span>Golang学习笔记</p>
  <p><span>文章作者:</span>尚先森</p>
  <p><span>发布时间:</span>2022年06月02日 - 13:59:21</p>
  <p><span>最后更新:</span>2022年11月15日 - 15:34:47</p>
  <p><span>原始链接:</span><a href="/2022/06/02/Golang学习笔记/" title="Golang学习笔记">https://imauu.gitee.io/2022/06/02/Golang学习笔记/</a>
    <span class="copy-path" title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="https://imauu.gitee.io/2022/06/02/Golang学习笔记/" aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
    clipboard.on('success', $(function(){
      $(".fa-clipboard").click(function(){
        swal({   
          title: "",   
          text: '复制成功',   
          html: false,
          timer: 500,   
          showConfirmButton: false
        });
      });
    }));  
</script>

    
    </div>

    
        
        <div>
            <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/images/syz.png" alt="尚先森 wechat" style="width: 200px; max-width: 100%;">
    <div>有任何问题可以扫描上方二维码私聊我哦😊</div>
</div>

        </div>
    
    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>您的支持是我创作的最大动力^_^</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/weixin.png" alt="尚先森 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/zhifubao.png" alt="尚先森 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/开发/" rel="tag"><img src="/images/tag.png"> 开发</a>
          
            <a href="/tags/Golang/" rel="tag"><img src="/images/tag.png"> Golang</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2022/05/01/Linux运维常见问题/" rel="next" title="Linux运维常见问题">
                <i class="fa fa-chevron-left"></i> Linux运维常见问题
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2022/09/05/shell命令记录/" rel="prev" title="shell命令记录">
                shell命令记录 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fc-ssl.duitang.com%2Fuploads%2Fitem%2F202003%2F30%2F20200330091314_yNVUZ.thumb.1000_0.jpeg&refer=http%3A%2F%2Fc-ssl.duitang.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1679478595&t=f1ad1f61217ae47e4651a721e40a5654" alt="尚先森">
            
              <p class="site-author-name" itemprop="name">尚先森</p>
              <p class="site-description motion-element" itemprop="description">最后一刻，都不可以放弃希望！</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">22</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/shang-code" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:syz15822409222@126.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://a4.qpic.cn/psb?/V10taC184UP7Xd/DBrT8JfiC4.Cbt9gOoLq3EMz6VxjKNILvuMgpLI*L80!/c/dJ8AAAAAAAAA&ek=1&kp=1&pt=0&bo=rgGuAa4BrgERFyA!&tl=1&vuin=1093999475&tm=1566439200&sce=60-2-2&rf=0-0" target="_blank" title="微信">
                      
                        <i class="fa fa-fw fa-globe"></i>微信</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://a4.qpic.cn/psb?/V10taC184UP7Xd/ZzGxvjixd59IA0smjXXNRNqr.iYN*upaiO01bWSzGWE!/c/dJ8AAAAAAAAA&ek=1&kp=1&pt=0&bo=HALkAhwC5AIRFyA!&tl=1&vuin=1093999475&tm=1566439200&sce=60-2-2&rf=0-0" target="_blank" title="QQ">
                      
                        <i class="fa fa-fw fa-globe"></i>QQ</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                友情链接
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.runoob.com/" title="菜鸟教程" target="_blank">菜鸟教程</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.imooc.com/" title="慕课网" target="_blank">慕课网</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Golang语言简介"><span class="nav-number">1.</span> <span class="nav-text">Golang语言简介</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#图标上的动物"><span class="nav-number">1.1.</span> <span class="nav-text">图标上的动物</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Go语言的由来"><span class="nav-number">1.2.</span> <span class="nav-text">Go语言的由来</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Go语言的特点"><span class="nav-number">1.3.</span> <span class="nav-text">Go语言的特点</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Golang环境配置"><span class="nav-number">2.</span> <span class="nav-text">Golang环境配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Mac-下搭建-Go-开发环境-安装和配置-SDK"><span class="nav-number">2.1.</span> <span class="nav-text">Mac 下搭建 Go 开发环境-安装和配置 SDK</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装SDK"><span class="nav-number">2.1.1.</span> <span class="nav-text">安装SDK</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Mac-下配置-Golang-环境变量"><span class="nav-number">2.1.2.</span> <span class="nav-text">Mac 下配置 Golang 环境变量</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mac下如何开发Go程序"><span class="nav-number">3.</span> <span class="nav-text">Mac下如何开发Go程序</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#准备工作"><span class="nav-number">3.1.</span> <span class="nav-text">准备工作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生成可执行文件并运行"><span class="nav-number">3.2.</span> <span class="nav-text">生成可执行文件并运行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#直接运行Go文件"><span class="nav-number">3.3.</span> <span class="nav-text">直接运行Go文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Go开发须知"><span class="nav-number">4.</span> <span class="nav-text">Go开发须知</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Go程序开发的注意事项"><span class="nav-number">4.1.</span> <span class="nav-text">Go程序开发的注意事项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Go-语言的转义字符-escape-char"><span class="nav-number">4.2.</span> <span class="nav-text">Go 语言的转义字符(escape char)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#注释"><span class="nav-number">4.3.</span> <span class="nav-text">注释</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#代码风格"><span class="nav-number">4.4.</span> <span class="nav-text">代码风格</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#官方指南"><span class="nav-number">4.5.</span> <span class="nav-text">官方指南</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#中文版在线标准库文档"><span class="nav-number">4.6.</span> <span class="nav-text">中文版在线标准库文档</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#变量"><span class="nav-number">5.</span> <span class="nav-text">变量</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Golang变量使用的三种方式"><span class="nav-number">5.1.</span> <span class="nav-text">Golang变量使用的三种方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#变量的声明-初始化-赋值"><span class="nav-number">5.2.</span> <span class="nav-text">变量的声明/初始化/赋值</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#声明变量"><span class="nav-number">5.2.1.</span> <span class="nav-text">声明变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始化变量"><span class="nav-number">5.2.2.</span> <span class="nav-text">初始化变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#给变量赋值"><span class="nav-number">5.2.3.</span> <span class="nav-text">给变量赋值</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#号的使用"><span class="nav-number">5.3.</span> <span class="nav-text">+号的使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据类型"><span class="nav-number">5.4.</span> <span class="nav-text">数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#整数类型"><span class="nav-number">5.4.1.</span> <span class="nav-text">整数类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#整数型使用细节"><span class="nav-number">5.4.1.1.</span> <span class="nav-text">整数型使用细节</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#浮点数类型"><span class="nav-number">5.4.2.</span> <span class="nav-text">浮点数类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#浮点型使用细节"><span class="nav-number">5.4.2.1.</span> <span class="nav-text">浮点型使用细节</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符类型"><span class="nav-number">5.4.3.</span> <span class="nav-text">字符类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#字符类型使用细节"><span class="nav-number">5.4.3.1.</span> <span class="nav-text">字符类型使用细节</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#布尔类型"><span class="nav-number">5.4.4.</span> <span class="nav-text">布尔类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#string类型"><span class="nav-number">5.4.5.</span> <span class="nav-text">string类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本数据类型的默认值"><span class="nav-number">5.4.6.</span> <span class="nav-text">基本数据类型的默认值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本数据类型的相互转换"><span class="nav-number">5.4.7.</span> <span class="nav-text">基本数据类型的相互转换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#注意事项"><span class="nav-number">5.4.7.1.</span> <span class="nav-text">注意事项</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本数据类型转换为string"><span class="nav-number">5.4.8.</span> <span class="nav-text">基本数据类型转换为string</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#方式一-fmt-Sprintf"><span class="nav-number">5.4.8.1.</span> <span class="nav-text">方式一:fmt.Sprintf</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方式二-strconv"><span class="nav-number">5.4.8.2.</span> <span class="nav-text">方式二:strconv</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#string转换为基本数据类型"><span class="nav-number">5.4.9.</span> <span class="nav-text">string转换为基本数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#注意事项-1"><span class="nav-number">5.4.9.1.</span> <span class="nav-text">注意事项</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#指针"><span class="nav-number">5.5.</span> <span class="nav-text">指针</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本介绍"><span class="nav-number">5.5.1.</span> <span class="nav-text">基本介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#案例演示"><span class="nav-number">5.5.1.1.</span> <span class="nav-text">案例演示</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用细节"><span class="nav-number">5.5.2.</span> <span class="nav-text">使用细节</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#值类型和引用类型"><span class="nav-number">5.6.</span> <span class="nav-text">值类型和引用类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用特点"><span class="nav-number">5.6.1.</span> <span class="nav-text">使用特点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#标识符的命名规范"><span class="nav-number">5.7.</span> <span class="nav-text">标识符的命名规范</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#标识符概念"><span class="nav-number">5.7.1.</span> <span class="nav-text">标识符概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#命名规则"><span class="nav-number">5.7.2.</span> <span class="nav-text">命名规则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#标识符命名注意事项"><span class="nav-number">5.7.3.</span> <span class="nav-text">标识符命名注意事项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#系统保留关键字"><span class="nav-number">5.8.</span> <span class="nav-text">系统保留关键字</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#系统的预定义标识符"><span class="nav-number">5.9.</span> <span class="nav-text">系统的预定义标识符</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#运算符"><span class="nav-number">6.</span> <span class="nav-text">运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#运算符的基本介绍"><span class="nav-number">6.1.</span> <span class="nav-text">运算符的基本介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#算术运算符"><span class="nav-number">6.1.1.</span> <span class="nav-text">算术运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#算术运算符的一览表"><span class="nav-number">6.1.1.1.</span> <span class="nav-text">算术运算符的一览表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#演示-的使用特点"><span class="nav-number">6.1.1.2.</span> <span class="nav-text">演示 / 的使用特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#演示-的使用特点-1"><span class="nav-number">6.1.1.3.</span> <span class="nav-text">演示 % 的使用特点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关系运算符-比较运算符"><span class="nav-number">6.1.2.</span> <span class="nav-text">关系运算符(比较运算符)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本介绍-1"><span class="nav-number">6.1.2.1.</span> <span class="nav-text">基本介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#关系运算符一览图"><span class="nav-number">6.1.2.2.</span> <span class="nav-text">关系运算符一览图</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#逻辑运算符"><span class="nav-number">6.1.3.</span> <span class="nav-text">逻辑运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本介绍-2"><span class="nav-number">6.1.3.1.</span> <span class="nav-text">基本介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#逻辑运算的说明"><span class="nav-number">6.1.3.2.</span> <span class="nav-text">逻辑运算的说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#细节说明"><span class="nav-number">6.1.3.3.</span> <span class="nav-text">细节说明</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#赋值运算符"><span class="nav-number">6.1.4.</span> <span class="nav-text">赋值运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#赋值运算符的分类"><span class="nav-number">6.1.4.1.</span> <span class="nav-text">赋值运算符的分类</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#赋值运算符的特点"><span class="nav-number">6.1.4.2.</span> <span class="nav-text">赋值运算符的特点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#位运算符"><span class="nav-number">6.1.5.</span> <span class="nav-text">位运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其它运算符说明"><span class="nav-number">6.1.6.</span> <span class="nav-text">其它运算符说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#运算符的优先级"><span class="nav-number">6.2.</span> <span class="nav-text">运算符的优先级</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#运算符的优先级的一览表"><span class="nav-number">6.2.1.</span> <span class="nav-text">运算符的优先级的一览表</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#键盘输入语句"><span class="nav-number">7.</span> <span class="nav-text">键盘输入语句</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#介绍"><span class="nav-number">7.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#步骤"><span class="nav-number">7.2.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#演示案例"><span class="nav-number">7.3.</span> <span class="nav-text">演示案例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#进制"><span class="nav-number">8.</span> <span class="nav-text">进制</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#进制的图示"><span class="nav-number">8.1.</span> <span class="nav-text">进制的图示</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#进制的转换"><span class="nav-number">8.2.</span> <span class="nav-text">进制的转换</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#其它进制转十进制"><span class="nav-number">8.2.1.</span> <span class="nav-text">其它进制转十进制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#二进制如何转十进制"><span class="nav-number">8.2.1.1.</span> <span class="nav-text">二进制如何转十进制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#八进制如何转十进制"><span class="nav-number">8.2.1.2.</span> <span class="nav-text">八进制如何转十进制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#十六进制转十进制"><span class="nav-number">8.2.1.3.</span> <span class="nav-text">十六进制转十进制</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#十进制转其它进制"><span class="nav-number">8.2.2.</span> <span class="nav-text">十进制转其它进制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#十进制转二进制"><span class="nav-number">8.2.2.1.</span> <span class="nav-text">十进制转二进制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#十进制转八进制"><span class="nav-number">8.2.2.2.</span> <span class="nav-text">十进制转八进制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#十进制转十六进制"><span class="nav-number">8.2.2.3.</span> <span class="nav-text">十进制转十六进制</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二进制转八进制-十六进制"><span class="nav-number">8.2.3.</span> <span class="nav-text">二进制转八进制/十六进制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#二进制转八进制"><span class="nav-number">8.2.3.1.</span> <span class="nav-text">二进制转八进制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#二进制转十六进制"><span class="nav-number">8.2.3.2.</span> <span class="nav-text">二进制转十六进制</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#八进制-十六进制转二进制"><span class="nav-number">8.2.4.</span> <span class="nav-text">八进制/十六进制转二进制</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#八进制转二进制"><span class="nav-number">8.2.4.1.</span> <span class="nav-text">八进制转二进制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#十六进制转二进制"><span class="nav-number">8.2.4.2.</span> <span class="nav-text">十六进制转二进制</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#位运算"><span class="nav-number">9.</span> <span class="nav-text">位运算</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#原码、反码、补码"><span class="nav-number">9.1.</span> <span class="nav-text">原码、反码、补码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#位运算符和移位运算符"><span class="nav-number">9.2.</span> <span class="nav-text">位运算符和移位运算符</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#流程控制"><span class="nav-number">10.</span> <span class="nav-text">流程控制</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#顺序控制"><span class="nav-number">10.1.</span> <span class="nav-text">顺序控制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分支控制"><span class="nav-number">10.2.</span> <span class="nav-text">分支控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#单分支"><span class="nav-number">10.2.1.</span> <span class="nav-text">单分支</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#双分支"><span class="nav-number">10.2.2.</span> <span class="nav-text">双分支</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多分支"><span class="nav-number">10.2.3.</span> <span class="nav-text">多分支</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#嵌套分支"><span class="nav-number">10.2.4.</span> <span class="nav-text">嵌套分支</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#switch分支"><span class="nav-number">10.2.5.</span> <span class="nav-text">switch分支</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#循环控制"><span class="nav-number">10.3.</span> <span class="nav-text">循环控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#for循环"><span class="nav-number">10.3.1.</span> <span class="nav-text">for循环</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#方式一"><span class="nav-number">10.3.1.1.</span> <span class="nav-text">方式一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方式二"><span class="nav-number">10.3.1.2.</span> <span class="nav-text">方式二</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方式三-无限循环"><span class="nav-number">10.3.1.3.</span> <span class="nav-text">方式三: 无限循环</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#for-range"><span class="nav-number">10.3.1.4.</span> <span class="nav-text">for-range</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#while-和-do-while"><span class="nav-number">10.3.2.</span> <span class="nav-text">while 和 do..while</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#while"><span class="nav-number">10.3.2.1.</span> <span class="nav-text">while</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#do-while"><span class="nav-number">10.3.2.2.</span> <span class="nav-text">do..while</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#break"><span class="nav-number">10.3.3.</span> <span class="nav-text">break</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#continue"><span class="nav-number">10.3.4.</span> <span class="nav-text">continue</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#goto"><span class="nav-number">10.3.5.</span> <span class="nav-text">goto</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#return"><span class="nav-number">10.3.6.</span> <span class="nav-text">return</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#函数"><span class="nav-number">11.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基本语法"><span class="nav-number">11.1.</span> <span class="nav-text">基本语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#快速入门"><span class="nav-number">11.2.</span> <span class="nav-text">快速入门</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#包"><span class="nav-number">11.3.</span> <span class="nav-text">包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#原理"><span class="nav-number">11.3.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#三大作用"><span class="nav-number">11.3.2.</span> <span class="nav-text">三大作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#说明"><span class="nav-number">11.3.3.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#快速入门-1"><span class="nav-number">11.3.4.</span> <span class="nav-text">快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注意事项和细节"><span class="nav-number">11.3.5.</span> <span class="nav-text">注意事项和细节</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数的调用机制"><span class="nav-number">11.4.</span> <span class="nav-text">函数的调用机制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#return语句"><span class="nav-number">11.5.</span> <span class="nav-text">return语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本语法与说明"><span class="nav-number">11.5.1.</span> <span class="nav-text">基本语法与说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例-计算两个数的和and差"><span class="nav-number">11.5.2.</span> <span class="nav-text">案例: 计算两个数的和and差</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数的递归"><span class="nav-number">11.6.</span> <span class="nav-text">函数的递归</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#总结"><span class="nav-number">11.6.1.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#递归函数练习"><span class="nav-number">11.6.2.</span> <span class="nav-text">递归函数练习</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数的注意事项和细节"><span class="nav-number">11.7.</span> <span class="nav-text">函数的注意事项和细节</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#init函数"><span class="nav-number">11.8.</span> <span class="nav-text">init函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#init函数的注意事项和细节"><span class="nav-number">11.8.1.</span> <span class="nav-text">init函数的注意事项和细节</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#匿名函数"><span class="nav-number">11.9.</span> <span class="nav-text">匿名函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#全局匿名函数"><span class="nav-number">11.9.1.</span> <span class="nav-text">全局匿名函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#闭包"><span class="nav-number">11.10.</span> <span class="nav-text">闭包</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#闭包的最佳实践"><span class="nav-number">11.10.1.</span> <span class="nav-text">闭包的最佳实践</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#defer"><span class="nav-number">11.11.</span> <span class="nav-text">defer</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#快速入门-2"><span class="nav-number">11.11.1.</span> <span class="nav-text">快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注意事项和细节-1"><span class="nav-number">11.11.2.</span> <span class="nav-text">注意事项和细节</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#defer-的最佳实践"><span class="nav-number">11.11.3.</span> <span class="nav-text">defer 的最佳实践</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字符串常用系统函数"><span class="nav-number">11.12.</span> <span class="nav-text">字符串常用系统函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#统计字符串长度-len"><span class="nav-number">11.12.1.</span> <span class="nav-text">统计字符串长度: len()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符串遍历"><span class="nav-number">11.12.2.</span> <span class="nav-text">字符串遍历</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符串转整数"><span class="nav-number">11.12.3.</span> <span class="nav-text">字符串转整数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#整数转字符串"><span class="nav-number">11.12.4.</span> <span class="nav-text">整数转字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符串转-byte"><span class="nav-number">11.12.5.</span> <span class="nav-text">字符串转[]byte</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#byte转字符串"><span class="nav-number">11.12.6.</span> <span class="nav-text">[]byte转字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#十进制转其它进制-1"><span class="nav-number">11.12.7.</span> <span class="nav-text">十进制转其它进制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查找子串是否在指定的字符串中"><span class="nav-number">11.12.8.</span> <span class="nav-text">查找子串是否在指定的字符串中</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#统计子串个数"><span class="nav-number">11.12.9.</span> <span class="nav-text">统计子串个数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不区分大小写的字符串比较"><span class="nav-number">11.12.10.</span> <span class="nav-text">不区分大小写的字符串比较</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取指定字符的索引"><span class="nav-number">11.12.11.</span> <span class="nav-text">获取指定字符的索引</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字符串的替换"><span class="nav-number">11.12.12.</span> <span class="nav-text">字符串的替换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#分隔字符串"><span class="nav-number">11.12.13.</span> <span class="nav-text">分隔字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#大小写转换"><span class="nav-number">11.12.14.</span> <span class="nav-text">大小写转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#去除两边空格"><span class="nav-number">11.12.15.</span> <span class="nav-text">去除两边空格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#去除两遍指定字符"><span class="nav-number">11.12.16.</span> <span class="nav-text">去除两遍指定字符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#判断字符串开头-结束内容"><span class="nav-number">11.12.17.</span> <span class="nav-text">判断字符串开头/结束内容</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#时间和日期相关函数"><span class="nav-number">11.13.</span> <span class="nav-text">时间和日期相关函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#内置函数"><span class="nav-number">11.14.</span> <span class="nav-text">内置函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#new的使用"><span class="nav-number">11.14.1.</span> <span class="nav-text">new的使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#错误处理"><span class="nav-number">11.15.</span> <span class="nav-text">错误处理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#defer-recover-处理错误"><span class="nav-number">11.15.1.</span> <span class="nav-text">defer+recover 处理错误</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义错误"><span class="nav-number">11.15.2.</span> <span class="nav-text">自定义错误</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数组与切片"><span class="nav-number">12.</span> <span class="nav-text">数组与切片</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数组"><span class="nav-number">12.1.</span> <span class="nav-text">数组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#快速入门-3"><span class="nav-number">12.1.1.</span> <span class="nav-text">快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数组定义与内存布局"><span class="nav-number">12.1.2.</span> <span class="nav-text">数组定义与内存布局</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数组的使用"><span class="nav-number">12.1.3.</span> <span class="nav-text">数组的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数组的遍历"><span class="nav-number">12.1.4.</span> <span class="nav-text">数组的遍历</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#常规遍历"><span class="nav-number">12.1.4.1.</span> <span class="nav-text">常规遍历</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#for-range结构遍历"><span class="nav-number">12.1.4.2.</span> <span class="nav-text">for-range结构遍历</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数组的注意事项和细节"><span class="nav-number">12.1.5.</span> <span class="nav-text">数组的注意事项和细节</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数组应用案例"><span class="nav-number">12.1.6.</span> <span class="nav-text">数组应用案例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#切片"><span class="nav-number">12.2.</span> <span class="nav-text">切片</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本介绍-3"><span class="nav-number">12.2.1.</span> <span class="nav-text">基本介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#快速入门-4"><span class="nav-number">12.2.2.</span> <span class="nav-text">快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#切片在内存中形式-重要"><span class="nav-number">12.2.3.</span> <span class="nav-text">切片在内存中形式(重要)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#切片的使用"><span class="nav-number">12.2.4.</span> <span class="nav-text">切片的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#方式一-1"><span class="nav-number">12.2.4.1.</span> <span class="nav-text">方式一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方式二-1"><span class="nav-number">12.2.4.2.</span> <span class="nav-text">方式二</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方式三"><span class="nav-number">12.2.4.3.</span> <span class="nav-text">方式三</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方式一与方式二的区别"><span class="nav-number">12.2.4.4.</span> <span class="nav-text">方式一与方式二的区别</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#切片的遍历"><span class="nav-number">12.2.5.</span> <span class="nav-text">切片的遍历</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#切片的注意事项和细节"><span class="nav-number">12.2.6.</span> <span class="nav-text">切片的注意事项和细节</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#string-和-slice"><span class="nav-number">12.2.7.</span> <span class="nav-text">string 和 slice</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#排序和查找"><span class="nav-number">13.</span> <span class="nav-text">排序和查找</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#冒泡排序"><span class="nav-number">13.1.</span> <span class="nav-text">冒泡排序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查找"><span class="nav-number">13.2.</span> <span class="nav-text">查找</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#顺序查找"><span class="nav-number">13.2.1.</span> <span class="nav-text">顺序查找</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#二分查找"><span class="nav-number">13.2.2.</span> <span class="nav-text">二分查找</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二维数组"><span class="nav-number">14.</span> <span class="nav-text">二维数组</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#快速入门-5"><span class="nav-number">14.1.</span> <span class="nav-text">快速入门</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用方式"><span class="nav-number">14.2.</span> <span class="nav-text">使用方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二维数组的遍历"><span class="nav-number">14.3.</span> <span class="nav-text">二维数组的遍历</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#map"><span class="nav-number">15.</span> <span class="nav-text">map</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#map的声明"><span class="nav-number">15.1.</span> <span class="nav-text">map的声明</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本语法-1"><span class="nav-number">15.1.1.</span> <span class="nav-text">基本语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#map-声明的举例"><span class="nav-number">15.1.2.</span> <span class="nav-text">map 声明的举例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#案例演示-1"><span class="nav-number">15.1.3.</span> <span class="nav-text">案例演示</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#map的使用"><span class="nav-number">15.2.</span> <span class="nav-text">map的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#案例"><span class="nav-number">15.2.1.</span> <span class="nav-text">案例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#map的增删改查"><span class="nav-number">15.3.</span> <span class="nav-text">map的增删改查</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#map的增加和更新"><span class="nav-number">15.3.1.</span> <span class="nav-text">map的增加和更新</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#map的删除"><span class="nav-number">15.3.2.</span> <span class="nav-text">map的删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#map的查找"><span class="nav-number">15.3.3.</span> <span class="nav-text">map的查找</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#map的遍历"><span class="nav-number">15.4.</span> <span class="nav-text">map的遍历</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#map切片"><span class="nav-number">15.5.</span> <span class="nav-text">map切片</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#map的排序"><span class="nav-number">15.6.</span> <span class="nav-text">map的排序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#map的使用细节"><span class="nav-number">15.7.</span> <span class="nav-text">map的使用细节</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#练习"><span class="nav-number">15.8.</span> <span class="nav-text">练习</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#面向对象编程"><span class="nav-number">16.</span> <span class="nav-text">面向对象编程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#说明-1"><span class="nav-number">16.1.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#结构体"><span class="nav-number">16.2.</span> <span class="nav-text">结构体</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#快速入门-6"><span class="nav-number">16.2.1.</span> <span class="nav-text">快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#结构体的声明"><span class="nav-number">16.2.2.</span> <span class="nav-text">结构体的声明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#字段-属性"><span class="nav-number">16.2.3.</span> <span class="nav-text">字段/属性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#注意事项和细节说明"><span class="nav-number">16.2.3.1.</span> <span class="nav-text">注意事项和细节说明</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建结构体变量和访问结构体字段"><span class="nav-number">16.2.4.</span> <span class="nav-text">创建结构体变量和访问结构体字段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#struct-类型的内存分配机制"><span class="nav-number">16.2.5.</span> <span class="nav-text">struct 类型的内存分配机制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#结构体的注意事项与细节说明"><span class="nav-number">16.2.6.</span> <span class="nav-text">结构体的注意事项与细节说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#方法"><span class="nav-number">16.3.</span> <span class="nav-text">方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#小试牛刀"><span class="nav-number">16.3.1.</span> <span class="nav-text">小试牛刀</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#案例-1"><span class="nav-number">16.3.1.1.</span> <span class="nav-text">案例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法快速入门"><span class="nav-number">16.3.2.</span> <span class="nav-text">方法快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法的调用和传参机制原理"><span class="nav-number">16.3.3.</span> <span class="nav-text">方法的调用和传参机制原理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#案例一"><span class="nav-number">16.3.3.1.</span> <span class="nav-text">案例一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#案例二"><span class="nav-number">16.3.3.2.</span> <span class="nav-text">案例二</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法的声明-定义"><span class="nav-number">16.3.4.</span> <span class="nav-text">方法的声明(定义)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法的注意事项和细节"><span class="nav-number">16.3.5.</span> <span class="nav-text">方法的注意事项和细节</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法练习"><span class="nav-number">16.3.6.</span> <span class="nav-text">方法练习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方法和函数区别"><span class="nav-number">16.3.7.</span> <span class="nav-text">方法和函数区别</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面向对象编程应用实例"><span class="nav-number">16.4.</span> <span class="nav-text">面向对象编程应用实例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#步骤-1"><span class="nav-number">16.4.1.</span> <span class="nav-text">步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#学生案例"><span class="nav-number">16.4.2.</span> <span class="nav-text">学生案例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#创建结构体变量时指定字段值"><span class="nav-number">16.5.</span> <span class="nav-text">创建结构体变量时指定字段值</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#方式一-2"><span class="nav-number">16.5.1.</span> <span class="nav-text">方式一</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方式二-2"><span class="nav-number">16.5.2.</span> <span class="nav-text">方式二</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#工厂模式"><span class="nav-number">16.6.</span> <span class="nav-text">工厂模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么会有工厂模式"><span class="nav-number">16.6.1.</span> <span class="nav-text">为什么会有工厂模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#工厂模式的使用方法"><span class="nav-number">16.6.2.</span> <span class="nav-text">工厂模式的使用方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面向对象编程思想-抽象"><span class="nav-number">16.7.</span> <span class="nav-text">面向对象编程思想-抽象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面向对象编程三大特性-封装"><span class="nav-number">16.8.</span> <span class="nav-text">面向对象编程三大特性-封装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#封装的好处"><span class="nav-number">16.8.1.</span> <span class="nav-text">封装的好处</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何实现封装"><span class="nav-number">16.8.2.</span> <span class="nav-text">如何实现封装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#封装的步骤"><span class="nav-number">16.8.3.</span> <span class="nav-text">封装的步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#快速入门案例"><span class="nav-number">16.8.4.</span> <span class="nav-text">快速入门案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#练习案例"><span class="nav-number">16.8.5.</span> <span class="nav-text">练习案例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面向对象编程三大特性-继承"><span class="nav-number">16.9.</span> <span class="nav-text">面向对象编程三大特性-继承</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#为什么使用继承"><span class="nav-number">16.9.1.</span> <span class="nav-text">为什么使用继承</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#继承的介绍"><span class="nav-number">16.9.2.</span> <span class="nav-text">继承的介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#嵌套匿名结构体的基本语法"><span class="nav-number">16.9.3.</span> <span class="nav-text">嵌套匿名结构体的基本语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#快速入门案例-1"><span class="nav-number">16.9.4.</span> <span class="nav-text">快速入门案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#继承的深入讨论"><span class="nav-number">16.9.5.</span> <span class="nav-text">继承的深入讨论</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面向对象编程三大特性-多重继承"><span class="nav-number">16.10.</span> <span class="nav-text">面向对象编程三大特性-多重继承</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#接口"><span class="nav-number">16.11.</span> <span class="nav-text">接口</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#接口快速入门"><span class="nav-number">16.11.1.</span> <span class="nav-text">接口快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本语法-2"><span class="nav-number">16.11.2.</span> <span class="nav-text">基本语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#小结说明"><span class="nav-number">16.11.3.</span> <span class="nav-text">小结说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#注意事项和细节-2"><span class="nav-number">16.11.4.</span> <span class="nav-text">注意事项和细节</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#接口编程的最佳实践"><span class="nav-number">16.11.5.</span> <span class="nav-text">接口编程的最佳实践</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实现接口-vs-继承"><span class="nav-number">16.11.6.</span> <span class="nav-text">实现接口 vs 继承</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#面向对象编程-多态"><span class="nav-number">16.12.</span> <span class="nav-text">面向对象编程-多态</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#快速入门-7"><span class="nav-number">16.12.1.</span> <span class="nav-text">快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#接口体现多态的两种形式"><span class="nav-number">16.12.2.</span> <span class="nav-text">接口体现多态的两种形式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#类型断言"><span class="nav-number">16.13.</span> <span class="nav-text">类型断言</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本介绍-4"><span class="nav-number">16.13.1.</span> <span class="nav-text">基本介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#最佳实践一"><span class="nav-number">16.13.2.</span> <span class="nav-text">最佳实践一</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#最佳实践二"><span class="nav-number">16.13.3.</span> <span class="nav-text">最佳实践二</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#项目"><span class="nav-number">17.</span> <span class="nav-text">项目</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#家庭收支记账软件项目"><span class="nav-number">17.1.</span> <span class="nav-text">家庭收支记账软件项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#项目开发流程说明"><span class="nav-number">17.1.1.</span> <span class="nav-text">项目开发流程说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#项目需求说明"><span class="nav-number">17.1.2.</span> <span class="nav-text">项目需求说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#项目代码实现-面向过程"><span class="nav-number">17.1.3.</span> <span class="nav-text">项目代码实现-面向过程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#功能一-实现主菜单"><span class="nav-number">17.1.3.1.</span> <span class="nav-text">功能一:实现主菜单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#功能二-显示明细和登记收入"><span class="nav-number">17.1.3.2.</span> <span class="nav-text">功能二:显示明细和登记收入</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#功能三-登记支出的功能"><span class="nav-number">17.1.3.3.</span> <span class="nav-text">功能三:登记支出的功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#代码改进"><span class="nav-number">17.1.3.4.</span> <span class="nav-text">代码改进</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#项目代码实现-面向对象"><span class="nav-number">17.1.4.</span> <span class="nav-text">项目代码实现-面向对象</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#客户信息关系系统项目"><span class="nav-number">17.2.</span> <span class="nav-text">客户信息关系系统项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#项目需求分析"><span class="nav-number">17.2.1.</span> <span class="nav-text">项目需求分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#项目界面设计"><span class="nav-number">17.2.2.</span> <span class="nav-text">项目界面设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#客户关系管理系统的程序框架图"><span class="nav-number">17.2.3.</span> <span class="nav-text">客户关系管理系统的程序框架图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#功能实现"><span class="nav-number">17.2.4.</span> <span class="nav-text">功能实现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#显示主菜单和退出软件功能"><span class="nav-number">17.2.4.1.</span> <span class="nav-text">显示主菜单和退出软件功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#显示客户列表的功能"><span class="nav-number">17.2.4.2.</span> <span class="nav-text">显示客户列表的功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#添加客户的功能"><span class="nav-number">17.2.4.3.</span> <span class="nav-text">添加客户的功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除客户的功能"><span class="nav-number">17.2.4.4.</span> <span class="nav-text">删除客户的功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#完善退出确认功能"><span class="nav-number">17.2.4.5.</span> <span class="nav-text">完善退出确认功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#修改客户信息"><span class="nav-number">17.2.4.6.</span> <span class="nav-text">修改客户信息</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#文件操作"><span class="nav-number">18.</span> <span class="nav-text">文件操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#打开-关闭文件用到的方法"><span class="nav-number">18.1.</span> <span class="nav-text">打开/关闭文件用到的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#func-Open"><span class="nav-number">18.1.1.</span> <span class="nav-text">func Open</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#func-File-Close"><span class="nav-number">18.1.2.</span> <span class="nav-text">func (*File) Close</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#演示案例-1"><span class="nav-number">18.2.</span> <span class="nav-text">演示案例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#读文件操作应用实例"><span class="nav-number">18.3.</span> <span class="nav-text">读文件操作应用实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#写文件操作应用实例"><span class="nav-number">18.4.</span> <span class="nav-text">写文件操作应用实例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#func-OpenFile"><span class="nav-number">18.4.1.</span> <span class="nav-text">func OpenFile</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方式一-3"><span class="nav-number">18.4.2.</span> <span class="nav-text">方式一</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#方式二-3"><span class="nav-number">18.4.3.</span> <span class="nav-text">方式二</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#判断文件是否存在"><span class="nav-number">18.5.</span> <span class="nav-text">判断文件是否存在</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件编程应用实例"><span class="nav-number">18.6.</span> <span class="nav-text">文件编程应用实例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#拷贝文件"><span class="nav-number">18.6.1.</span> <span class="nav-text">拷贝文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#统计英文、数字、空格和其他字符数量"><span class="nav-number">18.6.2.</span> <span class="nav-text">统计英文、数字、空格和其他字符数量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#命令行参数"><span class="nav-number">18.7.</span> <span class="nav-text">命令行参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#flag-包用来解析命令行参数"><span class="nav-number">18.7.1.</span> <span class="nav-text">flag 包用来解析命令行参数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#json"><span class="nav-number">18.8.</span> <span class="nav-text">json</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基本介绍-5"><span class="nav-number">18.8.1.</span> <span class="nav-text">基本介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#json数据格式说明"><span class="nav-number">18.8.2.</span> <span class="nav-text">json数据格式说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#json的序列化"><span class="nav-number">18.8.3.</span> <span class="nav-text">json的序列化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#json的反序列化"><span class="nav-number">18.8.4.</span> <span class="nav-text">json的反序列化</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#单元测试"><span class="nav-number">19.</span> <span class="nav-text">单元测试</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#传统方式"><span class="nav-number">19.1.</span> <span class="nav-text">传统方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#传统方式的缺点"><span class="nav-number">19.2.</span> <span class="nav-text">传统方式的缺点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单元测试基本介绍"><span class="nav-number">19.3.</span> <span class="nav-text">单元测试基本介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#快速入门-8"><span class="nav-number">19.4.</span> <span class="nav-text">快速入门</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结-1"><span class="nav-number">19.5.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#综合案例"><span class="nav-number">19.6.</span> <span class="nav-text">综合案例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#goroutine-和-channel"><span class="nav-number">20.</span> <span class="nav-text">goroutine 和 channel</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#goroutine-协程"><span class="nav-number">20.1.</span> <span class="nav-text">goroutine(协程)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#进程与线程"><span class="nav-number">20.1.1.</span> <span class="nav-text">进程与线程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#程序、进程和线程的关系"><span class="nav-number">20.1.2.</span> <span class="nav-text">程序、进程和线程的关系</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#并发与并行"><span class="nav-number">20.1.3.</span> <span class="nav-text">并发与并行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Go协程与Go主线程"><span class="nav-number">20.1.4.</span> <span class="nav-text">Go协程与Go主线程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#goroutine快速入门"><span class="nav-number">20.1.5.</span> <span class="nav-text">goroutine快速入门</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#goroutine的调度模型"><span class="nav-number">20.1.6.</span> <span class="nav-text">goroutine的调度模型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MPG-模式-状态一"><span class="nav-number">20.1.6.1.</span> <span class="nav-text">MPG 模式-状态一</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MPG模式-状态二"><span class="nav-number">20.1.6.2.</span> <span class="nav-text">MPG模式-状态二</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#设置golang运行的CPU数量"><span class="nav-number">20.1.7.</span> <span class="nav-text">设置golang运行的CPU数量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#channel-管道"><span class="nav-number">20.2.</span> <span class="nav-text">channel(管道)</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#不同-goroutine-之间如何通讯"><span class="nav-number">20.2.1.</span> <span class="nav-text">不同 goroutine 之间如何通讯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#全局变量加锁同步"><span class="nav-number">20.2.2.</span> <span class="nav-text">全局变量加锁同步</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#channel的意义"><span class="nav-number">20.2.3.</span> <span class="nav-text">channel的意义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#channel的基本介绍"><span class="nav-number">20.2.4.</span> <span class="nav-text">channel的基本介绍</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#channel的声明"><span class="nav-number">20.2.5.</span> <span class="nav-text">channel的声明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#channel应用案例"><span class="nav-number">20.2.6.</span> <span class="nav-text">channel应用案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#channel的注意事项"><span class="nav-number">20.2.7.</span> <span class="nav-text">channel的注意事项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#读写channel案例演示"><span class="nav-number">20.2.8.</span> <span class="nav-text">读写channel案例演示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#channel的遍历和关闭"><span class="nav-number">20.2.9.</span> <span class="nav-text">channel的遍历和关闭</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#channel的关闭"><span class="nav-number">20.2.9.1.</span> <span class="nav-text">channel的关闭</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#channel的遍历"><span class="nav-number">20.2.9.2.</span> <span class="nav-text">channel的遍历</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#channel注意事项"><span class="nav-number">20.2.9.3.</span> <span class="nav-text">channel注意事项</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#反射"><span class="nav-number">21.</span> <span class="nav-text">反射</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#反射的基本介绍"><span class="nav-number">21.1.</span> <span class="nav-text">反射的基本介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#应用场景"><span class="nav-number">21.2.</span> <span class="nav-text">应用场景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#反射重要的函数和概念"><span class="nav-number">21.3.</span> <span class="nav-text">反射重要的函数和概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#反射的快速入门"><span class="nav-number">21.4.</span> <span class="nav-text">反射的快速入门</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#反射的注意事项"><span class="nav-number">21.5.</span> <span class="nav-text">反射的注意事项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#反射最佳实践"><span class="nav-number">21.6.</span> <span class="nav-text">反射最佳实践</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#个人练习"><span class="nav-number">21.7.</span> <span class="nav-text">个人练习</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#TCP编程"><span class="nav-number">22.</span> <span class="nav-text">TCP编程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#TCP-IP协议"><span class="nav-number">22.1.</span> <span class="nav-text">TCP/IP协议</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#OSI与TCP-IP参考模型"><span class="nav-number">22.2.</span> <span class="nav-text">OSI与TCP/IP参考模型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#端口"><span class="nav-number">22.3.</span> <span class="nav-text">端口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TCP-SOCKET编程快速入门"><span class="nav-number">22.4.</span> <span class="nav-text">TCP-SOCKET编程快速入门</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#服务端的处理流程"><span class="nav-number">22.4.1.</span> <span class="nav-text">服务端的处理流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#客户端的处理流程"><span class="nav-number">22.4.2.</span> <span class="nav-text">客户端的处理流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#流程示意图"><span class="nav-number">22.4.3.</span> <span class="nav-text">流程示意图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#代码实现"><span class="nav-number">22.4.4.</span> <span class="nav-text">代码实现</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#服务端代码"><span class="nav-number">22.4.4.1.</span> <span class="nav-text">服务端代码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#客户端代码"><span class="nav-number">22.4.4.2.</span> <span class="nav-text">客户端代码</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#海量用户即时通讯系统"><span class="nav-number">22.5.</span> <span class="nav-text">海量用户即时通讯系统</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#开发流程"><span class="nav-number">22.5.1.</span> <span class="nav-text">开发流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#需求分析"><span class="nav-number">22.5.2.</span> <span class="nav-text">需求分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#界面设计"><span class="nav-number">22.5.3.</span> <span class="nav-text">界面设计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据库选择"><span class="nav-number">22.5.4.</span> <span class="nav-text">数据库选择</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实现功能"><span class="nav-number">22.5.5.</span> <span class="nav-text">实现功能</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#客户端登录菜单"><span class="nav-number">22.5.5.1.</span> <span class="nav-text">客户端登录菜单</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#客户端用户登录"><span class="nav-number">22.5.5.2.</span> <span class="nav-text">客户端用户登录</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#步骤一"><span class="nav-number">22.5.5.2.1.</span> <span class="nav-text">步骤一</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#步骤二"><span class="nav-number">22.5.5.2.2.</span> <span class="nav-text">步骤二</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#步骤三"><span class="nav-number">22.5.5.2.3.</span> <span class="nav-text">步骤三</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#步骤四"><span class="nav-number">22.5.5.2.4.</span> <span class="nav-text">步骤四</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#步骤五"><span class="nav-number">22.5.5.2.5.</span> <span class="nav-text">步骤五</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Redis操作"><span class="nav-number">22.5.5.3.</span> <span class="nav-text">Redis操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Redis手动添加用户"><span class="nav-number">22.5.5.3.1.</span> <span class="nav-text">Redis手动添加用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#代码实现Redis添加用户"><span class="nav-number">22.5.5.3.2.</span> <span class="nav-text">代码实现Redis添加用户</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Redis"><span class="nav-number">23.</span> <span class="nav-text">Redis</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#操作原理图"><span class="nav-number">23.1.</span> <span class="nav-text">操作原理图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis的安装"><span class="nav-number">23.2.</span> <span class="nav-text">Redis的安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis的基本使用"><span class="nav-number">23.3.</span> <span class="nav-text">Redis的基本使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis-的-Crud-操作"><span class="nav-number">23.4.</span> <span class="nav-text">Redis 的 Crud 操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Redis-的五大数据类型"><span class="nav-number">23.4.1.</span> <span class="nav-text">Redis 的五大数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#String-字符串"><span class="nav-number">23.4.1.1.</span> <span class="nav-text">String(字符串)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Hash-哈希"><span class="nav-number">23.4.1.2.</span> <span class="nav-text">Hash (哈希)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#List-列表"><span class="nav-number">23.4.1.3.</span> <span class="nav-text">List(列表)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Set-集合"><span class="nav-number">23.4.1.4.</span> <span class="nav-text">Set(集合)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Golang-操作-Redis"><span class="nav-number">23.5.</span> <span class="nav-text">Golang 操作 Redis</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装第三方开源-Redis-库"><span class="nav-number">23.5.1.</span> <span class="nav-text">安装第三方开源 Redis 库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Set-Get-String字符串操作"><span class="nav-number">23.5.2.</span> <span class="nav-text">Set/Get-String字符串操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MSet-MGet操作-String字符串操作"><span class="nav-number">23.5.3.</span> <span class="nav-text">MSet/MGet操作-String字符串操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HSet-HGet-Hash操作"><span class="nav-number">23.5.4.</span> <span class="nav-text">HSet/HGet-Hash操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HMSet-HMGet-Hash操作"><span class="nav-number">23.5.5.</span> <span class="nav-text">HMSet/HMGet-Hash操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#列表操作"><span class="nav-number">23.5.6.</span> <span class="nav-text">列表操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Set-集合操作"><span class="nav-number">23.5.7.</span> <span class="nav-text">Set-集合操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Redis链接池"><span class="nav-number">23.6.</span> <span class="nav-text">Redis链接池</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <img src="http://www.icosky.com/icon/48/Cartoon/Bleach%20Chibi%20Icons%20for%20mac/Bleach%20Chibi%20Nr%20%206%20Rukia%20by%20rukichen.png">
  </span>
  <span class="author" itemprop="copyrightHolder">尚先森</span>

  
</div>

<!-- 
  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>
 -->



        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'hU7o1mDSLSyDeK4wE4hDgcIG-gzGzoHsz',
        appKey: 'SezjNE3ljsOzb5og8uQs51FR',
        placeholder: '回复时请填写个人邮箱和昵称，网址选填。',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  


  

  

  
  
<!-- 自定义的js文件 -->
<script type="text/javascript" src="/js/src/custom.js"></script>


<!-- 页面点击小红心，在末尾添加，避免找不到 -->
<script type="text/javascript" src="/js/src/love.js"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/assets/kesyoban.model.json"},"display":{"superSample":2,"width":150,"height":200,"position":"left","hOffset":10,"vOffset":25},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script><script async>window.onload=function(){var a=document.createElement('script'),b=document.getElementsByTagName('script')[0];a.type='text/javascript',a.async=!0,a.src='/sw-register.js?v='+Date.now(),b.parentNode.insertBefore(a,b)};</script></body></html>